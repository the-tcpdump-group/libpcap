#!/usr/bin/env perl

# Copyright (c) 2024 The Tcpdump Group
# All rights reserved.
# SPDX-License-Identifier: BSD-2-Clause
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
# "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
# LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
# FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
# COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
# INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
# BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
# LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
# CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
# LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
# ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
# POSSIBILITY OF SUCH DAMAGE.

require 5.8.4; # Solaris 10
use sigtrap qw(die normal-signals);
use strict;
use warnings FATAL => qw(uninitialized);
use Getopt::Long;
use Time::HiRes;
use Config;
use FindBin;
require $FindBin::RealBin . '/TEST' . ($Config{useithreads} ? 'mt' : 'st') . '.pm';
require $FindBin::RealBin . '/TESTlib.pm';
# TESTlib.pm
use subs qw(
	file_get_contents
	file_put_contents
	get_diff_flags
	init_tmpdir
	mytmpfile
	read_config_h
	result_failed
	result_passed
	result_skipped
	result_timed_out
	run_skip_test
	skip_config_def1
	skip_config_have_decl
	skip_config_undef
	skip_os
	skip_os_not
	string_in_file
	test_and_report
);

use constant SAVEFILE_DIR => $FindBin::RealBin . '/../tests/filter/';
my $filename_expected = 'expected.txt';
my $filename_stdout = 'stdout.txt';
my $filename_filter = 'filter.txt';
my $filename_diags = 'diags.txt';

# See RFC 6761 Section 6.4.
my $nonexistent = 'host.invalid';

use constant {
	EX_OK => 0,
	# On all platforms where timeout(1) is available it exits with status 124
	# if the command timed out.
	TIMED_OUT => 124,
	EX_USAGE => 64,
	# In this libpcap version filtertest exits with EX_DATAERR if the user input
	# is invalid and with other status codes for other (memory/file/etc) error
	# conditions.
	EX_DATAERR => 65,
};

# Set these later only if running any tests.
my $diff_flags;
my $timeout_bin;
my $test_timeout;
my $filtertest;

sub usage_text {
	my $detailed = shift;
	my $myname = $FindBin::Script;

	my $ret = "Usage: ${myname} [--passed]
       (run all tests)
  or:  ${myname} --list
       (print all test labels)
  or:  ${myname} --one <test_label> [--passed]
       (run one test only)
  or:  ${myname} --config
       (print the parsed contents of config.h)
  or:  ${myname} --help
       (print the detailed help screen)

Options:
  --passed        print the passed tests as well (with timings)
";
	return $ret unless $detailed;
	$ret .="
Set FILTERTEST_TIMEOUT to 0 to disable the timeout completely or to any other
value to override the default timeout.  The timeout applies to every test.
If TIMEOUT_BIN is not set, the timeout applies iff the default \"timeout\"
binary works.  If it is set (on macOS there is no default \"timeout\" and the
binary from GNU coreutils package may be available as \"gtimeout\" only), the
custom binary must work.

FILTERTEST_BIN and CONFIG_H allow to specify custom paths to respective files
if the current working directory is not the directory where the build output
files go to.  Otherwise by default this script finds the files for both
Autoconf and CMake, both in-tree and out-of-tree builds.

TIMEOUT_BIN allows to specify the path to a timeout(1) binary.

TESTRUN_JOBS allows to specify the number of tester threads (1 by default).
";
	return $ret;
}

my $config_h = defined $ENV{CONFIG_H} ? $ENV{CONFIG_H} : './config.h';
my $only_one = undef;
my $only_list = 0;
my $print_passed = 0;
if (! GetOptions (
	'one=s' => \$only_one,
	'list' => \$only_list,
	'passed' => \$print_passed,
	'config' => sub {
		my %config = read_config_h $config_h;
		printf "%-50s %s\n", $_, $config{$_} foreach sort keys %config;
		exit EX_OK;
	},
	'help' => sub {print STDOUT usage_text 1; exit EX_OK;},
)) {
	print STDERR usage_text 0;
	exit EX_USAGE;
};

# Initialize now so that the skip functions in TESTlib.pm (and therefore the
# test declarations below) work as intended.
read_config_h ($config_h);

# All accept tests require that BDEBUG is not set.
die 'ERROR: This script is not compatible with optimizer debugging.' if skip_config_def1 'BDEBUG';

# Skip unless the file exists and is readable and contains every given line
# (less any duplicates) at least once in any order.
sub skip_unless_file_contains_lines {
	my $filename = shift;
	my %notfound = map {$_ => 1} @_;
	# In Perl 5.8.4 "s///" does not have the "r" option.
	my $basename = $filename;
	$basename =~ s|^.*[/\\]||o;
	my $skip = "configure the $basename file";

	open FH, '<', $filename or return $skip;
	while (<FH>) {
		s/[\r\n]*$//o; # chomp() removes LF, but not CR, even on Windows.
		next unless exists $notfound{$_};
		delete $notfound{$_};
		last unless scalar keys %notfound;
	}
	close FH or die "failed closing '$filename'";
	return scalar (keys %notfound) ? $skip : '';
}

# Skip if running on Linux with musl libc.
sub skip_musl_libc {
	return skip_os ('linux') &&
		skip_config_undef ('HAVE_GLIBC') &&
		skip_config_undef ('HAVE_UCLIBC') &&
		'musl libc';
}

# libpcap.test is a domain subject to RFC 6761 Section 6.2.
#
# Each of the seven hostnames under host123.libpcap.test has 1..3 addresses
# (at most one of {Ethernet, IPv4, IPv6} each, at least one in total):
# * eth-ipv4-ipv6.host123.libpcap.test
# * eth-ipv4-noipv6.host123.libpcap.test
# * eth-noipv4-ipv6.host123.libpcap.test
# * eth-noipv4-noipv6.host123.libpcap.test
# * noeth-ipv4-ipv6.host123.libpcap.test
# * noeth-ipv4-noipv6.host123.libpcap.test
# * noeth-noipv4-ipv6.host123.libpcap.test
#
# To add tests that require hostnames with a different arrangement of
# addresses, consider adding similar mnemonic domains.

# The MAC address is in the locally-administered DECnet OUI space.
# These 4 lines can be copied into ethers(5) directly:
my @ethers_lines = split /\n/, <<EOF;
aa:00:04:00:14:0e eth-noipv4-noipv6.host123.libpcap.test
aa:00:04:00:14:0e eth-noipv4-ipv6.host123.libpcap.test
aa:00:04:00:14:0e eth-ipv4-noipv6.host123.libpcap.test
aa:00:04:00:14:0e eth-ipv4-ipv6.host123.libpcap.test
EOF

# The IPv6 address is subject to RFC4193.
# These 8 lines can be copied into hosts(5) directly:
my @hosts_lines = split /\n/, <<EOF;
10.20.30.40 noeth-ipv4-noipv6.host123.libpcap.test
10.20.30.40 noeth-ipv4-ipv6.host123.libpcap.test
10.20.30.40 eth-ipv4-noipv6.host123.libpcap.test
10.20.30.40 eth-ipv4-ipv6.host123.libpcap.test
fd00:a1b2:c3d4::1020:3040:5060:7080 noeth-noipv4-ipv6.host123.libpcap.test
fd00:a1b2:c3d4::1020:3040:5060:7080 noeth-ipv4-ipv6.host123.libpcap.test
fd00:a1b2:c3d4::1020:3040:5060:7080 eth-noipv4-ipv6.host123.libpcap.test
fd00:a1b2:c3d4::1020:3040:5060:7080 eth-ipv4-ipv6.host123.libpcap.test
EOF

# Dotted-quad is the only portable syntax common to all implementations of
# getnetbyname().
# These 3 lines can be copied into networks(5) directly (except on OpenBSD):
my @networks_lines = split /\n/, <<EOF;
net-10-0-0-0.libpcap.test 10.0.0.0
net-10-20-0-0.libpcap.test 10.20.0.0
net-10-20-30-0.libpcap.test 10.20.30.0
EOF
# These 3 lines can be copied into hosts(5) directly (on OpenBSD only):
my @networks_lines_swapped = split /\n/, <<EOF;
10.0.0.0 net-10-0-0-0.libpcap.test
10.20.0.0 net-10-20-0-0.libpcap.test
10.20.30.0 net-10-20-30-0.libpcap.test
EOF

# Skip if /etc/ethers (or the equivalent) has not been configured for tests.
#
# Do not use getent(1): it works, but experiences some portability issues and
# does not always test the same code paths as what libpcap uses.
my $cached_skip_no_ethers;
sub skip_no_ethers {
	$cached_skip_no_ethers =
		# pcap_ether_hostton() currently cannot guess a suitable
		# location for the libpcap-only ethers(5).
		skip_os ('msys') ||
		skip_unless_file_contains_lines (
			$^O eq 'haiku' ? '/boot/system/settings/network/ethers' :
			'/etc/ethers',
			@ethers_lines
		) unless defined $cached_skip_no_ethers;
	return $cached_skip_no_ethers;
}

# Same as the above, plus require the platform to treat hostnames in
# ethers(5) correctly (case-insensitive).
sub skip_no_ethers_casecmp {
	return skip_no_ethers ||
		# pcap_ether_hostton() uses strcmp().
		skip_musl_libc ||
		skip_os ('haiku') ||
		# ether_hostton() uses strcmp().
		skip_os ('freebsd') ||
		skip_os ('netbsd') ||
		skip_os ('openbsd');
}

# Skip if /etc/hosts (or the equivalent) has not been configured for tests.
#
# Do not use getent(1): it experiences too many portability issues (especially
# with dual-stack hostnames) to be practicable.
my $cached_skip_no_hosts;
sub skip_no_hosts {
	return '%SYSTEMROOT% not set' if $^O eq 'msys' && ! defined $ENV{SYSTEMROOT};
	$cached_skip_no_hosts = skip_unless_file_contains_lines (
		$^O eq 'haiku' ? '/boot/system/settings/network/hosts' :
		$^O eq 'solaris' ? '/etc/inet/hosts' :
		$^O eq 'msys' ? "${ENV{SYSTEMROOT}}\\system32\\drivers\\etc\\hosts" :
		'/etc/hosts',
		@hosts_lines
	) unless defined $cached_skip_no_hosts;
	return $cached_skip_no_hosts;
}

# Same as the above, plus require the platform to treat hostnames in
# hosts(5) correctly (case-insensitive).
sub skip_no_hosts_casecmp {
	return skip_no_hosts ||
		# getaddrinfo() uses strcmp() on /etc/hosts.
		skip_musl_libc();
}

# Skip if /etc/networks (or the equivalent) has not been configured for tests.
my $cached_skip_no_networks;
sub skip_no_networks {
	$cached_skip_no_networks =
		# Does not implement getnetbyname().
		skip_os ('msys') ||
		# getnetbyname() is a no-op.
		skip_musl_libc() ||
		skip_unless_file_contains_lines (
			$^O eq 'solaris' ? '/etc/inet/networks' :
			$^O eq 'haiku' ? '/etc/networks' : # May change, see haiku bug report 19432.
			$^O eq 'openbsd' ? '/etc/hosts' : # (sic)
			'/etc/networks',
			$^O eq 'openbsd' ? @networks_lines_swapped : @networks_lines
		) unless defined $cached_skip_no_networks;
	return $cached_skip_no_networks;
}

sub skip_no_networks_casecmp {
	return skip_no_networks ||
		skip_os ('solaris');
}

# In accept_blocks the top-level keys are test block names.  Each test block
# defines one or more tests.  When possible, a test block name should be easy
# to relate with the main filter expression, for example, ip_multicast for
# "ip multicast" etc.  However, because in Perl hashes the keys are not ordered,
# sometimes the easiest way to group the tests in the alphabetically-sorted
# output is to use an artificial prefix, for example, mtp2_ for "fisu", "lssu",
# "msu" etc.  The top-level values are in turn hashes, where the keys have the
# following meaning:
#
# * DLT (mandatory, string): the name of the DLT to use for the test
# * aliases (mandatory, array of strings): must contain at least one string,
#   each string is a filter expression and must produce exactly the same
#   bytecode (applies to "opt" and "unopt" separately)
# * snaplen (optional, int): the snapshot length to use for the test
# * opt (optional, [multi-line] string): the expected optimised bytecode
# * unopt (optional, [multi-line] string): the expected unoptimised bytecode
# * skip (optional, string): if defined and is not equal to an empty string,
#   causes the test to skip using the string as the reason
# * linuxext (optional, int): if defined and is equal to 1, use Linux BPF
#   extensions.
# * netmask (optional, string, dotted-quad): the netmask for pcap_compile()
#
# At least one of "opt" and "unopt" must be defined in each accept test block.

my %accept_blocks = (
	empty => {
		DLT => 'EN10MB',
		aliases => [''],
		unopt => '
			(000) ret      #262144
			',
	},

	greater => {
		DLT => 'RAW',
		snaplen => 200,
		aliases => [
			'greater 100',
			'len >= 100',
			'length >= 100',
		],
		# Only the optimized bytecode is equivalent!
		opt => '
			(000) ld       #pktlen
			(001) jge      #0x64            jt 2	jf 3
			(002) ret      #200
			(003) ret      #0
			',
	}, # greater
	less => {
		DLT => 'RAW',
		snaplen => 200,
		aliases => [
			'less 200',
			'len <= 200',
			'length <= 200',
		],
		# Only the optimized bytecode is equivalent!
		opt => '
			(000) ld       #pktlen
			(001) jgt      #0xc8            jt 2	jf 3
			(002) ret      #0
			(003) ret      #200
			',
	}, # less

	link_index_byte => {
		DLT => 'EN10MB',
		aliases => [
			'link[5] == 0x12',
			'ether[5] == 0x12',
			'fddi[5] == 0x12',
			'ppp[5] == 0x12',
			'slip[5] == 0x12',
			'tr[5] == 0x12',
			'wlan[5] == 0x12',
			'ether[5:1] == 0x12',
			'fddi[5:1] == 0x12',
			'ppp[5:1] == 0x12',
			'slip[5:1] == 0x12',
			'tr[5:1] == 0x12',
			'wlan[5:1] == 0x12',
		],
		opt => '
			(000) ldb      [5]
			(001) jeq      #0x12            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # link_index_byte
	link_index_halfword => {
		DLT => 'EN10MB',
		aliases => [
			'link[7:2] == 0x1234',
			'ether[7:2] == 0x1234',
			'fddi[7:2] == 0x1234',
			'ppp[7:2] == 0x1234',
			'slip[7:2] == 0x1234',
			'tr[7:2] == 0x1234',
			'wlan[7:2] == 0x1234',
		],
		opt => '
			(000) ldh      [7]
			(001) jeq      #0x1234          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # link_index_halfword
	link_index_word => {
		DLT => 'EN10MB',
		aliases => [
			'link[10:4] == 0x12345678',
			'ether[10:4] == 0x12345678',
			'fddi[10:4] == 0x12345678',
			'ppp[10:4] == 0x12345678',
			'slip[10:4] == 0x12345678',
			'tr[10:4] == 0x12345678',
			'wlan[10:4] == 0x12345678',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x12345678      jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # link_index_word

	icmp_index_icmptype => {
		DLT => 'EN10MB',
		snaplen => 16000,
		# Verify that the named offset resolves to the same constant and that the
		# protocol supports index operation.
		aliases => [
			'icmp[icmptype] != 0xff',
			'icmp[0] != 0xff',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 10
			(002) ldb      [23]
			(003) jeq      #0x1             jt 4	jf 10
			(004) ldh      [20]
			(005) jset     #0x1fff          jt 10	jf 6
			(006) ldxb     4*([14]&0xf)
			(007) ldb      [x + 14]
			(008) jeq      #0xff            jt 10	jf 9
			(009) ret      #16000
			(010) ret      #0
			',
	}, # icmp_index_icmptype
	icmp_index_icmpcode => {
		DLT => 'EN10MB',
		snaplen => 16000,
		# Same as for icmp[icmptype] above.
		aliases => [
			'icmp[icmpcode] != 0xff',
			'icmp[1] != 0xff',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 10
			(002) ldb      [23]
			(003) jeq      #0x1             jt 4	jf 10
			(004) ldh      [20]
			(005) jset     #0x1fff          jt 10	jf 6
			(006) ldxb     4*([14]&0xf)
			(007) ldb      [x + 15]
			(008) jeq      #0xff            jt 10	jf 9
			(009) ret      #16000
			(010) ret      #0
			',
	}, # icmp_index_icmpcode
	icmp6_index_icmp6type => {
		DLT => 'IPV6',
		snaplen => 10000,
		# Same as for icmp[icmptype] above.
		aliases => [
			'icmp6[icmp6type] != 0xff',
			'icmp6[0] != 0xff',
		],
		opt => '
			(000) ld       #0x0
			(001) ldb      [6]
			(002) jeq      #0x3a            jt 3	jf 6
			(003) ldb      [40]
			(004) jeq      #0xff            jt 6	jf 5
			(005) ret      #10000
			(006) ret      #0
			',
	}, # icmp6_index_icmp6type
	icmp6_index_icmp6code => {
		DLT => 'IPV6',
		snaplen => 10000,
		# Same as for icmp[icmptype] above.
		aliases => [
			'icmp6[icmp6code] != 0xff',
			'icmp6[1] != 0xff',
		],
		opt => '
			(000) ld       #0x0
			(001) ldb      [6]
			(002) jeq      #0x3a            jt 3	jf 6
			(003) ldb      [41]
			(004) jeq      #0xff            jt 6	jf 5
			(005) ret      #10000
			(006) ret      #0
			',
	}, # icmp6_index_icmp6code
	udp_index_halfword => {
		DLT => 'RAW',
		snaplen => 65535,
		# The implementation is IPv4-only.
		aliases => ['udp[8:2] == 0xabcd'],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 11
			(003) ldb      [9]
			(004) jeq      #0x11            jt 5	jf 11
			(005) ldh      [6]
			(006) jset     #0x1fff          jt 11	jf 7
			(007) ldxb     4*([0]&0xf)
			(008) ldh      [x + 8]
			(009) jeq      #0xabcd          jt 10	jf 11
			(010) ret      #65535
			(011) ret      #0
			',
	}, # udp_index_halfword
	tcp_index_byte => {
		DLT => 'RAW',
		snaplen => 262144,
		# Same as for icmp[icmptype] above.
		# The implementation is IPv4-only.
		aliases => [
			'tcp[tcpflags] == 0xFF',
			'tcp[13] == 0xFF',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 11
			(003) ldb      [9]
			(004) jeq      #0x6             jt 5	jf 11
			(005) ldh      [6]
			(006) jset     #0x1fff          jt 11	jf 7
			(007) ldxb     4*([0]&0xf)
			(008) ldb      [x + 13]
			(009) jeq      #0xff            jt 10	jf 11
			(010) ret      #262144
			(011) ret      #0
			',
	}, # tcp_index_byte
	linux_sll_inbound => {
		DLT => 'LINUX_SLL',
		snaplen => 65535,
		aliases => ['inbound'],
		unopt => '
			(000) ldh      [0]
			(001) jeq      #0x4             jt 2	jf 3
			(002) ret      #0
			(003) ret      #65535
			',
	}, # linux_sll_inbound
	linux_sll_outbound => {
		DLT => 'LINUX_SLL',
		snaplen => 65535,
		aliases => ['outbound'],
		unopt => '
			(000) ldh      [0]
			(001) jeq      #0x4             jt 2	jf 3
			(002) ret      #65535
			(003) ret      #0
			',
	}, # linux_sll_outbound
	linux_sll2_inbound => {
		DLT => 'LINUX_SLL2',
		snaplen => 65535,
		aliases => ['inbound'],
		unopt => '
			(000) ldb      [10]
			(001) jeq      #0x4             jt 2	jf 3
			(002) ret      #0
			(003) ret      #65535
			',
	}, # linux_sll2_inbound
	linux_sll2_outbound => {
		DLT => 'LINUX_SLL2',
		snaplen => 65535,
		aliases => ['outbound'],
		unopt => '
			(000) ldb      [10]
			(001) jeq      #0x4             jt 2	jf 3
			(002) ret      #65535
			(003) ret      #0
			',
	}, # linux_sll2_outbound
	linux_sll2_ifindex => {
		DLT => 'LINUX_SLL2',
		snaplen => 65535,
		aliases => ['ifindex 7'],
		unopt => '
			(000) ld       [4]
			(001) jeq      #0x7             jt 2	jf 3
			(002) ret      #65535
			(003) ret      #0
			',
	}, # linux_sll2_ifindex
	slip_inbound => {
		DLT => 'SLIP',
		snaplen => 100,
		aliases => ['inbound'],
		opt => '
			(000) ldb      [0]
			(001) jeq      #0x0             jt 2	jf 3
			(002) ret      #100
			(003) ret      #0
			',
	}, # slip_inbound
	slip_outbound => {
		DLT => 'SLIP',
		snaplen => 100,
		aliases => ['outbound'],
		opt => '
			(000) ldb      [0]
			(001) jeq      #0x0             jt 2	jf 3
			(002) ret      #0
			(003) ret      #100
			',
	}, # slip_outbound
	ipnet_inbound => {
		DLT => 'IPNET',
		snaplen => 1000,
		aliases => ['inbound'],
		unopt => '
			(000) ldh      [2]
			(001) jeq      #0x2             jt 2	jf 3
			(002) ret      #1000
			(003) ret      #0
			',
	}, # ipnet_inbound
	ipnet_outbound => {
		DLT => 'IPNET',
		snaplen => 1000,
		aliases => ['outbound'],
		unopt => '
			(000) ldh      [2]
			(001) jeq      #0x1             jt 2	jf 3
			(002) ret      #1000
			(003) ret      #0
			',
	}, # ipnet_outbound
	pflog_inbound => {
		DLT => 'PFLOG',
		aliases => ['inbound'],
		unopt => '
			(000) ldb      [60]
			(001) jeq      #0x1             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # pflog_inbound
	pflog_outbound => {
		DLT => 'PFLOG',
		aliases => ['outbound'],
		unopt => '
			(000) ldb      [60]
			(001) jeq      #0x2             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # pflog_outbound
	ppp_pppd_inbound => {
		DLT => 'PPP_PPPD',
		aliases => ['inbound'],
		unopt => '
			(000) ldb      [0]
			(001) jeq      #0x0             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ppp_pppd_inbound
	ppp_pppd_oubound => {
		DLT => 'PPP_PPPD',
		aliases => ['outbound'],
		unopt => '
			(000) ldb      [0]
			(001) jeq      #0x1             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ppp_pppd_oubound
	juniper_mfr_inbound => {
		DLT => 'JUNIPER_MFR',
		aliases => ['inbound'],
		unopt => '
			(000) ldb      [3]
			(001) and      #0x1
			(002) jeq      #0x1             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # juniper_mfr_inbound
	juniper_mfr_outbound => {
		DLT => 'JUNIPER_MFR',
		aliases => ['outbound'],
		unopt => '
			(000) ldb      [3]
			(001) and      #0x1
			(002) jeq      #0x0             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # juniper_mfr_outbound
	inbound_linuxext => {
		skip => skip_os_not ('linux'),
		linuxext => 1,
		DLT => 'EN10MB',
		aliases => ['inbound'],
		unopt => '
			(000) ldh      [type]
			(001) jeq      #0x4             jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # inbound_linuxext
	outbound_linuxext => {
		skip => skip_os_not ('linux'),
		linuxext => 1,
		DLT => 'EN10MB',
		aliases => ['outbound'],
		unopt => '
			(000) ldh      [type]
			(001) jeq      #0x4             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # outbound_linuxext
	ifindex_linuxext => {
		skip => skip_os_not ('linux'),
		linuxext => 1,
		DLT => 'EN10MB',
		aliases => ['ifindex 10'],
		unopt => '
			(000) ld       [ifidx]
			(001) jeq      #0xa             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ifindex_linuxext

	mtp2_fisu => {
		DLT => 'MTP2',
		aliases => ['fisu'],
		opt => '
			(000) ldb      [2]
			(001) jset     #0x3f            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # mtp2_fisu
	mtp2_lssu => {
		DLT => 'MTP2',
		aliases => [
			'lssu',
			'lsu', # Not documented (and probably should not be).
		],
		opt => '
			(000) ldb      [2]
			(001) and      #0x3f
			(002) jgt      #0x0             jt 3	jf 7
			(003) ldb      [2]
			(004) and      #0x3f
			(005) jgt      #0x2             jt 7	jf 6
			(006) ret      #262144
			(007) ret      #0
			',
	}, # mtp2_lssu
	mtp2_msu => {
		DLT => 'MTP2',
		aliases => ['msu'],
		opt => '
			(000) ldb      [2]
			(001) and      #0x3f
			(002) jgt      #0x2             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp2_msu
	mtp2_sio => {
		DLT => 'MTP2',
		aliases => [
			'sio 0xd2',
			'sio = 0xd2',
			'sio == 0xd2',
			'sio (0xd2)',
			'sio (0xd2 or 0xd2)',
		],
		opt => '
			(000) ldb      [3]
			(001) jeq      #0xd2            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # mtp2_sio
	mtp2_sio_gt => {
		DLT => 'MTP2',
		aliases => ['sio > 0xa1'],
		unopt => '
			(000) ldb      [3]
			(001) jgt      #0xa1            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # mtp2_sio_gt
	mtp2_sio_ge => {
		DLT => 'MTP2',
		aliases => ['sio >= 0xa2'],
		unopt => '
			(000) ldb      [3]
			(001) jge      #0xa2            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # mtp2_sio_ge
	mtp2_sio_le => {
		DLT => 'MTP2',
		aliases => ['sio <= 0xa3'],
		unopt => '
			(000) ldb      [3]
			(001) jgt      #0xa3            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # mtp2_sio_le
	mtp2_sio_lt => {
		DLT => 'MTP2',
		aliases => ['sio < 0xa4'],
		unopt => '
			(000) ldb      [3]
			(001) jge      #0xa4            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # mtp2_sio_lt
	mtp2_sio_ne => {
		DLT => 'MTP2',
		aliases => ['sio != 0xa5'],
		unopt => '
			(000) ldb      [3]
			(001) jeq      #0xa5            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # mtp2_sio_ne
	mtp2_sio_nary => {
		DLT => 'MTP2',
		aliases => ['sio (73 or 74 or 75)'],
		opt => '
			(000) ldb      [3]
			(001) jeq      #0x49            jt 4	jf 2
			(002) jeq      #0x4a            jt 4	jf 3
			(003) jeq      #0x4b            jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # mtp2_sio_nary
	mtp3_dpc => {
		DLT => 'MTP2',
		aliases => [
			'dpc 0x31d6',
			'dpc = 0x31d6',
			'dpc == 0x31d6',
			'dpc (0x31d6)',
			'dpc (0x31d6 or 0x31d6)',
		],
		opt => '
			(000) ldh      [4]
			(001) and      #0xff3f
			(002) jeq      #0xd631          jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_dpc
	mtp3_dpc_gt => {
		DLT => 'MTP2',
		aliases => ['dpc > 0x1273'],
		unopt => '
			(000) ldh      [4]
			(001) and      #0xff3f
			(002) jgt      #0x7312          jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_dpc_gt
	mtp3_dpc_ge => {
		DLT => 'MTP2',
		aliases => ['dpc >= 0x1273'],
		unopt => '
			(000) ldh      [4]
			(001) and      #0xff3f
			(002) jge      #0x7312          jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_dpc_ge
	mtp3_dpc_le => {
		DLT => 'MTP2',
		aliases => ['dpc <= 0x1273'],
		unopt => '
			(000) ldh      [4]
			(001) and      #0xff3f
			(002) jgt      #0x7312          jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_dpc_le
	mtp3_dpc_lt => {
		DLT => 'MTP2',
		aliases => ['dpc < 0x1273'],
		unopt => '
			(000) ldh      [4]
			(001) and      #0xff3f
			(002) jge      #0x7312          jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_dpc_lt
	mtp3_dpc_ne => {
		DLT => 'MTP2',
		aliases => ['dpc != 0x1273'],
		unopt => '
			(000) ldh      [4]
			(001) and      #0xff3f
			(002) jeq      #0x7312          jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_dpc_ne
	mtp3_dpc_nary => {
		DLT => 'MTP2',
		aliases => ['dpc (0x1274 or 0x1275 or 0x1276)'],
		unopt => '
			(000) ldh      [4]
			(001) and      #0xff3f
			(002) jeq      #0x7412          jt 9	jf 3
			(003) ldh      [4]
			(004) and      #0xff3f
			(005) jeq      #0x7512          jt 9	jf 6
			(006) ldh      [4]
			(007) and      #0xff3f
			(008) jeq      #0x7612          jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # mtp3_dpc_nary
	mtp3_opc => {
		DLT => 'MTP2',
		aliases => [
			'opc 0x3b35',
			'opc = 0x3b35',
			'opc == 0x3b35',
			'opc (0x3b35)',
			'opc (0x3b35 or 0x3b35)',
		],
		opt => '
			(000) ld       [4]
			(001) and      #0xc0ff0f
			(002) jeq      #0x40cd0e        jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_opc
	mtp3_opc_gt => {
		DLT => 'MTP2',
		aliases => ['opc > 0x607'],
		unopt => '
			(000) ld       [4]
			(001) and      #0xc0ff0f
			(002) jgt      #0xc08101        jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_opc_gt
	mtp3_opc_ge => {
		DLT => 'MTP2',
		aliases => ['opc >= 0x607'],
		unopt => '
			(000) ld       [4]
			(001) and      #0xc0ff0f
			(002) jge      #0xc08101        jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_opc_ge
	mtp3_opc_le => {
		DLT => 'MTP2',
		aliases => ['opc <= 0x607'],
		unopt => '
			(000) ld       [4]
			(001) and      #0xc0ff0f
			(002) jgt      #0xc08101        jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_opc_le
	mtp3_opc_lt => {
		DLT => 'MTP2',
		aliases => ['opc < 0x607'],
		unopt => '
			(000) ld       [4]
			(001) and      #0xc0ff0f
			(002) jge      #0xc08101        jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_opc_lt
	mtp3_opc_ne => {
		DLT => 'MTP2',
		aliases => ['opc != 0x607'],
		unopt => '
			(000) ld       [4]
			(001) and      #0xc0ff0f
			(002) jeq      #0xc08101        jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_opc_ne
	mtp2_opc_nary => {
		DLT => 'MTP2',
		aliases => ['opc (0x608 or 0x609 or 0x60a)'],
		unopt => '
			(000) ld       [4]
			(001) and      #0xc0ff0f
			(002) jeq      #0x8201          jt 9	jf 3
			(003) ld       [4]
			(004) and      #0xc0ff0f
			(005) jeq      #0x408201        jt 9	jf 6
			(006) ld       [4]
			(007) and      #0xc0ff0f
			(008) jeq      #0x808201        jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # mtp2_opc_nary
	mtp3_sls => {
		DLT => 'MTP2',
		aliases => [
			'sls 3',
			'sls = 3',
			'sls == 3',
			'sls (3)',
			'sls (3 or 3)',
		],
		opt => '
			(000) ldb      [7]
			(001) and      #0xf0
			(002) jeq      #0x30            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_sls
	mtp3_sls_gt => {
		DLT => 'MTP2',
		aliases => ['sls > 1'],
		unopt => '
			(000) ldb      [7]
			(001) and      #0xf0
			(002) jgt      #0x10            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_sls_gt
	mtp3_sls_ge => {
		DLT => 'MTP2',
		aliases => ['sls >= 2'],
		unopt => '
			(000) ldb      [7]
			(001) and      #0xf0
			(002) jge      #0x20            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_sls_ge
	mtp3_sls_le => {
		DLT => 'MTP2',
		aliases => ['sls <= 4'],
		unopt => '
			(000) ldb      [7]
			(001) and      #0xf0
			(002) jgt      #0x40            jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_sls_le
	mtp3_sls_lt => {
		DLT => 'MTP2',
		aliases => ['sls < 5'],
		unopt => '
			(000) ldb      [7]
			(001) and      #0xf0
			(002) jge      #0x50            jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_sls_lt
	mtp3_sls_ne => {
		DLT => 'MTP2',
		aliases => ['sls != 8'],
		unopt => '
			(000) ldb      [7]
			(001) and      #0xf0
			(002) jeq      #0x80            jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_sls_ne
	mtp3_sls_nary => {
		DLT => 'MTP2',
		aliases => ['sls (3 or 4 or 5)'],
		unopt => '
			(000) ldb      [7]
			(001) and      #0xf0
			(002) jeq      #0x30            jt 9	jf 3
			(003) ldb      [7]
			(004) and      #0xf0
			(005) jeq      #0x40            jt 9	jf 6
			(006) ldb      [7]
			(007) and      #0xf0
			(008) jeq      #0x50            jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # mtp3_sls_nary
	mtp2_hfisu => {
		DLT => 'MTP2',
		aliases => ['hfisu'],
		opt => '
			(000) ldh      [4]
			(001) jset     #0xff80          jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # mtp2_hfisu
	mtp2_hlssu => {
		DLT => 'MTP2',
		aliases => ['hlssu'],
		opt => '
			(000) ldh      [4]
			(001) and      #0xff80
			(002) jgt      #0x0             jt 3	jf 7
			(003) ldh      [4]
			(004) and      #0xff80
			(005) jgt      #0x100           jt 7	jf 6
			(006) ret      #262144
			(007) ret      #0
			',
	}, # mtp2_hlssu
	mtp2_hmsu => {
		DLT => 'MTP2',
		aliases => ['hmsu'],
		opt => '
			(000) ldh      [4]
			(001) and      #0xff80
			(002) jgt      #0x100           jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp2_hmsu
	mtp2_hsio => {
		DLT => 'MTP2',
		aliases => [
			'hsio 0x41',
			'hsio = 0x41',
			'hsio == 0x41',
			'hsio (0x41)',
			'hsio (0x41 or 0x41)',
		],
		opt => '
			(000) ldb      [6]
			(001) jeq      #0x41            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # mtp2_hsio
	mtp2_hsio_gt => {
		DLT => 'MTP2',
		aliases => ['hsio > 0x41'],
		unopt => '
			(000) ldb      [6]
			(001) jgt      #0x41            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # mtp2_hsio_gt
	mtp2_hsio_ge => {
		DLT => 'MTP2',
		aliases => ['hsio >= 0x41'],
		unopt => '
			(000) ldb      [6]
			(001) jge      #0x41            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # mtp2_hsio_ge
	mtp2_hsio_le => {
		DLT => 'MTP2',
		aliases => ['hsio <= 0x41'],
		unopt => '
			(000) ldb      [6]
			(001) jgt      #0x41            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # mtp2_hsio_le
	mtp2_hsio_lt => {
		DLT => 'MTP2',
		aliases => ['hsio < 0x41'],
		unopt => '
			(000) ldb      [6]
			(001) jge      #0x41            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # mtp2_hsio_lt
	mtp2_hsio_ne => {
		DLT => 'MTP2',
		aliases => ['hsio != 0x41'],
		unopt => '
			(000) ldb      [6]
			(001) jeq      #0x41            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # mtp2_hsio_ne
	mtp2_hsio_nary => {
		DLT => 'MTP2',
		aliases => ['hsio (0x42 or 0x43 or 0x44)'],
		opt => '
			(000) ldb      [6]
			(001) jeq      #0x42            jt 4	jf 2
			(002) jeq      #0x43            jt 4	jf 3
			(003) jeq      #0x44            jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # mtp2_hsio_nary
	mtp3_hdpc => {
		DLT => 'MTP2',
		aliases => [
			'hdpc 0x0ab5',
			'hdpc = 0x0ab5',
			'hdpc == 0x0ab5',
			'hdpc (0x0ab5)',
			'hdpc (0x0ab5 or 0x0ab5)',
		],
		opt => '
			(000) ldh      [7]
			(001) and      #0xff3f
			(002) jeq      #0xb50a          jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hdpc
	mtp3_hdpc_gt => {
		DLT => 'MTP2',
		aliases => ['hdpc > 0x0ab5'],
		unopt => '
			(000) ldh      [7]
			(001) and      #0xff3f
			(002) jgt      #0xb50a          jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hdpc_gt
	mtp3_hdpc_ge => {
		DLT => 'MTP2',
		aliases => ['hdpc >= 0x0ab5'],
		unopt => '
			(000) ldh      [7]
			(001) and      #0xff3f
			(002) jge      #0xb50a          jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hdpc_ge
	mtp3_hdpc_le => {
		DLT => 'MTP2',
		aliases => ['hdpc <= 0x0ab5'],
		unopt => '
			(000) ldh      [7]
			(001) and      #0xff3f
			(002) jgt      #0xb50a          jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hdpc_le
	mtp3_hdpc_lt => {
		DLT => 'MTP2',
		aliases => ['hdpc < 0x0ab5'],
		unopt => '
			(000) ldh      [7]
			(001) and      #0xff3f
			(002) jge      #0xb50a          jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hdpc_lt
	mtp3_hdpc_ne => {
		DLT => 'MTP2',
		aliases => ['hdpc != 0x0ab5'],
		unopt => '
			(000) ldh      [7]
			(001) and      #0xff3f
			(002) jeq      #0xb50a          jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hdpc_ne
	mtp3_hdpc_nary => {
		DLT => 'MTP2',
		aliases => ['hdpc (0x0ab6 or 0x0ab7 or 0x0ab8)'],
		unopt => '
			(000) ldh      [7]
			(001) and      #0xff3f
			(002) jeq      #0xb60a          jt 9	jf 3
			(003) ldh      [7]
			(004) and      #0xff3f
			(005) jeq      #0xb70a          jt 9	jf 6
			(006) ldh      [7]
			(007) and      #0xff3f
			(008) jeq      #0xb80a          jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # mtp3_hdpc_nary
	mtp3_hopc => {
		DLT => 'MTP2',
		aliases => [
			'hopc 0x3aba',
			'hopc = 0x3aba',
			'hopc == 0x3aba',
			'hopc (0x3aba)',
			'hopc (0x3aba or 0x3aba)',
		],
		opt => '
			(000) ld       [7]
			(001) and      #0xc0ff0f
			(002) jeq      #0x80ae0e        jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hopc
	mtp3_hopc_gt => {
		DLT => 'MTP2',
		aliases => ['hopc > 0x3aba'],
		unopt => '
			(000) ld       [7]
			(001) and      #0xc0ff0f
			(002) jgt      #0x80ae0e        jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hopc_gt
	mtp3_hopc_ge => {
		DLT => 'MTP2',
		aliases => ['hopc >= 0x3aba'],
		unopt => '
			(000) ld       [7]
			(001) and      #0xc0ff0f
			(002) jge      #0x80ae0e        jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hopc_ge
	mtp3_hopc_le => {
		DLT => 'MTP2',
		aliases => ['hopc <= 0x3aba'],
		unopt => '
			(000) ld       [7]
			(001) and      #0xc0ff0f
			(002) jgt      #0x80ae0e        jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hopc_le
	mtp3_hopc_lt => {
		DLT => 'MTP2',
		aliases => ['hopc < 0x3aba'],
		unopt => '
			(000) ld       [7]
			(001) and      #0xc0ff0f
			(002) jge      #0x80ae0e        jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hopc_lt
	mtp3_hopc_ne => {
		DLT => 'MTP2',
		aliases => ['hopc != 0x3aba'],
		unopt => '
			(000) ld       [7]
			(001) and      #0xc0ff0f
			(002) jeq      #0x80ae0e        jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hopc_ne
	mtp3_hopc_nary => {
		DLT => 'MTP2',
		aliases => ['hopc (9000 or 10000 or 9001)'],
		unopt => '
			(000) ld       [7]
			(001) and      #0xc0ff0f
			(002) jeq      #0xca08          jt 9	jf 3
			(003) ld       [7]
			(004) and      #0xc0ff0f
			(005) jeq      #0xc409          jt 9	jf 6
			(006) ld       [7]
			(007) and      #0xc0ff0f
			(008) jeq      #0x40ca08        jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # mtp3_hopc_nary
	mtp3_hsls => {
		DLT => 'MTP2',
		aliases => [
			'hsls 5',
			'hsls = 5',
			'hsls == 5',
			'hsls (5)',
			'hsls (5 or 5)',
		],
		opt => '
			(000) ldb      [10]
			(001) and      #0xf0
			(002) jeq      #0x50            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hsls
	mtp3_hsls_gt => {
		DLT => 'MTP2',
		aliases => ['hsls > 6'],
		unopt => '
			(000) ldb      [10]
			(001) and      #0xf0
			(002) jgt      #0x60            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hsls_gt
	mtp3_hsls_ge => {
		DLT => 'MTP2',
		aliases => ['hsls >= 7'],
		unopt => '
			(000) ldb      [10]
			(001) and      #0xf0
			(002) jge      #0x70            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # mtp3_hsls_ge
	mtp3_hsls_le => {
		DLT => 'MTP2',
		aliases => ['hsls <= 8'],
		unopt => '
			(000) ldb      [10]
			(001) and      #0xf0
			(002) jgt      #0x80            jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hsls_le
	mtp3_hsls_lt => {
		DLT => 'MTP2',
		aliases => ['hsls < 9'],
		unopt => '
			(000) ldb      [10]
			(001) and      #0xf0
			(002) jge      #0x90            jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hsls_lt
	mtp3_hsls_ne => {
		DLT => 'MTP2',
		aliases => ['hsls != 10'],
		unopt => '
			(000) ldb      [10]
			(001) and      #0xf0
			(002) jeq      #0xa0            jt 3	jf 4
			(003) ret      #0
			(004) ret      #262144
			',
	}, # mtp3_hsls_ne
	mtp3_hsls_nary => {
		DLT => 'MTP2',
		aliases => ['hsls (13 or 12 or 11)'],
		unopt => '
			(000) ldb      [10]
			(001) and      #0xf0
			(002) jeq      #0xd0            jt 9	jf 3
			(003) ldb      [10]
			(004) and      #0xf0
			(005) jeq      #0xc0            jt 9	jf 6
			(006) ldb      [10]
			(007) and      #0xf0
			(008) jeq      #0xb0            jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # mtp3_hsls_nary

	atm_vpi => {
		DLT => 'SUNATM',
		aliases => [
			'vpi 10',
			'vpi = 10',
			'vpi == 10',
			'vpi (10)',
			'vpi (10 or 10)',
		],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0xa             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # atm_vpi
	atm_vpi_gt => {
		DLT => 'SUNATM',
		aliases => ['vpi > 100'],
		unopt => '
			(000) ldb      [1]
			(001) jgt      #0x64            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # atm_vpi_gt
	atm_vpi_ge => {
		DLT => 'SUNATM',
		aliases => ['vpi >= 101'],
		unopt => '
			(000) ldb      [1]
			(001) jge      #0x65            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # atm_vpi_ge
	atm_vpi_le => {
		DLT => 'SUNATM',
		aliases => ['vpi <= 102'],
		unopt => '
			(000) ldb      [1]
			(001) jgt      #0x66            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # atm_vpi_le
	atm_vpi_lt => {
		DLT => 'SUNATM',
		aliases => ['vpi < 103'],
		unopt => '
			(000) ldb      [1]
			(001) jge      #0x67            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # atm_vpi_lt
	atm_vpi_ne => {
		DLT => 'SUNATM',
		aliases => ['vpi != 104'],
		unopt => '
			(000) ldb      [1]
			(001) jeq      #0x68            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # atm_vpi_ne
	atm_vpi_nary => {
		DLT => 'SUNATM',
		aliases => ['vpi (105 or 0x7a or 0311)'],
		# The bytecode preserves the order of values, hence no aliases for the
		# permutations.
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x69            jt 4	jf 2
			(002) jeq      #0x7a            jt 4	jf 3
			(003) jeq      #0xc9            jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # atm_vpi_nary
	atm_vci => {
		DLT => 'SUNATM',
		aliases => [
			'vci 20',
			'vci = 20',
			'vci == 20',
			'vci (20)',
			'vci (20 or 20)',
		],
		opt => '
			(000) ldh      [2]
			(001) jeq      #0x14            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # atm_vci
	atm_vci_gt => {
		DLT => 'SUNATM',
		aliases => ['vci > 20001'],
		unopt => '
			(000) ldh      [2]
			(001) jgt      #0x4e21          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # atm_vci_gt
	atm_vci_ge => {
		DLT => 'SUNATM',
		aliases => ['vci >= 20002'],
		unopt => '
			(000) ldh      [2]
			(001) jge      #0x4e22          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # atm_vci_ge
	atm_vci_le => {
		DLT => 'SUNATM',
		aliases => ['vci <= 20003'],
		unopt => '
			(000) ldh      [2]
			(001) jgt      #0x4e23          jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # atm_vci_le
	atm_vci_lt => {
		DLT => 'SUNATM',
		aliases => ['vci < 20004'],
		unopt => '
			(000) ldh      [2]
			(001) jge      #0x4e24          jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # atm_vci_lt
	atm_vci_ne => {
		DLT => 'SUNATM',
		aliases => ['vci != 20005'],
		unopt => '
			(000) ldh      [2]
			(001) jeq      #0x4e25          jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # atm_vci_ne
	atm_vci_nary => {
		DLT => 'SUNATM',
		aliases => ['vci (10 or 0xdb or 0700)'],
		opt => '
			(000) ldh      [2]
			(001) jeq      #0xa             jt 4	jf 2
			(002) jeq      #0xdb            jt 4	jf 3
			(003) jeq      #0x1c0           jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # atm_vci_nary
	atm_lane => {
		DLT => 'SUNATM',
		aliases => ['lane'],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf
			(002) jeq      #0x1             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # atm_lane
	atm_oamf4sc => {
		DLT => 'SUNATM',
		aliases => ['oamf4sc'],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 5
			(002) ldh      [2]
			(003) jeq      #0x3             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # atm_oamf4sc
	atm_oamf4ec => {
		DLT => 'SUNATM',
		aliases => ['oamf4ec'],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 5
			(002) ldh      [2]
			(003) jeq      #0x4             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # atm_oamf4ec
	atm_oamf4 => {
		DLT => 'SUNATM',
		aliases => [
			'oamf4',
			'oam',
		],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 6
			(002) ldh      [2]
			(003) jeq      #0x3             jt 5	jf 4
			(004) jeq      #0x4             jt 5	jf 6
			(005) ret      #262144
			(006) ret      #0
			',
	}, # atm_oamf4
	atm_metac => {
		DLT => 'SUNATM',
		aliases => ['metac'],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 5
			(002) ldh      [2]
			(003) jeq      #0x1             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # atm_metac
	atm_bcc => {
		DLT => 'SUNATM',
		aliases => ['bcc'],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 5
			(002) ldh      [2]
			(003) jeq      #0x2             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # atm_bcc
	atm_sc => {
		DLT => 'SUNATM',
		aliases => ['sc'],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 5
			(002) ldh      [2]
			(003) jeq      #0x5             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # atm_sc
	atm_ilmic => {
		DLT => 'SUNATM',
		aliases => ['ilmic'],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 5
			(002) ldh      [2]
			(003) jeq      #0x10            jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # atm_ilmic
	atm_connectmsg => {
		DLT => 'SUNATM',
		aliases => ['connectmsg'],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 12
			(002) ldh      [2]
			(003) jeq      #0x5             jt 4	jf 12
			(004) ldb      [9]
			(005) jeq      #0x5a            jt 11	jf 6
			(006) jeq      #0x4d            jt 11	jf 7
			(007) jeq      #0xf             jt 11	jf 8
			(008) jeq      #0x7             jt 11	jf 9
			(009) jeq      #0x5             jt 11	jf 10
			(010) jeq      #0x2             jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # atm_connectmsg
	atm_metaconnect => {
		DLT => 'SUNATM',
		aliases => ['metaconnect'],
		opt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 11
			(002) ldh      [2]
			(003) jeq      #0x1             jt 4	jf 11
			(004) ldb      [9]
			(005) jeq      #0x5a            jt 10	jf 6
			(006) jeq      #0x4d            jt 10	jf 7
			(007) jeq      #0x7             jt 10	jf 8
			(008) jeq      #0x5             jt 10	jf 9
			(009) jeq      #0x2             jt 10	jf 11
			(010) ret      #262144
			(011) ret      #0
			',
	}, # atm_metaconnect

	# Do not permutate all possible aliases for "link", just the ones that
	# obviously make sense for the DLT.
	arcnet_broadcast_multicast => {
		DLT => 'ARCNET',
		aliases => [
			'broadcast',
			'multicast',
			'link broadcast',
			'link multicast',
			'link dst $00',
		],
		unopt => '
			(000) ldb      [1]
			(001) jeq      #0x0             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # arcnet_broadcast_multicast
	arcnet_host => {
		DLT => 'ARCNET',
		aliases => [
			'link host $0e',
			'link src or dst host $0e',
			'link src or dst $0e',
			'link host $e',
			'link src or dst host $e',
			'link src or dst $e',
		],
		unopt => '
			(000) ldb      [0]
			(001) jeq      #0xe             jt 4	jf 2
			(002) ldb      [1]
			(003) jeq      #0xe             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # arcnet_host
	arcnet_src_host => {
		DLT => 'ARCNET',
		aliases => [
			'link src host $8c',
			'link src $8c',
		],
		unopt => '
			(000) ldb      [0]
			(001) jeq      #0x8c            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # arcnet_src_host
	arcnet_dst_host => {
		DLT => 'ARCNET',
		aliases => [
			'link dst host $a4',
			'link dst $a4',
		],
		unopt => '
			(000) ldb      [1]
			(001) jeq      #0xa4            jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # arcnet_dst_host
	fddi_broadcast => {
		DLT => 'FDDI',
		aliases => [
			'broadcast',
			'fddi broadcast',
			'link broadcast',
		],
		unopt => '
			(000) ld       [3]
			(001) jeq      #0xffffffff      jt 2	jf 5
			(002) ldh      [1]
			(003) jeq      #0xffff          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # fddi_broadcast
	fddi_multicast => {
		DLT => 'FDDI',
		aliases => [
			'multicast',
			'fddi multicast',
			'link multicast',
		],
		unopt => '
			(000) ldb      [1]
			(001) jset     #0x1             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # fddi_multicast
	ieee802_broadcast => {
		DLT => 'IEEE802',
		aliases => [
			'broadcast',
			'tr broadcast',
			'link broadcast',
		],
		unopt => '
			(000) ld       [4]
			(001) jeq      #0xffffffff      jt 2	jf 5
			(002) ldh      [2]
			(003) jeq      #0xffff          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ieee802_broadcast
	ieee802_multicast => {
		DLT => 'IEEE802',
		aliases => [
			'multicast',
			'tr multicast',
			'link multicast',
		],
		unopt => '
			(000) ldb      [2]
			(001) jset     #0x1             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ieee802_multicast
	ieee802_11_broadcast => {
		DLT => 'IEEE802_11',
		aliases => [
			'broadcast',
			'wlan broadcast',
			'ether broadcast',
			'link broadcast',
		],
		opt => '
			(000) ldb      [0]
			(001) jset     #0x4             jt 14	jf 2
			(002) jset     #0x8             jt 3	jf 9
			(003) ldb      [1]
			(004) jset     #0x1             jt 5	jf 9
			(005) ld       [18]
			(006) jeq      #0xffffffff      jt 7	jf 14
			(007) ldh      [16]
			(008) jeq      #0xffff          jt 13	jf 14
			(009) ld       [6]
			(010) jeq      #0xffffffff      jt 11	jf 14
			(011) ldh      [4]
			(012) jeq      #0xffff          jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # ieee802_11_broadcast
	ieee802_11_multicast => {
		DLT => 'IEEE802_11',
		aliases => [
			'multicast',
			'wlan multicast',
			'ether multicast',
			'link multicast',
		],
		opt => '
			(000) ldb      [0]
			(001) jset     #0x4             jt 10	jf 2
			(002) jset     #0x8             jt 3	jf 7
			(003) ldb      [1]
			(004) jset     #0x1             jt 5	jf 7
			(005) ldb      [16]
			(006) jset     #0x1             jt 9	jf 10
			(007) ldb      [4]
			(008) jset     #0x1             jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # ieee802_11_multicast
	ip_over_fc_broadcast => {
		DLT => 'IP_OVER_FC',
		aliases => [
			'broadcast',
			'link broadcast',
		],
		unopt => '
			(000) ld       [4]
			(001) jeq      #0xffffffff      jt 2	jf 5
			(002) ldh      [2]
			(003) jeq      #0xffff          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ip_over_fc_broadcast
	ip_over_fc_multicast => {
		DLT => 'IP_OVER_FC',
		aliases => [
			'multicast',
			'link multicast',
		],
		opt => '
			(000) ldb      [2]
			(001) jset     #0x1             jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ip_over_fc_multicast


	ether_broadcast => {
		DLT => 'EN10MB',
		snaplen => 16000,
		aliases => [
			'broadcast',
			'ether broadcast',
			'link broadcast',
		],
		opt => '
			(000) ld       [2]
			(001) jeq      #0xffffffff      jt 2	jf 5
			(002) ldh      [0]
			(003) jeq      #0xffff          jt 4	jf 5
			(004) ret      #16000
			(005) ret      #0
			',
	}, # ether_broadcast
	ether_multicast => {
		DLT => 'EN10MB',
		snaplen => 16000,
		aliases => [
			'multicast',
			'ether multicast',
			'link multicast',
		],
		opt => '
			(000) ldb      [0]
			(001) jset     #0x1             jt 2	jf 3
			(002) ret      #16000
			(003) ret      #0
			',
	}, # ether_multicast
	ether_host_addr => {
		DLT => 'EN10MB',
		aliases => [
			'ether host ab:cd:ef:0:0:1',
			'ether src or dst host ab.CD.ef.0.0.1',
			'ether src or dst Ab.cD.ef.00.0.01',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0xef000001      jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xabcd          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0xef000001      jt 6	jf 9
			(006) ldh      [0]
			(007) jeq      #0xabcd          jt 8	jf 9
			(008) ret      #262144
			(009) ret      #0
			',
	}, # ether_host_addr
	ether_host_name => {
		skip => skip_no_ethers(),
		DLT => 'EN10MB',
		aliases => [
			'ether host eth-noipv4-noipv6.host123.libpcap.test',
			'ether src or dst eth-noipv4-noipv6.host123.libpcap.test',
			'ether src or dst host eth-noipv4-noipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 9
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 9
			(008) ret      #262144
			(009) ret      #0
			',
	}, # ether_host_name
	ether_host_NAME => {
		skip => skip_no_ethers_casecmp(),
		DLT => 'EN10MB',
		aliases => [
			'ether host ETH-NOIPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ether src or dst ETH-NOIPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ether src or dst host ETH-NOIPV4-NOIPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 9
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 9
			(008) ret      #262144
			(009) ret      #0
			',
	}, # ether_host_NAME
	ether_src_host_addr => {
		DLT => 'EN10MB',
		aliases => [
			'ether src host ab-cd-ef-00-00-02',
			'ether src ab.cd.ef.00.00.02',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0xef000002      jt 2	jf 5
			(002) ldh      [6]
			(003) jeq      #0xabcd          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_src_host_addr
	ether_src_host_name => {
		skip => skip_no_ethers(),
		DLT => 'EN10MB',
		aliases => [
			'ether src host eth-noipv4-noipv6.host123.libpcap.test',
			'ether src eth-noipv4-noipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 5
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_src_host_name
	ether_src_host_NAME => {
		skip => skip_no_ethers_casecmp(),
		DLT => 'EN10MB',
		aliases => [
			'ether src host ETH-NOIPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ether src ETH-NOIPV4-NOIPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 5
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_src_host_NAME
	ether_dst_host_addr => {
		DLT => 'EN10MB',
		aliases => [
			'ether dst host abcd.ef00.0003',
			'ether dst abcdef000003',
		],
		opt => '
			(000) ld       [2]
			(001) jeq      #0xef000003      jt 2	jf 5
			(002) ldh      [0]
			(003) jeq      #0xabcd          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_dst_host_addr
	ether_dst_host_name => {
		skip => skip_no_ethers(),
		DLT => 'EN10MB',
		aliases => [
			'ether dst host eth-noipv4-noipv6.host123.libpcap.test',
			'ether dst eth-noipv4-noipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [2]
			(001) jeq      #0x400140e       jt 2	jf 5
			(002) ldh      [0]
			(003) jeq      #0xaa00          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_dst_host_name
	ether_dst_host_NAME => {
		skip => skip_no_ethers_casecmp(),
		DLT => 'EN10MB',
		aliases => [
			'ether dst host ETH-NOIPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ether dst ETH-NOIPV4-NOIPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [2]
			(001) jeq      #0x400140e       jt 2	jf 5
			(002) ldh      [0]
			(003) jeq      #0xaa00          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_dst_host_NAME

	ether_proto_aarp => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \aarp',
			'aarp',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x80f3          jt 7	jf 2
			(002) jgt      #0x5dc           jt 8	jf 3
			(003) ld       [18]
			(004) jeq      #0x80f3          jt 5	jf 8
			(005) ld       [14]
			(006) jeq      #0xaaaa0300      jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # ether_proto_aarp
	ether_proto_arp => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \arp',
			'arp',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x806           jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_arp
	ether_proto_atalk => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \atalk',
			'atalk',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x809b          jt 7	jf 2
			(002) jgt      #0x5dc           jt 8	jf 3
			(003) ld       [18]
			(004) jeq      #0x7809b         jt 5	jf 8
			(005) ld       [14]
			(006) jeq      #0xaaaa0308      jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # ether_proto_atalk
	ether_proto_decnet => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \decnet',
			'decnet',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x6003          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_decnet
	ether_proto_ip => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \ip',
			'ip',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_ip
	ether_proto_ip6 => {
		DLT => 'EN10MB',
		skip => skip_config_undef ('INET6'),
		aliases => ['ether proto \ip6'],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_ip6
	ip6 => {
		DLT => 'EN10MB',
		aliases => ['ip6'],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ip6
	ether_proto_ipx => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \ipx',
			'ipx',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x8137          jt 11	jf 2
			(002) jgt      #0x5dc           jt 12	jf 3
			(003) ld       [18]
			(004) jeq      #0x8137          jt 5	jf 7
			(005) ld       [14]
			(006) jeq      #0xaaaa0300      jt 11	jf 7
			(007) ldb      [14]
			(008) jeq      #0xe0            jt 11	jf 9
			(009) ldh      [14]
			(010) jeq      #0xffff          jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # ether_proto_ipx
	ether_proto_iso => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \iso',
			'iso',
		],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 5	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_proto_iso
	ether_proto_lat => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \lat',
			'lat',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x6004          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_lat
	ether_proto_loopback => {
		DLT => 'EN10MB',
		# No backslash escaping and no alias (the identifier is not a keyword).
		aliases => ['ether proto loopback'],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x9000          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_loopback
	ether_proto_mopdl => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \mopdl',
			'mopdl',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x6001          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_mopdl
	ether_proto_moprc => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \moprc',
			'moprc',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x6002          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_
	ether_proto_netbeui => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \netbeui',
			'netbeui',
		],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 5	jf 2
			(002) ldh      [14]
			(003) jeq      #0xf0f0          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_proto_netbeui
	ether_proto_rarp => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \rarp',
			'rarp',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x8035          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_rarp
	ether_proto_sca => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \sca',
			'sca',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x6007          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # ether_proto_sca
	ether_proto_stp => {
		DLT => 'EN10MB',
		aliases => [
			'ether proto \stp',
			'stp',
		],
		opt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 5	jf 2
			(002) ldb      [14]
			(003) jeq      #0x42            jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ether_proto_stp

	vlan_eth_nullary => {
		DLT => 'EN10MB',
		aliases => ['vlan'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x8100          jt 4	jf 2
			(002) jeq      #0x88a8          jt 4	jf 3
			(003) jeq      #0x9100          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # vlan_eth_nullary
	vlan_eth_unary => {
		DLT => 'EN10MB',
		aliases => ['vlan 4095'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x8100          jt 4	jf 2
			(002) jeq      #0x88a8          jt 4	jf 3
			(003) jeq      #0x9100          jt 4	jf 8
			(004) ldh      [14]
			(005) and      #0xfff
			(006) jeq      #0xfff           jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # vlan_eth_unary
	vlan_and_vlan_eth => {
		DLT => 'EN10MB',
		aliases => ['vlan and vlan'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x8100          jt 4	jf 2
			(002) jeq      #0x88a8          jt 4	jf 3
			(003) jeq      #0x9100          jt 4	jf 9
			(004) ldh      [16]
			(005) jeq      #0x8100          jt 8	jf 6
			(006) jeq      #0x88a8          jt 8	jf 7
			(007) jeq      #0x9100          jt 8	jf 9
			(008) ret      #262144
			(009) ret      #0
			',
	}, # vlan_and_vlan_eth
	vlan_netanalyzer_nullary => {
		DLT => 'NETANALYZER',
		aliases => ['vlan'],
		opt => '
			(000) ldh      [16]
			(001) jeq      #0x8100          jt 4	jf 2
			(002) jeq      #0x88a8          jt 4	jf 3
			(003) jeq      #0x9100          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # vlan_netanalyzer_nullary
	vlan_netanalyzer_unary => {
		DLT => 'NETANALYZER',
		aliases => ['vlan 10'],
		opt => '
			(000) ldh      [16]
			(001) jeq      #0x8100          jt 4	jf 2
			(002) jeq      #0x88a8          jt 4	jf 3
			(003) jeq      #0x9100          jt 4	jf 8
			(004) ldh      [18]
			(005) and      #0xfff
			(006) jeq      #0xa             jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # vlan_netanalyzer_unary
	vlan_eth_linuxext_nullary => {
		skip => skip_os_not ('linux') || skip_config_have_decl ('SKF_AD_VLAN_TAG_PRESENT', 0),
		DLT => 'EN10MB',
		linuxext => 1,
		aliases => ['vlan'],
		opt => '
			(000) ldb      [vlanp]
			(001) jeq      #0x1             jt 6	jf 2
			(002) ldh      [12]
			(003) jeq      #0x8100          jt 6	jf 4
			(004) jeq      #0x88a8          jt 6	jf 5
			(005) jeq      #0x9100          jt 6	jf 7
			(006) ret      #262144
			(007) ret      #0
			',
	}, # vlan_eth_linuxext_nullary
	vlan_eth_linuxext_unary => {
		skip => skip_os_not ('linux') || skip_config_have_decl ('SKF_AD_VLAN_TAG_PRESENT', 0),
		DLT => 'EN10MB',
		linuxext => 1,
		aliases => ['vlan 10'],
		opt => '
			(000) ldb      [vlanp]
			(001) jeq      #0x1             jt 6	jf 2
			(002) ldh      [12]
			(003) jeq      #0x8100          jt 6	jf 4
			(004) jeq      #0x88a8          jt 6	jf 5
			(005) jeq      #0x9100          jt 6	jf 14
			(006) ldb      [vlanp]
			(007) jeq      #0x1             jt 8	jf 10
			(008) ldh      [vlan_tci]
			(009) ja       11
			(010) ldh      [14]
			(011) and      #0xfff
			(012) jeq      #0xa             jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # vlan_eth_linuxext_unary
	vlan_and_vlan_eth_linuxext => {
		skip => skip_os_not ('linux') || skip_config_have_decl ('SKF_AD_VLAN_TAG_PRESENT', 0),
		DLT => 'EN10MB',
		linuxext => 1,
		aliases => ['vlan and vlan'],
		opt => '
			(000) ld       #0x0
			(001) st       M[1]
			(002) ldb      [vlanp]
			(003) jeq      #0x1             jt 10	jf 4
			(004) ld       #0x4
			(005) st       M[1]
			(006) ldh      [12]
			(007) jeq      #0x8100          jt 10	jf 8
			(008) jeq      #0x88a8          jt 10	jf 9
			(009) jeq      #0x9100          jt 10	jf 16
			(010) ldx      M[1]
			(011) ldh      [x + 12]
			(012) jeq      #0x8100          jt 15	jf 13
			(013) jeq      #0x88a8          jt 15	jf 14
			(014) jeq      #0x9100          jt 15	jf 16
			(015) ret      #262144
			(016) ret      #0
			',
	}, # vlan_and_vlan_eth_linuxext

	mpls_eth_nullary => {
		DLT => 'EN10MB',
		aliases => ['mpls'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x8847          jt 2	jf 3
			(002) ret      #262144
			(003) ret      #0
			',
	}, # mpls_eth_nullary
	mpls_eth_unary => {
		DLT => 'EN10MB',
		aliases => ['mpls 100'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x8847          jt 2	jf 6
			(002) ld       [14]
			(003) and      #0xfffff000
			(004) jeq      #0x64000         jt 5	jf 6
			(005) ret      #262144
			(006) ret      #0
			',
	}, # mpls_eth_unary
	mpls_and_mpls_eth => {
		DLT => 'EN10MB',
		aliases => ['mpls and mpls'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x8847          jt 2	jf 5
			(002) ldb      [16]
			(003) jset     #0x1             jt 5	jf 4
			(004) ret      #262144
			(005) ret      #0
			',
	}, # mpls_and_mpls_eth
	mpls_ppp_unary => {
		DLT => 'PPP',
		aliases => ['mpls 100'],
		opt => '
			(000) ldh      [2]
			(001) jeq      #0x281           jt 2	jf 6
			(002) ld       [4]
			(003) and      #0xfffff000
			(004) jeq      #0x64000         jt 5	jf 6
			(005) ret      #262144
			(006) ret      #0
			',
	}, # mpls_ppp_unary

	wlan_host => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan host 12:34:56:78:9a:bc',
			'wlan src or dst host 12:34:56:78:9a:bc',
			'wlan src or dst 12:34:56:78:9a:bc',
		],
		opt => '
			(000) ldb      [0]
			(001) jset     #0x4             jt 33	jf 2
			(002) jset     #0x8             jt 3	jf 24
			(003) ldb      [1]
			(004) jset     #0x2             jt 5	jf 14
			(005) jset     #0x1             jt 6	jf 10
			(006) ld       [26]
			(007) jeq      #0x56789abc      jt 8	jf 20
			(008) ldh      [24]
			(009) jeq      #0x1234          jt 32	jf 20
			(010) ld       [18]
			(011) jeq      #0x56789abc      jt 12	jf 28
			(012) ldh      [16]
			(013) jeq      #0x1234          jt 32	jf 28
			(014) ld       [12]
			(015) jeq      #0x56789abc      jt 16	jf 18
			(016) ldh      [10]
			(017) jeq      #0x1234          jt 32	jf 18
			(018) ldb      [1]
			(019) jset     #0x1             jt 20	jf 28
			(020) ld       [18]
			(021) jeq      #0x56789abc      jt 22	jf 33
			(022) ldh      [16]
			(023) jeq      #0x1234          jt 32	jf 33
			(024) ld       [12]
			(025) jeq      #0x56789abc      jt 26	jf 28
			(026) ldh      [10]
			(027) jeq      #0x1234          jt 32	jf 28
			(028) ld       [6]
			(029) jeq      #0x56789abc      jt 30	jf 33
			(030) ldh      [4]
			(031) jeq      #0x1234          jt 32	jf 33
			(032) ret      #262144
			(033) ret      #0
			',
	}, # wlan_host
	wlan_src_host => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan src host 12:34:56:78:9a:bc',
			'wlan src 12:34:56:78:9a:bc',
		],
		opt => '
			(000) ldb      [0]
			(001) jset     #0x4             jt 19	jf 2
			(002) jset     #0x8             jt 3	jf 14
			(003) ldb      [1]
			(004) jset     #0x2             jt 5	jf 14
			(005) jset     #0x1             jt 6	jf 10
			(006) ld       [26]
			(007) jeq      #0x56789abc      jt 8	jf 19
			(008) ldh      [24]
			(009) jeq      #0x1234          jt 18	jf 19
			(010) ld       [18]
			(011) jeq      #0x56789abc      jt 12	jf 19
			(012) ldh      [16]
			(013) jeq      #0x1234          jt 18	jf 19
			(014) ld       [12]
			(015) jeq      #0x56789abc      jt 16	jf 19
			(016) ldh      [10]
			(017) jeq      #0x1234          jt 18	jf 19
			(018) ret      #262144
			(019) ret      #0
			',
	}, # wlan_src_host
	wlan_dst_host => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan dst host 12:34:56:78:9a:bc',
			'wlan dst 12:34:56:78:9a:bc',
		],
		opt => '
			(000) ldb      [0]
			(001) jset     #0x4             jt 14	jf 2
			(002) jset     #0x8             jt 3	jf 9
			(003) ldb      [1]
			(004) jset     #0x1             jt 5	jf 9
			(005) ld       [18]
			(006) jeq      #0x56789abc      jt 7	jf 14
			(007) ldh      [16]
			(008) jeq      #0x1234          jt 13	jf 14
			(009) ld       [6]
			(010) jeq      #0x56789abc      jt 11	jf 14
			(011) ldh      [4]
			(012) jeq      #0x1234          jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # wlan_dst_host
	wlan_ra => {
		DLT => 'IEEE802_11',
		aliases => ['wlan ra 12:34:56:78:9a:bc'],
		opt => '
			(000) ldb      [0]
			(001) jset     #0x8             jt 2	jf 7
			(002) ld       [6]
			(003) jeq      #0x56789abc      jt 4	jf 7
			(004) ldh      [4]
			(005) jeq      #0x1234          jt 6	jf 7
			(006) ret      #262144
			(007) ret      #0
			',
	}, # wlan_ra
	wlan_ta => {
		DLT => 'IEEE802_11',
		aliases => ['wlan ta 12:34:56:78:9a:bc'],
		opt => '
			(000) ldb      [0]
			(001) jset     #0x8             jt 2	jf 15
			(002) and      #0xc
			(003) jeq      #0x4             jt 4	jf 10
			(004) ldb      [0]
			(005) and      #0xf0
			(006) jeq      #0xc0            jt 15	jf 7
			(007) ldb      [0]
			(008) and      #0xf0
			(009) jeq      #0xd0            jt 15	jf 10
			(010) ld       [12]
			(011) jeq      #0x56789abc      jt 12	jf 15
			(012) ldh      [10]
			(013) jeq      #0x1234          jt 14	jf 15
			(014) ret      #262144
			(015) ret      #0
			',
	}, # wlan_ta
	wlan_addr1 => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan addr1 12:34:56:78:9a:bc',
			'wlan address1 12:34:56:78:9a:bc',
		],
		opt => '
			(000) ld       [6]
			(001) jeq      #0x56789abc      jt 2	jf 5
			(002) ldh      [4]
			(003) jeq      #0x1234          jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # wlan_addr1
	wlan_addr2 => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan addr2 12:34:56:78:9a:bc',
			'wlan address2 12:34:56:78:9a:bc',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xc
			(002) jeq      #0x4             jt 3	jf 9
			(003) ldb      [0]
			(004) and      #0xf0
			(005) jeq      #0xc0            jt 14	jf 6
			(006) ldb      [0]
			(007) and      #0xf0
			(008) jeq      #0xd0            jt 14	jf 9
			(009) ld       [12]
			(010) jeq      #0x56789abc      jt 11	jf 14
			(011) ldh      [10]
			(012) jeq      #0x1234          jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # wlan_addr2
	wlan_addr3 => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan addr3 12:34:56:78:9a:bc',
			'wlan address3 12:34:56:78:9a:bc',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xc
			(002) jeq      #0x4             jt 8	jf 3
			(003) ld       [18]
			(004) jeq      #0x56789abc      jt 5	jf 8
			(005) ldh      [16]
			(006) jeq      #0x1234          jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # wlan_addr3
	wlan_addr4 => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan addr4 12:34:56:78:9a:bc',
			'wlan address4 12:34:56:78:9a:bc',
		],
		opt => '
			(000) ldb      [1]
			(001) and      #0x3
			(002) jeq      #0x3             jt 3	jf 8
			(003) ld       [26]
			(004) jeq      #0x56789abc      jt 5	jf 8
			(005) ldh      [24]
			(006) jeq      #0x1234          jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # wlan_addr4
	wlan_type_mgt => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan type mgt',
			'type mgt',
			'wlan type 0',
			'type 0',
			'wlan type management',
			'type management',
		],
		opt => '
			(000) ldb      [0]
			(001) jset     #0xc             jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # type_mgt
	wlan_subtype_assoc_req => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype assoc-req',
			'subtype assoc-req',
			'wlan type mgt subtype assoc-req',
			'type mgt subtype assoc-req',
			'wlan type 0 subtype assoc-req',
			'type 0 subtype assoc-req',
			'wlan type mgt subtype 0x00',
			'type mgt subtype 0x00',
			'wlan type 0 subtype 0x00',
			'type 0 subtype 0x00',
			'wlan subtype assocreq',
			'subtype assocreq',
			'wlan type mgt subtype assocreq',
			'type mgt subtype assocreq',
			'wlan type 0 subtype assocreq',
			'type 0 subtype assocreq',
			'wlan type management subtype assoc-req',
			'type management subtype assoc-req',
			'wlan type management subtype 0x00',
			'type management subtype 0x00',
			'wlan type management subtype assocreq',
			'type management subtype assocreq',
		],
		opt => '
			(000) ldb      [0]
			(001) jset     #0xfc            jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # wlan_type_mgt_subtype_assoc_req
	wlan_subtype_assoc_resp => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype assoc-resp',
			'subtype assoc-resp',
			'wlan type mgt subtype assoc-resp',
			'type mgt subtype assoc-resp',
			'wlan type 0 subtype assoc-resp',
			'type 0 subtype assoc-resp',
			'wlan type mgt subtype 0x10',
			'type mgt subtype 0x10',
			'wlan type 0 subtype 0x10',
			'type 0 subtype 0x10',
			'wlan subtype assocresp',
			'subtype assocresp',
			'wlan type mgt subtype assocresp',
			'type mgt subtype assocresp',
			'wlan type 0 subtype assocresp',
			'type 0 subtype assocresp',
			'wlan type management subtype assoc-resp',
			'type management subtype assoc-resp',
			'wlan type management subtype 0x10',
			'type management subtype 0x10',
			'wlan type management subtype assocresp',
			'type management subtype assocresp',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x10            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_assoc_resp
	wlan_subtype_reassoc_req => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype reassoc-req',
			'subtype reassoc-req',
			'wlan type mgt subtype reassoc-req',
			'type mgt subtype reassoc-req',
			'wlan type 0 subtype reassoc-req',
			'type 0 subtype reassoc-req',
			'wlan type mgt subtype 0x20',
			'type mgt subtype 0x20',
			'wlan type 0 subtype 0x20',
			'type 0 subtype 0x20',
			'wlan subtype reassocreq',
			'subtype reassocreq',
			'wlan type mgt subtype reassocreq',
			'type mgt subtype reassocreq',
			'wlan type 0 subtype reassocreq',
			'type 0 subtype reassocreq',
			'wlan type management subtype reassoc-req',
			'type management subtype reassoc-req',
			'wlan type management subtype 0x20',
			'type management subtype 0x20',
			'wlan type management subtype reassocreq',
			'type management subtype reassocreq',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x20            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_reassoc_req
	wlan_subtype_reassoc_resp => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype reassoc-resp',
			'subtype reassoc-resp',
			'wlan type mgt subtype reassoc-resp',
			'type mgt subtype reassoc-resp',
			'wlan type 0 subtype reassoc-resp',
			'type 0 subtype reassoc-resp',
			'wlan type mgt subtype 0x30',
			'type mgt subtype 0x30',
			'wlan type 0 subtype 0x30',
			'type 0 subtype 0x30',
			'wlan subtype reassocresp',
			'subtype reassocresp',
			'wlan type mgt subtype reassocresp',
			'type mgt subtype reassocresp',
			'wlan type 0 subtype reassocresp',
			'type 0 subtype reassocresp',
			'wlan type management subtype reassoc-resp',
			'type management subtype reassoc-resp',
			'wlan type management subtype 0x30',
			'type management subtype 0x30',
			'wlan type management subtype reassocresp',
			'type management subtype reassocresp',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x30            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_mgt_subtype_reassoc_resp
	wlan_subtype_probe_req => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype probe-req',
			'subtype probe-req',
			'wlan type mgt subtype probe-req',
			'type mgt subtype probe-req',
			'wlan type 0 subtype probe-req',
			'type 0 subtype probe-req',
			'wlan type mgt subtype 0x40',
			'type mgt subtype 0x40',
			'wlan type 0 subtype 0x40',
			'type 0 subtype 0x40',
			'wlan subtype probereq',
			'subtype probereq',
			'wlan type mgt subtype probereq',
			'type mgt subtype probereq',
			'wlan type 0 subtype probereq',
			'type 0 subtype probereq',
			'wlan type management subtype probe-req',
			'type management subtype probe-req',
			'wlan type management subtype 0x40',
			'type management subtype 0x40',
			'wlan type management subtype probereq',
			'type management subtype probereq',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x40            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_probe_req
	wlan_subtype_probe_resp => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype probe-resp',
			'subtype probe-resp',
			'wlan type mgt subtype probe-resp',
			'type mgt subtype probe-resp',
			'wlan type 0 subtype probe-resp',
			'type 0 subtype probe-resp',
			'wlan type mgt subtype 0x50',
			'type mgt subtype 0x50',
			'wlan type 0 subtype 0x50',
			'type 0 subtype 0x50',
			'wlan subtype proberesp',
			'subtype proberesp',
			'wlan type mgt subtype proberesp',
			'type mgt subtype proberesp',
			'wlan type 0 subtype proberesp',
			'type 0 subtype proberesp',
			'wlan type management subtype probe-resp',
			'type management subtype probe-resp',
			'wlan type management subtype 0x50',
			'type management subtype 0x50',
			'wlan type management subtype proberesp',
			'type management subtype proberesp',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x50            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_probe_resp
	wlan_subtype_beacon => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype beacon',
			'subtype beacon',
			'wlan type mgt subtype beacon',
			'type mgt subtype beacon',
			'wlan type 0 subtype beacon',
			'type 0 subtype beacon',
			'wlan type mgt subtype 0x80',
			'type mgt subtype 0x80',
			'wlan type 0 subtype 0x80',
			'type 0 subtype 0x80',
			'wlan type management subtype beacon',
			'type management subtype beacon',
			'wlan type management subtype 0x80',
			'type management subtype 0x80',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x80            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_beacon
	wlan_subtype_atim => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype atim',
			'subtype atim',
			'wlan type mgt subtype atim',
			'type mgt subtype atim',
			'wlan type 0 subtype atim',
			'type 0 subtype atim',
			'wlan type mgt subtype 0x90',
			'type mgt subtype 0x90',
			'wlan type 0 subtype 0x90',
			'type 0 subtype 0x90',
			'wlan type management subtype atim',
			'type management subtype atim',
			'wlan type management subtype 0x90',
			'type management subtype 0x90',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x90            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_atim
	wlan_subtype_disassoc => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype disassoc',
			'subtype disassoc',
			'wlan type mgt subtype disassoc',
			'type mgt subtype disassoc',
			'wlan type 0 subtype disassoc',
			'type 0 subtype disassoc',
			'wlan type mgt subtype 0xa0',
			'type mgt subtype 0xa0',
			'wlan type 0 subtype 0xa0',
			'type 0 subtype 0xa0',
			'wlan subtype disassociation',
			'subtype disassociation',
			'wlan type mgt subtype disassociation',
			'type mgt subtype disassociation',
			'wlan type 0 subtype disassociation',
			'type 0 subtype disassociation',
			'wlan type management subtype disassoc',
			'type management subtype disassoc',
			'wlan type management subtype 0xa0',
			'type management subtype 0xa0',
			'wlan type management subtype disassociation',
			'type management subtype disassociation',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xa0            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_disassoc
	wlan_subtype_auth => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype auth',
			'subtype auth',
			'wlan type mgt subtype auth',
			'type mgt subtype auth',
			'wlan type 0 subtype auth',
			'type 0 subtype auth',
			'wlan type mgt subtype 0xb0',
			'type mgt subtype 0xb0',
			'wlan type 0 subtype 0xb0',
			'type 0 subtype 0xb0',
			'wlan subtype authentication',
			'subtype authentication',
			'wlan type mgt subtype authentication',
			'type mgt subtype authentication',
			'wlan type 0 subtype authentication',
			'type 0 subtype authentication',
			'wlan type management subtype auth',
			'type management subtype auth',
			'wlan type management subtype 0xb0',
			'type management subtype 0xb0',
			'wlan type management subtype authentication',
			'type management subtype authentication',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xb0            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_auth
	wlan_subtype_deauth => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype deauth',
			'subtype deauth',
			'wlan type mgt subtype deauth',
			'type mgt subtype deauth',
			'wlan type 0 subtype deauth',
			'type 0 subtype deauth',
			'wlan type mgt subtype 0xc0',
			'type mgt subtype 0xc0',
			'wlan type 0 subtype 0xc0',
			'type 0 subtype 0xc0',
			'wlan subtype deauthentication',
			'subtype deauthentication',
			'wlan type mgt subtype deauthentication',
			'type mgt subtype deauthentication',
			'wlan type 0 subtype deauthentication',
			'type 0 subtype deauthentication',
			'wlan type management subtype deauth',
			'type management subtype deauth',
			'wlan type management subtype 0xc0',
			'type management subtype 0xc0',
			'wlan type management subtype deauthentication',
			'type management subtype deauthentication',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xc0            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_deauth
	wlan_type_ctl => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan type ctl',
			'type ctl',
			'wlan type 4',
			'type 4',
			'wlan type control',
			'type control',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xc
			(002) jeq      #0x4             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # type_ctl
	wlan_subtype_bar => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype bar',
			'subtype bar',
			'wlan type ctl subtype bar',
			'type ctl subtype bar',
			'wlan type 4 subtype bar',
			'type 4 subtype bar',
			'wlan type ctl subtype 0x80',
			'type ctl subtype 0x80',
			'wlan type 4 subtype 0x80',
			'type 4 subtype 0x80',
			'wlan type control subtype bar',
			'type control subtype bar',
			'wlan type control subtype 0x80',
			'type control subtype 0x80',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x84            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_bar
	wlan_subtype_ba => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype ba',
			'subtype ba',
			'wlan type ctl subtype ba',
			'type ctl subtype ba',
			'wlan type 4 subtype ba',
			'type 4 subtype ba',
			'wlan type ctl subtype 0x90',
			'type ctl subtype 0x90',
			'wlan type 4 subtype 0x90',
			'type 4 subtype 0x90',
			'wlan type control subtype ba',
			'type control subtype ba',
			'wlan type control subtype 0x90',
			'type control subtype 0x90',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x94            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_ba
	wlan_subtype_ps_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype ps-poll',
			'subtype ps-poll',
			'wlan type ctl subtype ps-poll',
			'type ctl subtype ps-poll',
			'wlan type 4 subtype ps-poll',
			'type 4 subtype ps-poll',
			'wlan type ctl subtype 0xa0',
			'type ctl subtype 0xa0',
			'wlan type 4 subtype 0xa0',
			'type 4 subtype 0xa0',
			'wlan type control subtype ps-poll',
			'type control subtype ps-poll',
			'wlan type control subtype 0xa0',
			'type control subtype 0xa0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xa4            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_ps_poll
	wlan_subtype_rts => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype rts',
			'subtype rts',
			'wlan type ctl subtype rts',
			'type ctl subtype rts',
			'wlan type 4 subtype rts',
			'type 4 subtype rts',
			'wlan type ctl subtype 0xb0',
			'type ctl subtype 0xb0',
			'wlan type 4 subtype 0xb0',
			'type 4 subtype 0xb0',
			'wlan type control subtype rts',
			'type control subtype rts',
			'wlan type control subtype 0xb0',
			'type control subtype 0xb0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xb4            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_rts
	wlan_subtype_cts => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype cts',
			'subtype cts',
			'wlan type ctl subtype cts',
			'type ctl subtype cts',
			'wlan type 4 subtype cts',
			'type 4 subtype cts',
			'wlan type ctl subtype 0xc0',
			'type ctl subtype 0xc0',
			'wlan type 4 subtype 0xc0',
			'type 4 subtype 0xc0',
			'wlan type control subtype cts',
			'type control subtype cts',
			'wlan type control subtype 0xc0',
			'type control subtype 0xc0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xc4            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_cts
	wlan_subtype_ack => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype ack',
			'subtype ack',
			'wlan type ctl subtype ack',
			'type ctl subtype ack',
			'wlan type 4 subtype ack',
			'type 4 subtype ack',
			'wlan type ctl subtype 0xd0',
			'type ctl subtype 0xd0',
			'wlan type 4 subtype 0xd0',
			'type 4 subtype 0xd0',
			'wlan type control subtype ack',
			'type control subtype ack',
			'wlan type control subtype 0xd0',
			'type control subtype 0xd0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xd4            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_ack
	wlan_subtype_cf_end => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype cf-end',
			'subtype cf-end',
			'wlan type ctl subtype cf-end',
			'type ctl subtype cf-end',
			'wlan type 4 subtype cf-end',
			'type 4 subtype cf-end',
			'wlan type ctl subtype 0xe0',
			'type ctl subtype 0xe0',
			'wlan type 4 subtype 0xe0',
			'type 4 subtype 0xe0',
			'wlan type control subtype cf-end',
			'type control subtype cf-end',
			'wlan type control subtype 0xe0',
			'type control subtype 0xe0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xe4            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_cf_end
	wlan_subtype_cf_end_ack => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype cf-end-ack',
			'subtype cf-end-ack',
			'wlan type ctl subtype cf-end-ack',
			'type ctl subtype cf-end-ack',
			'wlan type 4 subtype cf-end-ack',
			'type 4 subtype cf-end-ack',
			'wlan type ctl subtype 0xf0',
			'type ctl subtype 0xf0',
			'wlan type 4 subtype 0xf0',
			'type 4 subtype 0xf0',
			'wlan type control subtype cf-end-ack',
			'type control subtype cf-end-ack',
			'wlan type control subtype 0xf0',
			'type control subtype 0xf0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xf4            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_cf_end_ack
	wlan_type_data => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan type data',
			'type data',
			'wlan type 8',
			'type 8',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xc
			(002) jeq      #0x8             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_type_data
	wlan_subtype_data => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype data',
			'subtype data',
			'wlan type data subtype data',
			'type data subtype data',
			'wlan type 8 subtype data',
			'type 8 subtype data',
			'wlan type data subtype 0x00',
			'type data subtype 0x00',
			'wlan type 8 subtype 0x00',
			'type 8 subtype 0x00',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x8             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_data
	wlan_subtype_data_cf_ack => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype data-cf-ack',
			'subtype data-cf-ack',
			'wlan type data subtype data-cf-ack',
			'type data subtype data-cf-ack',
			'wlan type 8 subtype data-cf-ack',
			'type 8 subtype data-cf-ack',
			'wlan type data subtype 0x10',
			'type data subtype 0x10',
			'wlan type 8 subtype 0x10',
			'type 8 subtype 0x10',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x18            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_data_cf_ack
	wlan_subtype_data_cf_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype data-cf-poll',
			'subtype data-cf-poll',
			'wlan type data subtype data-cf-poll',
			'type data subtype data-cf-poll',
			'wlan type 8 subtype data-cf-poll',
			'type 8 subtype data-cf-poll',
			'wlan type data subtype 0x20',
			'type data subtype 0x20',
			'wlan type 8 subtype 0x20',
			'type 8 subtype 0x20',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x28            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_data_cf_poll
	wlan_subtype_data_cf_ack_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype data-cf-ack-poll',
			'subtype data-cf-ack-poll',
			'wlan type data subtype data-cf-ack-poll',
			'type data subtype data-cf-ack-poll',
			'wlan type 8 subtype data-cf-ack-poll',
			'type 8 subtype data-cf-ack-poll',
			'wlan type data subtype 0x30',
			'type data subtype 0x30',
			'wlan type 8 subtype 0x30',
			'type 8 subtype 0x30',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x38            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_data_cf_ack_poll
	wlan_subtype_null => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype null',
			'subtype null',
			'wlan type data subtype null',
			'type data subtype null',
			'wlan type 8 subtype null',
			'type 8 subtype null',
			'wlan type data subtype 0x40',
			'type data subtype 0x40',
			'wlan type 8 subtype 0x40',
			'type 8 subtype 0x40',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x48            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_null
	wlan_subtype_cf_ack => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype cf-ack',
			'subtype cf-ack',
			'wlan type data subtype cf-ack',
			'type data subtype cf-ack',
			'wlan type 8 subtype cf-ack',
			'type 8 subtype cf-ack',
			'wlan type data subtype 0x50',
			'type data subtype 0x50',
			'wlan type 8 subtype 0x50',
			'type 8 subtype 0x50',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x58            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_cf_ack
	wlan_subtype_cf_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype cf-poll',
			'subtype cf-poll',
			'wlan type data subtype cf-poll',
			'type data subtype cf-poll',
			'wlan type 8 subtype cf-poll',
			'type 8 subtype cf-poll',
			'wlan type data subtype 0x60',
			'type data subtype 0x60',
			'wlan type 8 subtype 0x60',
			'type 8 subtype 0x60',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x68            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_cf_poll
	wlan_subtype_cf_ack_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype cf-ack-poll',
			'subtype cf-ack-poll',
			'wlan type data subtype cf-ack-poll',
			'type data subtype cf-ack-poll',
			'wlan type 8 subtype cf-ack-poll',
			'type 8 subtype cf-ack-poll',
			'wlan type data subtype 0x70',
			'type data subtype 0x70',
			'wlan type 8 subtype 0x70',
			'type 8 subtype 0x70',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x78            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_cf_ack_poll
	wlan_subtype_qos_data => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype qos-data',
			'subtype qos-data',
			'wlan type data subtype qos-data',
			'type data subtype qos-data',
			'wlan type 8 subtype qos-data',
			'type 8 subtype qos-data',
			'wlan type data subtype 0x80',
			'type data subtype 0x80',
			'wlan type 8 subtype 0x80',
			'type 8 subtype 0x80',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x88            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_qos_data
	wlan_subtype_qos_data_cf_ack => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype qos-data-cf-ack',
			'subtype qos-data-cf-ack',
			'wlan type data subtype qos-data-cf-ack',
			'type data subtype qos-data-cf-ack',
			'wlan type 8 subtype qos-data-cf-ack',
			'type 8 subtype qos-data-cf-ack',
			'wlan type data subtype 0x90',
			'type data subtype 0x90',
			'wlan type 8 subtype 0x90',
			'type 8 subtype 0x90',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0x98            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_qos_data_cf_ack
	wlan_subtype_qos_data_cf_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype qos-data-cf-poll',
			'subtype qos-data-cf-poll',
			'wlan type data subtype qos-data-cf-poll',
			'type data subtype qos-data-cf-poll',
			'wlan type 8 subtype qos-data-cf-poll',
			'type 8 subtype qos-data-cf-poll',
			'wlan type data subtype 0xa0',
			'type data subtype 0xa0',
			'wlan type 8 subtype 0xa0',
			'type 8 subtype 0xa0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xa8            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_qos_data_cf_poll
	wlan_subtype_qos_data_cf_ack_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype qos-data-cf-ack-poll',
			'subtype qos-data-cf-ack-poll',
			'wlan type data subtype qos-data-cf-ack-poll',
			'type data subtype qos-data-cf-ack-poll',
			'wlan type 8 subtype qos-data-cf-ack-poll',
			'type 8 subtype qos-data-cf-ack-poll',
			'wlan type data subtype 0xb0',
			'type data subtype 0xb0',
			'wlan type 8 subtype 0xb0',
			'type 8 subtype 0xb0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xb8            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_qos_data_cf_ack_poll
	wlan_subtype_qos => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype qos',
			'subtype qos',
			'wlan type data subtype qos',
			'type data subtype qos',
			'wlan type 8 subtype qos',
			'type 8 subtype qos',
			'wlan type data subtype 0xc0',
			'type data subtype 0xc0',
			'wlan type 8 subtype 0xc0',
			'type 8 subtype 0xc0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xc8            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_qos
	wlan_subtype_qos_cf_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype qos-cf-poll',
			'subtype qos-cf-poll',
			'wlan type data subtype qos-cf-poll',
			'type data subtype qos-cf-poll',
			'wlan type 8 subtype qos-cf-poll',
			'type 8 subtype qos-cf-poll',
			'wlan type data subtype 0xe0',
			'type data subtype 0xe0',
			'wlan type 8 subtype 0xe0',
			'type 8 subtype 0xe0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xe8            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_qos_cf_poll
	wlan_subtype_qos_cf_ack_poll => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan subtype qos-cf-ack-poll',
			'subtype qos-cf-ack-poll',
			'wlan type data subtype qos-cf-ack-poll',
			'type data subtype qos-cf-ack-poll',
			'wlan type 8 subtype qos-cf-ack-poll',
			'type 8 subtype qos-cf-ack-poll',
			'wlan type data subtype 0xf0',
			'type data subtype 0xf0',
			'wlan type 8 subtype 0xf0',
			'type 8 subtype 0xf0',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xfc
			(002) jeq      #0xf8            jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_subtype_qos_cf_ack_poll
	wlan_type_reserved => {
		DLT => 'IEEE802_11',
		# Reserved frame type, no name.
		aliases => [
			'wlan type 12',
			'type 12',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xc
			(002) jeq      #0xc             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_type_reserved
	wlan_dir_nods => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan dir nods',
			'wlan dir 0',
			'dir nods',
			'dir 0',
			'wlan direction nods',
			'wlan direction 0',
			'direction nods',
			'direction 0',
		],
		opt => '
			(000) ldb      [1]
			(001) jset     #0x3             jt 2	jf 3
			(002) ret      #0
			(003) ret      #262144
			',
	}, # wlan_dir_nods
	wlan_dir_tods => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan dir tods',
			'wlan dir 1',
			'dir tods',
			'dir 1',
			'wlan direction tods',
			'wlan direction 1',
			'direction tods',
			'direction 1',
		],
		opt => '
			(000) ldb      [1]
			(001) and      #0x3
			(002) jeq      #0x1             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_dir_tods
	wlan_dir_fromds => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan dir fromds',
			'wlan dir 2',
			'dir fromds',
			'dir 2',
			'wlan direction fromds',
			'wlan direction 2',
			'direction fromds',
			'direction 2',
		],
		opt => '
			(000) ldb      [1]
			(001) and      #0x3
			(002) jeq      #0x2             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_dir_fromds
	wlan_dir_dstods => {
		DLT => 'IEEE802_11',
		aliases => [
			'wlan dir dstods',
			'wlan dir 3',
			'dir dstods',
			'dir 3',
			'wlan direction dstods',
			'wlan direction 3',
			'direction dstods',
			'direction 3',
		],
		opt => '
			(000) ldb      [1]
			(001) and      #0x3
			(002) jeq      #0x3             jt 3	jf 4
			(003) ret      #262144
			(004) ret      #0
			',
	}, # wlan_dir_dstods

	pppoed => {
		snaplen => 200,
		DLT => 'EN10MB',
		aliases => ['pppoed'],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x8863          jt 2	jf 3
			(002) ret      #200
			(003) ret      #0
			',
	}, # pppoed
	pppoes_nullary => {
		snaplen => 200,
		DLT => 'EN10MB',
		aliases => ['pppoes'],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x8864          jt 2	jf 3
			(002) ret      #200
			(003) ret      #0
			',
	}, # pppoes_nullary
	pppoes_unary => {
		snaplen => 200,
		DLT => 'EN10MB',
		aliases => ['pppoes 1234'],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x8864          jt 2	jf 5
			(002) ldh      [16]
			(003) jeq      #0x4d2           jt 4	jf 5
			(004) ret      #200
			(005) ret      #0
			',
	}, # pppoes_unary

	llc => {
		snaplen => 200,
		DLT => 'EN10MB',
		aliases => ['llc'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 4	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 4	jf 5
			(004) ret      #0
			(005) ret      #200
			',
	}, # llc_nullary
	llc_i => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc i'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 6	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 6	jf 4
			(004) ldb      [16]
			(005) jset     #0x1             jt 6	jf 7
			(006) ret      #0
			(007) ret      #100
			',
	}, # llc_i
	llc_s => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc s'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0x3
			(006) jeq      #0x1             jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_s
	llc_u => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc u'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0x3
			(006) jeq      #0x3             jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_u
	llc_rr => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc rr'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xf
			(006) jeq      #0x1             jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_rr
	llc_rnr => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc rnr'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xf
			(006) jeq      #0x5             jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_rnr
	llc_rej => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc rej'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xf
			(006) jeq      #0x9             jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_rej
	llc_ui => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc ui'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xef
			(006) jeq      #0x3             jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_ui
	llc_ua => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc ua'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xef
			(006) jeq      #0x63            jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_ua
	llc_disc => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc disc'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xef
			(006) jeq      #0x43            jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_disc
	llc_dm => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc dm'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xef
			(006) jeq      #0xf             jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_dm
	llc_sabme => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc sabme'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xef
			(006) jeq      #0x6f            jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_sabme
	llc_test => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc test'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xef
			(006) jeq      #0xe3            jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_test
	llc_xid => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc xid'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xef
			(006) jeq      #0xaf            jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_xid
	llc_frmr => {
		snaplen => 100,
		DLT => 'EN10MB',
		aliases => ['llc frmr'],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 8	jf 2
			(002) ldh      [14]
			(003) jeq      #0xffff          jt 8	jf 4
			(004) ldb      [16]
			(005) and      #0xef
			(006) jeq      #0x87            jt 7	jf 8
			(007) ret      #100
			(008) ret      #0
			',
	}, # llc_frmr

	decnet_host => {
		DLT => 'EN10MB',
		aliases => ['decnet host 50.764'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x6003          jt 2	jf 39
			(002) ldb      [16]
			(003) and      #0x7
			(004) jeq      #0x2             jt 5	jf 7
			(005) ldh      [19]
			(006) jeq      #0xfcca          jt 38	jf 7
			(007) ldh      [16]
			(008) and      #0xff07
			(009) jeq      #0x8102          jt 10	jf 12
			(010) ldh      [20]
			(011) jeq      #0xfcca          jt 38	jf 12
			(012) ldb      [16]
			(013) and      #0x7
			(014) jeq      #0x6             jt 15	jf 17
			(015) ldh      [31]
			(016) jeq      #0xfcca          jt 38	jf 17
			(017) ldh      [16]
			(018) and      #0xff07
			(019) jeq      #0x8106          jt 20	jf 22
			(020) ldh      [32]
			(021) jeq      #0xfcca          jt 38	jf 22
			(022) ld       [16]
			(023) and      #0x7ffff00
			(024) jeq      #0x2fcca00       jt 38	jf 25
			(025) ld       [16]
			(026) and      #0xff07ffff
			(027) jeq      #0x8102fcca      jt 38	jf 28
			(028) ldb      [16]
			(029) and      #0x7
			(030) jeq      #0x6             jt 31	jf 33
			(031) ldh      [23]
			(032) jeq      #0xfcca          jt 38	jf 33
			(033) ldh      [16]
			(034) and      #0xff07
			(035) jeq      #0x8106          jt 36	jf 39
			(036) ldh      [24]
			(037) jeq      #0xfcca          jt 38	jf 39
			(038) ret      #262144
			(039) ret      #0
			',
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x6003          jt 2	jf 39
			(002) ldb      [16]
			(003) and      #0x7
			(004) jeq      #0x2             jt 5	jf 7
			(005) ldh      [19]
			(006) jeq      #0xfcca          jt 38	jf 7
			(007) ldh      [16]
			(008) and      #0xff07
			(009) jeq      #0x8102          jt 10	jf 12
			(010) ldh      [20]
			(011) jeq      #0xfcca          jt 38	jf 12
			(012) ldb      [16]
			(013) and      #0x7
			(014) jeq      #0x6             jt 15	jf 17
			(015) ldh      [31]
			(016) jeq      #0xfcca          jt 38	jf 17
			(017) ldh      [16]
			(018) and      #0xff07
			(019) jeq      #0x8106          jt 20	jf 22
			(020) ldh      [32]
			(021) jeq      #0xfcca          jt 38	jf 22
			(022) ld       [16]
			(023) and      #0x7ffff00
			(024) jeq      #0x2fcca00       jt 38	jf 25
			(025) ld       [16]
			(026) and      #0xff07ffff
			(027) jeq      #0x8102fcca      jt 38	jf 28
			(028) ldb      [16]
			(029) and      #0x7
			(030) jeq      #0x6             jt 31	jf 33
			(031) ldh      [23]
			(032) jeq      #0xfcca          jt 38	jf 33
			(033) ldh      [16]
			(034) and      #0xff07
			(035) jeq      #0x8106          jt 36	jf 39
			(036) ldh      [24]
			(037) jeq      #0xfcca          jt 38	jf 39
			(038) ret      #262144
			(039) ret      #0
			',
	}, # decnet_host
	decnet_src_host => {
		DLT => 'EN10MB',
		aliases => [
			'decnet src host 50.764',
			'decnet src 50.764',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x6003          jt 2	jf 23
			(002) ldb      [16]
			(003) and      #0x7
			(004) jeq      #0x2             jt 5	jf 7
			(005) ldh      [19]
			(006) jeq      #0xfcca          jt 22	jf 7
			(007) ldh      [16]
			(008) and      #0xff07
			(009) jeq      #0x8102          jt 10	jf 12
			(010) ldh      [20]
			(011) jeq      #0xfcca          jt 22	jf 12
			(012) ldb      [16]
			(013) and      #0x7
			(014) jeq      #0x6             jt 15	jf 17
			(015) ldh      [31]
			(016) jeq      #0xfcca          jt 22	jf 17
			(017) ldh      [16]
			(018) and      #0xff07
			(019) jeq      #0x8106          jt 20	jf 23
			(020) ldh      [32]
			(021) jeq      #0xfcca          jt 22	jf 23
			(022) ret      #262144
			(023) ret      #0
			',
	}, # decnet_src_host
	decnet_dst_host => {
		DLT => 'EN10MB',
		aliases => [
			'decnet dst host 50.764',
			'decnet dst 50.764',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x6003          jt 2	jf 19
			(002) ld       [16]
			(003) and      #0x7ffff00
			(004) jeq      #0x2fcca00       jt 18	jf 5
			(005) ld       [16]
			(006) and      #0xff07ffff
			(007) jeq      #0x8102fcca      jt 18	jf 8
			(008) ldb      [16]
			(009) and      #0x7
			(010) jeq      #0x6             jt 11	jf 13
			(011) ldh      [23]
			(012) jeq      #0xfcca          jt 18	jf 13
			(013) ldh      [16]
			(014) and      #0xff07
			(015) jeq      #0x8106          jt 16	jf 19
			(016) ldh      [24]
			(017) jeq      #0xfcca          jt 18	jf 19
			(018) ret      #262144
			(019) ret      #0
			',
	}, # decnet_dst_host

	iso_proto_clnp => {
		DLT => 'EN10MB',
		aliases => [
			'iso proto \clnp',
			'clnp',
			'iso proto 0x81',
		],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 7	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 7
			(004) ldb      [17]
			(005) jeq      #0x81            jt 6	jf 7
			(006) ret      #262144
			(007) ret      #0
			',
	}, # iso_proto_clnp
	iso_proto_esis => {
		DLT => 'EN10MB',
		aliases => [
			'iso proto \esis',
			'esis',
			'es-is',
			'iso proto 0x82',
		],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 7	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 7
			(004) ldb      [17]
			(005) jeq      #0x82            jt 6	jf 7
			(006) ret      #262144
			(007) ret      #0
			',
	}, # iso_proto_esis
	iso_proto_isis => {
		DLT => 'EN10MB',
		aliases => [
			'iso proto \isis',
			'isis',
			'is-is',
			'iso proto 0x83',
		],
		unopt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 7	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 7
			(004) ldb      [17]
			(005) jeq      #0x83            jt 6	jf 7
			(006) ret      #262144
			(007) ret      #0
			',
	}, # iso_proto_isis
	isis_l1 => {
		DLT => 'EN10MB',
		aliases => ['l1'],
		opt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 13	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 13
			(004) ldb      [17]
			(005) jeq      #0x83            jt 6	jf 13
			(006) ldb      [21]
			(007) jeq      #0x1a            jt 12	jf 8
			(008) jeq      #0x18            jt 12	jf 9
			(009) jeq      #0x12            jt 12	jf 10
			(010) jeq      #0xf             jt 12	jf 11
			(011) jeq      #0x11            jt 12	jf 13
			(012) ret      #262144
			(013) ret      #0
			',
	}, # isis_l1
	isis_l2 => {
		DLT => 'EN10MB',
		aliases => ['l2'],
		opt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 13	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 13
			(004) ldb      [17]
			(005) jeq      #0x83            jt 6	jf 13
			(006) ldb      [21]
			(007) jeq      #0x1b            jt 12	jf 8
			(008) jeq      #0x19            jt 12	jf 9
			(009) jeq      #0x14            jt 12	jf 10
			(010) jeq      #0x10            jt 12	jf 11
			(011) jeq      #0x11            jt 12	jf 13
			(012) ret      #262144
			(013) ret      #0
			',
	}, # isis_l2
	isis_iih => {
		DLT => 'EN10MB',
		aliases => ['iih'],
		opt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 11	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 11
			(004) ldb      [17]
			(005) jeq      #0x83            jt 6	jf 11
			(006) ldb      [21]
			(007) jeq      #0x11            jt 10	jf 8
			(008) jeq      #0xf             jt 10	jf 9
			(009) jeq      #0x10            jt 10	jf 11
			(010) ret      #262144
			(011) ret      #0
			',
	}, # isis_iih
	isis_lsp => {
		DLT => 'EN10MB',
		aliases => ['lsp'],
		opt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 10	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 10
			(004) ldb      [17]
			(005) jeq      #0x83            jt 6	jf 10
			(006) ldb      [21]
			(007) jeq      #0x12            jt 9	jf 8
			(008) jeq      #0x14            jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # isis_lsp
	isis_snp => {
		DLT => 'EN10MB',
		aliases => ['snp'],
		opt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 12	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 12
			(004) ldb      [17]
			(005) jeq      #0x83            jt 6	jf 12
			(006) ldb      [21]
			(007) jeq      #0x1b            jt 11	jf 8
			(008) jeq      #0x1a            jt 11	jf 9
			(009) jeq      #0x18            jt 11	jf 10
			(010) jeq      #0x19            jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # isis_snp
	isis_csnp => {
		DLT => 'EN10MB',
		aliases => ['csnp'],
		opt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 10	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 10
			(004) ldb      [17]
			(005) jeq      #0x83            jt 6	jf 10
			(006) ldb      [21]
			(007) jeq      #0x18            jt 9	jf 8
			(008) jeq      #0x19            jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # isis_csnp
	isis_psnp => {
		DLT => 'EN10MB',
		aliases => ['psnp'],
		opt => '
			(000) ldh      [12]
			(001) jgt      #0x5dc           jt 10	jf 2
			(002) ldh      [14]
			(003) jeq      #0xfefe          jt 4	jf 10
			(004) ldb      [17]
			(005) jeq      #0x83            jt 6	jf 10
			(006) ldb      [21]
			(007) jeq      #0x1a            jt 9	jf 8
			(008) jeq      #0x1b            jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # isis_psnp

	ip_multicast => {
		snaplen => 1000,
		DLT => 'IPV4',
		aliases => ['ip multicast'],
		opt => '
			(000) ld       #0x0
			(001) ldb      [16]
			(002) jge      #0xe0            jt 3	jf 4
			(003) ret      #1000
			(004) ret      #0
			',
	}, # ip_multicast
	ip_broadcast_30 => {
		DLT => 'IPV4',
		netmask => '255.255.255.252',
		aliases => ['ip broadcast'],
		unopt => '
			(000) ld       #0x0
			(001) jeq      #0x0             jt 2	jf 9
			(002) ld       [16]
			(003) and      #0x3
			(004) jeq      #0x0             jt 8	jf 5
			(005) ld       [16]
			(006) and      #0x3
			(007) jeq      #0x3             jt 8	jf 9
			(008) ret      #262144
			(009) ret      #0
			',
	}, # ip_broadcast_30
	ip_broadcast_24 => {
		DLT => 'IPV4',
		netmask => '255.255.255.0',
		aliases => ['ip broadcast'],
		opt => '
			(000) ld       #0x0
			(001) ld       [16]
			(002) jset     #0xff            jt 3	jf 6
			(003) and      #0xff
			(004) jeq      #0xff            jt 6	jf 5
			(005) ret      #0
			(006) ret      #262144
			',
	}, # ip_broadcast_24

	ip_proto => {
		DLT => 'EN10MB',
		# In this expression the protocol name is subject to external resolution
		# (typically via /etc/protocols), so pick something that is most likely
		# to resolve on all supported OSes.
		aliases => [
			'ip proto \tcp',
			'ip proto 6',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 5
			(002) ldb      [23]
			(003) jeq      #0x6             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ip6_proto
	ip6_proto => {
		DLT => 'EN10MB',
		aliases => [
			'ip6 proto \tcp', # Same as above.
			'ip6 proto 6',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x6             jt 7	jf 4
			(004) jeq      #0x2c            jt 5	jf 8
			(005) ldb      [54]
			(006) jeq      #0x6             jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # ip6_proto
	proto => {
		DLT => 'EN10MB',
		aliases => [
			'proto \tcp', # Same as above.
			'proto 6',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 4
			(002) ldb      [23]
			(003) jeq      #0x6             jt 10	jf 11
			(004) jeq      #0x86dd          jt 5	jf 11
			(005) ldb      [20]
			(006) jeq      #0x6             jt 10	jf 7
			(007) jeq      #0x2c            jt 8	jf 11
			(008) ldb      [54]
			(009) jeq      #0x6             jt 10	jf 11
			(010) ret      #262144
			(011) ret      #0
			',
	}, # proto
	ip_protochain => {
		skip => skip_config_def1 ('NO_PROTOCHAIN'),
		DLT => 'RAW',
		aliases => [
			'ip protochain \udp',
			'ip protochain 17',
		],
		unopt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 24
			(003) ldb      [9]
			(004) ldxb     4*([0]&0xf)
			(005) jeq      #0x11            jt 21	jf 6
			(006) jeq      #0x3b            jt 21	jf 7
			(007) add      #0
			(008) jeq      #0x33            jt 9	jf 21
			(009) txa
			(010) ldb      [x + 0]
			(011) st       M[0]
			(012) txa
			(013) add      #1
			(014) tax
			(015) ldb      [x + 0]
			(016) add      #2
			(017) mul      #4
			(018) tax
			(019) ld       M[0]
			(020) ja       5
			(021) add      #0
			(022) jeq      #0x11            jt 23	jf 24
			(023) ret      #262144
			(024) ret      #0
			',
	}, # ip_protochain
	ip6_protochain => {
		skip => skip_config_def1 ('NO_PROTOCHAIN'),
		DLT => 'RAW',
		aliases => [
			'ip6 protochain \udp',
			'ip6 protochain 17',
		],
		unopt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 36
			(003) ldb      [6]
			(004) ldx      #0x28
			(005) jeq      #0x11            jt 33	jf 6
			(006) jeq      #0x3b            jt 33	jf 7
			(007) jeq      #0x0             jt 11	jf 8
			(008) jeq      #0x3c            jt 11	jf 9
			(009) jeq      #0x2b            jt 11	jf 10
			(010) jeq      #0x2c            jt 11	jf 20
			(011) ldb      [x + 0]
			(012) st       M[0]
			(013) ldb      [x + 1]
			(014) add      #1
			(015) mul      #8
			(016) add      x
			(017) tax
			(018) ld       M[0]
			(019) ja       5
			(020) jeq      #0x33            jt 21	jf 33
			(021) txa
			(022) ldb      [x + 0]
			(023) st       M[0]
			(024) txa
			(025) add      #1
			(026) tax
			(027) ldb      [x + 0]
			(028) add      #2
			(029) mul      #4
			(030) tax
			(031) ld       M[0]
			(032) ja       5
			(033) add      #0
			(034) jeq      #0x11            jt 35	jf 36
			(035) ret      #262144
			(036) ret      #0
			',
	}, # ip6_protochain
	protochain => {
		skip => skip_config_def1 ('NO_PROTOCHAIN'),
		DLT => 'RAW',
		aliases => [
			'protochain \udp',
			'protochain 17',
		],
		unopt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 23
			(003) ldb      [9]
			(004) ldxb     4*([0]&0xf)
			(005) jeq      #0x11            jt 21	jf 6
			(006) jeq      #0x3b            jt 21	jf 7
			(007) add      #0
			(008) jeq      #0x33            jt 9	jf 21
			(009) txa
			(010) ldb      [x + 0]
			(011) st       M[1]
			(012) txa
			(013) add      #1
			(014) tax
			(015) ldb      [x + 0]
			(016) add      #2
			(017) mul      #4
			(018) tax
			(019) ld       M[1]
			(020) ja       5
			(021) add      #0
			(022) jeq      #0x11            jt 58	jf 23
			(023) ldb      [0]
			(024) and      #0xf0
			(025) jeq      #0x60            jt 26	jf 59
			(026) ldb      [6]
			(027) ldx      #0x28
			(028) jeq      #0x11            jt 56	jf 29
			(029) jeq      #0x3b            jt 56	jf 30
			(030) jeq      #0x0             jt 34	jf 31
			(031) jeq      #0x3c            jt 34	jf 32
			(032) jeq      #0x2b            jt 34	jf 33
			(033) jeq      #0x2c            jt 34	jf 43
			(034) ldb      [x + 0]
			(035) st       M[1]
			(036) ldb      [x + 1]
			(037) add      #1
			(038) mul      #8
			(039) add      x
			(040) tax
			(041) ld       M[1]
			(042) ja       28
			(043) jeq      #0x33            jt 44	jf 56
			(044) txa
			(045) ldb      [x + 0]
			(046) st       M[1]
			(047) txa
			(048) add      #1
			(049) tax
			(050) ldb      [x + 0]
			(051) add      #2
			(052) mul      #4
			(053) tax
			(054) ld       M[1]
			(055) ja       28
			(056) add      #0
			(057) jeq      #0x11            jt 58	jf 59
			(058) ret      #262144
			(059) ret      #0
			',
	}, # protochain
	ip_host_addr => {
		# For this and some other single-stack qualifiers below use DLT_RAW to
		# verify that the bytecode does not try to match the other protocol too.
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip host 192.168.170.211',
			'ip src or dst 192.168.170.211',
			'ip src or dst host 192.168.170.211',
			'host 192.168.170.211',
			'src or dst 192.168.170.211',
			'src or dst host 192.168.170.211',
			'ip host 0xc0a8aad3',
			'ip src or dst 0xc0a8aad3',
			'ip src or dst host 0xc0a8aad3',
			'host 0xc0a8aad3',
			'src or dst 0xc0a8aad3',
			'src or dst host 0xc0a8aad3',
			'ip host 3232279251',
			'ip src or dst 3232279251',
			'ip src or dst host 3232279251',
			'host 3232279251',
			'src or dst 3232279251',
			'src or dst host 3232279251',
			# No aliases for 030052125323, which matches a MAC address.
			# "net" without an explicit netmask defaults to /32.
			'ip net 192.168.170.211/32',
			'ip src or dst net 192.168.170.211/ 32',
			'net 192.168.170.211 /32',
			'src or dst net 192.168.170.211 / 32',
			'ip net 192.168.170.211',
			'ip src or dst net 192.168.170.211',
			'net 192.168.170.211',
			'src or dst net 192.168.170.211',
			'ip net 0xc0a8aad3',
			'ip src or dst net 0xc0a8aad3',
			'net 0xc0a8aad3',
			'src or dst net 0xc0a8aad3',
			'ip net 3232279251',
			'ip src or dst net 3232279251',
			'net 3232279251',
			'src or dst net 3232279251',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 8
			(003) ld       [12]
			(004) jeq      #0xc0a8aad3      jt 7	jf 5
			(005) ld       [16]
			(006) jeq      #0xc0a8aad3      jt 7	jf 8
			(007) ret      #2000
			(008) ret      #0
			',
	}, # ip_host_addr
	# The DLT supports both IPv4 and IPv6, the expressions use:
	# * IPv4-only syntax and an IPv4-only hostname
	# * IPv4-only syntax and an IPv4+IPv6 hostname
	# * IPv4+IPv6 syntax and an IPv4-only hostname
	# In each case the filter program should be the same and IPv4-only.  Other
	# similar tests use a similar approach.
	ip_host_name => {
		skip => skip_no_hosts(),
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip host noeth-ipv4-noipv6.host123.libpcap.test',
			'ip host noeth-ipv4-ipv6.host123.libpcap.test',
			'ip src or dst noeth-ipv4-noipv6.host123.libpcap.test',
			'ip src or dst noeth-ipv4-ipv6.host123.libpcap.test',
			'ip src or dst host noeth-ipv4-noipv6.host123.libpcap.test',
			'ip src or dst host noeth-ipv4-ipv6.host123.libpcap.test',
			'host noeth-ipv4-noipv6.host123.libpcap.test',
			'src or dst noeth-ipv4-noipv6.host123.libpcap.test',
			'src or dst host noeth-ipv4-noipv6.host123.libpcap.test',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 8
			(003) ld       [12]
			(004) jeq      #0xa141e28       jt 7	jf 5
			(005) ld       [16]
			(006) jeq      #0xa141e28       jt 7	jf 8
			(007) ret      #2000
			(008) ret      #0
			',
	}, # ip_host_name
	ip_host_NAME => {
		skip => skip_no_hosts_casecmp(),
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip host NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip host NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip src or dst NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip src or dst NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip src or dst host NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip src or dst host NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'host NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'src or dst NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'src or dst host NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 8
			(003) ld       [12]
			(004) jeq      #0xa141e28       jt 7	jf 5
			(005) ld       [16]
			(006) jeq      #0xa141e28       jt 7	jf 8
			(007) ret      #2000
			(008) ret      #0
			',
	}, # ip_host_NAME
	ip_src_host_addr => {
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip src host 10.0.0.2',
			'ip src 10.0.0.2',
			'src host 10.0.0.2',
			'src 10.0.0.2',
			'ip src host 0x0a000002',
			'ip src 0x0A000002',
			'src host 0X0a000002',
			'src 0X0A000002',
			'ip src host 0xa000002',
			'ip src 0xA000002',
			'src host 0Xa000002',
			'src 0XA000002',
			'ip src host 167772162',
			'ip src 167772162',
			'src host 167772162',
			'src 167772162',
			'ip src host 01200000002',
			'ip src 01200000002',
			'src host 01200000002',
			'src 01200000002',
			# "net" /32
			'ip src net 10.0.0.2/  32',
			'src net 10.0.0.2  /32',
			'ip src net 10.0.0.2',
			'src net 10.0.0.2',
			'ip src net 0x0a000002',
			'src net 0X0a000002',
			'ip src net 0xa000002',
			'src net 0Xa000002',
			'ip src net 167772162',
			'src net 167772162',
			'ip src net 01200000002',
			'src net 01200000002',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [12]
			(004) jeq      #0xa000002       jt 5	jf 6
			(005) ret      #2000
			(006) ret      #0
			',
	}, # ip_src_host_addr
	ip_src_host_name => {
		skip => skip_no_hosts(),
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip src host noeth-ipv4-noipv6.host123.libpcap.test',
			'ip src host noeth-ipv4-ipv6.host123.libpcap.test',
			'ip src noeth-ipv4-noipv6.host123.libpcap.test',
			'ip src noeth-ipv4-ipv6.host123.libpcap.test',
			'src host noeth-ipv4-noipv6.host123.libpcap.test',
			'src noeth-ipv4-noipv6.host123.libpcap.test',
		],
		unopt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [12]
			(004) jeq      #0xa141e28       jt 5	jf 6
			(005) ret      #2000
			(006) ret      #0
			',
	}, # ip_src_host_name
	ip_src_host_NAME => {
		skip => skip_no_hosts_casecmp(),
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip src host NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip src host NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip src NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip src NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'src host NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'src NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
		],
		unopt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [12]
			(004) jeq      #0xa141e28       jt 5	jf 6
			(005) ret      #2000
			(006) ret      #0
			',
	}, # ip_src_host_NAME
	ip_dst_host_addr => {
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip dst host 172.17.89.30',
			'ip dst 172.17.89.30',
			'dst host 172.17.89.30',
			'dst 172.17.89.30',
			'ip dst host 0xac11591e',
			'ip dst 0xAC11591E',
			'dst host 0Xac11591e',
			'dst 0XAC11591E',
			'ip dst host 2886818078',
			'ip dst 2886818078',
			'dst host 2886818078',
			'dst 2886818078',
			# No aliases for 025404254436, which matches a MAC address.
			# "net" /32
			'ip dst net 172.17.89.30 /  32',
			'dst net 172.17.89.30  / 32',
			'ip dst net 172.17.89.30',
			'dst net 172.17.89.30',
			'ip dst net 0xac11591e',
			'dst net 0Xac11591e',
			'ip dst net 2886818078',
			'dst net 2886818078',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [16]
			(004) jeq      #0xac11591e      jt 5	jf 6
			(005) ret      #2000
			(006) ret      #0
			',
	}, # ip_dst_host_addr
	ip_dst_host_name => {
		skip => skip_no_hosts(),
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip dst host noeth-ipv4-noipv6.host123.libpcap.test',
			'ip dst host noeth-ipv4-ipv6.host123.libpcap.test',
			'ip dst noeth-ipv4-noipv6.host123.libpcap.test',
			'ip dst noeth-ipv4-ipv6.host123.libpcap.test',
			'dst host noeth-ipv4-noipv6.host123.libpcap.test',
			'dst noeth-ipv4-noipv6.host123.libpcap.test',
		],
		unopt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [16]
			(004) jeq      #0xa141e28       jt 5	jf 6
			(005) ret      #2000
			(006) ret      #0
			',
	}, # ip_dst_host_name
	ip_dst_host_NAME => {
		skip => skip_no_hosts_casecmp(),
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip dst host NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip dst host NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip dst NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip dst NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'dst host NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'dst NOETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
		],
		unopt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [16]
			(004) jeq      #0xa141e28       jt 5	jf 6
			(005) ret      #2000
			(006) ret      #0
			',
	}, # ip_dst_host_NAME
	ip_net_addr => {
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip net 192.168.0.0/16',
			'ip src or dst net 192.168.0.0/16',
			'net 192.168.0.0/16',
			'src or dst net 192.168.0.0/16',
			'ip net 192.168/16',
			'ip src or dst net 192.168/16',
			'net 192.168/16',
			'src or dst net 192.168/16',
			'ip net 192.168.0.0 mask 255.255.0.0',
			'ip src or dst net 192.168.0.0 mask 255.255.0.0',
			'net 192.168.0.0 mask 255.255.0.0',
			'src or dst net 192.168.0.0 mask 255.255.0.0',
			'ip net 192.168.0.0 mask 255.255',
			'ip src or dst net 192.168.0.0 mask 255.255',
			'net 192.168.0.0 mask 255.255',
			'src or dst net 192.168.0.0 mask 255.255',
			'ip net 192.168 mask 255.255.0.0',
			'ip src or dst net 192.168 mask 255.255.0.0',
			'net 192.168 mask 255.255.0.0',
			'src or dst net 192.168 mask 255.255.0.0',
			'ip net 192.168 mask 255.255',
			'ip src or dst net 192.168 mask 255.255',
			'net 192.168 mask 255.255',
			'src or dst net 192.168 mask 255.255',
			'ip net 192.168',
			'ip src or dst net 192.168',
			'net 192.168',
			'src or dst net 192.168',
		],
		# Only the optimized bytecode is equivalent!
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 10
			(003) ld       [12]
			(004) and      #0xffff0000
			(005) jeq      #0xc0a80000      jt 9	jf 6
			(006) ld       [16]
			(007) and      #0xffff0000
			(008) jeq      #0xc0a80000      jt 9	jf 10
			(009) ret      #2000
			(010) ret      #0
			',
	}, # ip_net_addr
	ip_net_name => {
		skip => skip_no_networks(),
		DLT => 'RAW',
		aliases => [
			'ip net net-10-0-0-0.libpcap.test',
			'ip src or dst net net-10-0-0-0.libpcap.test',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 8
			(003) ld       [12]
			(004) jeq      #0xa000000       jt 7	jf 5
			(005) ld       [16]
			(006) jeq      #0xa000000       jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # ip_net_name
	ip_net_NAME => {
		skip => skip_no_networks_casecmp(),
		DLT => 'RAW',
		aliases => [
			'ip net NET-10-0-0-0.LIBPCAP.TEST',
			'ip src or dst net NET-10-0-0-0.LIBPCAP.TEST',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 8
			(003) ld       [12]
			(004) jeq      #0xa000000       jt 7	jf 5
			(005) ld       [16]
			(006) jeq      #0xa000000       jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # ip_net_NAME
	ip_src_net_addr => {
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip src net 10.0.1.0/24',
			'src net 10.0.1.0/24',
			'ip src net 10.0.1/24',
			'src net 10.0.1/24',
			'ip src net 10.0.1.0 mask 255.255.255.0',
			'src net 10.0.1.0 mask 255.255.255.0',
			'ip src net 10.0.1.0 mask 255.255.255',
			'src net 10.0.1.0 mask 255.255.255',
			'ip src net 10.0.1 mask 255.255.255.0',
			'src net 10.0.1 mask 255.255.255.0',
			'ip src net 10.0.1 mask 255.255.255',
			'src net 10.0.1 mask 255.255.255',
			'ip src net 10.0.1',
			'src net 10.0.1',
		],
		# Only the optimized bytecode is equivalent!
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 7
			(003) ld       [12]
			(004) and      #0xffffff00
			(005) jeq      #0xa000100       jt 6	jf 7
			(006) ret      #2000
			(007) ret      #0
			',
	}, # ip_src_net_addr
	ip_src_net_name => {
		skip => skip_no_networks(),
		DLT => 'RAW',
		aliases => [
			'ip src net net-10-20-0-0.libpcap.test',
			'src net net-10-20-0-0.libpcap.test',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [12]
			(004) jeq      #0xa140000       jt 5	jf 6
			(005) ret      #262144
			(006) ret      #0
			',
	}, # ip_src_net_name
	ip_src_net_NAME => {
		skip => skip_no_networks_casecmp(),
		DLT => 'RAW',
		aliases => [
			'ip src net NET-10-20-0-0.LIBPCAP.TEST',
			'src net NET-10-20-0-0.LIBPCAP.TEST',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [12]
			(004) jeq      #0xa140000       jt 5	jf 6
			(005) ret      #262144
			(006) ret      #0
			',
	}, # ip_src_net_NAME
	ip_dst_net_addr => {
		DLT => 'RAW',
		snaplen => 2000,
		aliases => [
			'ip dst net 10.0.0.0/8',
			'dst net 10.0.0.0/8',
			'ip dst net 10.0.0.0 mask 255.0.0.0',
			'dst net 10.0.0.0 mask 255.0.0.0',
			# "net 10/<any masklength>", "net 10 mask <any mask>" and
			# "net <any net> mask 255" are invalid syntax.
			'ip dst net 10',
			'dst net 10',
		],
		# Only the optimized bytecode is equivalent!
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 7
			(003) ld       [16]
			(004) and      #0xff000000
			(005) jeq      #0xa000000       jt 6	jf 7
			(006) ret      #2000
			(007) ret      #0
			',
	}, # ip_dst_net_addr
	ip_dst_net_name => {
		skip => skip_no_networks(),
		DLT => 'RAW',
		aliases => [
			'ip dst net net-10-20-30-0.libpcap.test',
			'dst net net-10-20-30-0.libpcap.test',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [16]
			(004) jeq      #0xa141e00       jt 5	jf 6
			(005) ret      #262144
			(006) ret      #0
			',
	}, # ip_dst_net_name
	ip_dst_net_NAME => {
		skip => skip_no_networks_casecmp(),
		DLT => 'RAW',
		aliases => [
			'ip dst net NET-10-20-30-0.LIBPCAP.TEST',
			'dst net NET-10-20-30-0.LIBPCAP.TEST',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 6
			(003) ld       [16]
			(004) jeq      #0xa141e00       jt 5	jf 6
			(005) ret      #262144
			(006) ret      #0
			',
	}, # ip_dst_net_NAME
	# TODO: Verify identity with DLT_NETANALYZER and
	# DLT_NETANALYZER_TRANSPARENT in all DLT_EN10MB gateway tests.
	gateway_name_en10mb => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		aliases => [
			'gateway eth-ipv4-noipv6.host123.libpcap.test',
			# In the current implementation of this keyword the presence of an IPv6
			# address in the Internet address space should make no difference in
			# the resulting filter program.
			'gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 21
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 21
			(008) ldh      [12]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [26]
			(011) jeq      #0xa141e28       jt 21	jf 12
			(012) ld       [30]
			(013) jeq      #0xa141e28       jt 21	jf 20
			(014) jeq      #0x806           jt 16	jf 15
			(015) jeq      #0x8035          jt 16	jf 20
			(016) ld       [28]
			(017) jeq      #0xa141e28       jt 21	jf 18
			(018) ld       [38]
			(019) jeq      #0xa141e28       jt 21	jf 20
			(020) ret      #262144
			(021) ret      #0
			',
	}, # gateway_name_en10mb
	gateway_NAME_en10mb => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'EN10MB',
		aliases => [
			'gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 21
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 21
			(008) ldh      [12]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [26]
			(011) jeq      #0xa141e28       jt 21	jf 12
			(012) ld       [30]
			(013) jeq      #0xa141e28       jt 21	jf 20
			(014) jeq      #0x806           jt 16	jf 15
			(015) jeq      #0x8035          jt 16	jf 20
			(016) ld       [28]
			(017) jeq      #0xa141e28       jt 21	jf 18
			(018) ld       [38]
			(019) jeq      #0xa141e28       jt 21	jf 20
			(020) ret      #262144
			(021) ret      #0
			',
	}, # gateway_NAME_en10mb
	ip_gateway_name_en10mb => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		aliases => [
			'ip gateway eth-ipv4-noipv6.host123.libpcap.test',
			'ip gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [12]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [26]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [30]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # ip_gateway_name_en10mb
	ip_gateway_NAME_en10mb => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'EN10MB',
		aliases => [
			'ip gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [12]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [26]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [30]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # ip_gateway_NAME_en10mb
	arp_gateway_name_en10mb => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		aliases => [
			'arp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'arp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [12]
			(009) jeq      #0x806           jt 10	jf 14
			(010) ld       [28]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [38]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # arp_gateway_name_en10mb
	arp_gateway_NAME_en10mb => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'EN10MB',
		aliases => [
			'arp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'arp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [12]
			(009) jeq      #0x806           jt 10	jf 14
			(010) ld       [28]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [38]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # arp_gateway_NAME_en10mb
	rarp_gateway_name_en10mb => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		aliases => [
			'rarp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'rarp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [12]
			(009) jeq      #0x8035          jt 10	jf 14
			(010) ld       [28]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [38]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # rarp_gateway_name_en10mb
	rarp_gateway_NAME_en10mb => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'EN10MB',
		aliases => [
			'rarp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'rarp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [8]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [6]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [2]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [0]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [12]
			(009) jeq      #0x8035          jt 10	jf 14
			(010) ld       [28]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [38]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # rarp_gateway_NAME_en10mb
	gateway_name_fddi => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'FDDI',
		aliases => [
			'gateway eth-ipv4-noipv6.host123.libpcap.test',
			'gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [9]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [7]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [3]
			(005) jeq      #0x400140e       jt 6	jf 21
			(006) ldh      [1]
			(007) jeq      #0xaa00          jt 8	jf 21
			(008) ldh      [19]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [33]
			(011) jeq      #0xa141e28       jt 21	jf 12
			(012) ld       [37]
			(013) jeq      #0xa141e28       jt 21	jf 20
			(014) jeq      #0x806           jt 16	jf 15
			(015) jeq      #0x8035          jt 16	jf 20
			(016) ld       [35]
			(017) jeq      #0xa141e28       jt 21	jf 18
			(018) ld       [45]
			(019) jeq      #0xa141e28       jt 21	jf 20
			(020) ret      #262144
			(021) ret      #0
			',
	}, # gateway_name_fddi
	gateway_NAME_fddi => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'FDDI',
		aliases => [
			'gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [9]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [7]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [3]
			(005) jeq      #0x400140e       jt 6	jf 21
			(006) ldh      [1]
			(007) jeq      #0xaa00          jt 8	jf 21
			(008) ldh      [19]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [33]
			(011) jeq      #0xa141e28       jt 21	jf 12
			(012) ld       [37]
			(013) jeq      #0xa141e28       jt 21	jf 20
			(014) jeq      #0x806           jt 16	jf 15
			(015) jeq      #0x8035          jt 16	jf 20
			(016) ld       [35]
			(017) jeq      #0xa141e28       jt 21	jf 18
			(018) ld       [45]
			(019) jeq      #0xa141e28       jt 21	jf 20
			(020) ret      #262144
			(021) ret      #0
			',
	}, # gateway_NAME_fddi
	ip_gateway_name_fddi => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'FDDI',
		aliases => [
			'ip gateway eth-ipv4-noipv6.host123.libpcap.test',
			'ip gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [9]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [7]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [3]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [1]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [19]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [33]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [37]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # ip_gateway_name_fddi
	ip_gateway_NAME_fddi => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'FDDI',
		aliases => [
			'ip gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [9]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [7]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [3]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [1]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [19]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [33]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [37]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # ip_gateway_NAME_fddi
	arp_gateway_name_fddi => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'FDDI',
		aliases => [
			'arp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'arp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [9]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [7]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [3]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [1]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [19]
			(009) jeq      #0x806           jt 10	jf 14
			(010) ld       [35]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [45]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # arp_gateway_name_fddi
	arp_gateway_NAME_fddi => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'FDDI',
		aliases => [
			'arp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'arp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [9]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [7]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [3]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [1]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [19]
			(009) jeq      #0x806           jt 10	jf 14
			(010) ld       [35]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [45]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # arp_gateway_NAME_fddi
	rarp_gateway_name_fddi => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'FDDI',
		aliases => [
			'rarp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'rarp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [9]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [7]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [3]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [1]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [19]
			(009) jeq      #0x8035          jt 10	jf 14
			(010) ld       [35]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [45]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # rarp_gateway_name_fddi
	rarp_gateway_NAME_fddi => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'FDDI',
		aliases => [
			'rarp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'rarp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [9]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [7]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [3]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [1]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [19]
			(009) jeq      #0x8035          jt 10	jf 14
			(010) ld       [35]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [45]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # rarp_gateway_NAME_fddi
	gateway_name_ieee802 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IEEE802',
		aliases => [
			'gateway eth-ipv4-noipv6.host123.libpcap.test',
			'gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [8]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 21
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 21
			(008) ldh      [20]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [34]
			(011) jeq      #0xa141e28       jt 21	jf 12
			(012) ld       [38]
			(013) jeq      #0xa141e28       jt 21	jf 20
			(014) jeq      #0x806           jt 16	jf 15
			(015) jeq      #0x8035          jt 16	jf 20
			(016) ld       [36]
			(017) jeq      #0xa141e28       jt 21	jf 18
			(018) ld       [46]
			(019) jeq      #0xa141e28       jt 21	jf 20
			(020) ret      #262144
			(021) ret      #0
			',
	}, # gateway_name_ieee802
	gateway_NAME_ieee802 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IEEE802',
		aliases => [
			'gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [8]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 21
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 21
			(008) ldh      [20]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [34]
			(011) jeq      #0xa141e28       jt 21	jf 12
			(012) ld       [38]
			(013) jeq      #0xa141e28       jt 21	jf 20
			(014) jeq      #0x806           jt 16	jf 15
			(015) jeq      #0x8035          jt 16	jf 20
			(016) ld       [36]
			(017) jeq      #0xa141e28       jt 21	jf 18
			(018) ld       [46]
			(019) jeq      #0xa141e28       jt 21	jf 20
			(020) ret      #262144
			(021) ret      #0
			',
	}, # gateway_NAME_ieee802
	ip_gateway_name_ieee802 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IEEE802',
		aliases => [
			'ip gateway eth-ipv4-noipv6.host123.libpcap.test',
			'ip gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [8]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [20]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [34]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [38]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # ip_gateway_name_ieee802
	ip_gateway_NAME_ieee802 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IEEE802',
		aliases => [
			'ip gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [8]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [20]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [34]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [38]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # ip_gateway_NAME_ieee802
	arp_gateway_name_ieee802 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IEEE802',
		aliases => [
			'arp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'arp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [8]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [20]
			(009) jeq      #0x806           jt 10	jf 14
			(010) ld       [36]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [46]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # arp_gateway_name_ieee802
	arp_gateway_NAME_ieee802 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IEEE802',
		aliases => [
			'arp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'arp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [8]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [20]
			(009) jeq      #0x806           jt 10	jf 14
			(010) ld       [36]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [46]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # arp_gateway_NAME_ieee802
	rarp_gateway_name_ieee802 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IEEE802',
		aliases => [
			'rarp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'rarp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [8]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [20]
			(009) jeq      #0x8035          jt 10	jf 14
			(010) ld       [36]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [46]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # rarp_gateway_name_ieee802
	rarp_gateway_NAME_ieee802 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IEEE802',
		aliases => [
			'rarp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'rarp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [10]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [8]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [20]
			(009) jeq      #0x8035          jt 10	jf 14
			(010) ld       [36]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [46]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # rarp_gateway_NAME_ieee802
	# TODO: Verify identity with DLT_PRISM_HEADER, DLT_IEEE802_11_RADIO_AVS,
	# DLT_IEEE802_11_RADIO and DLT_PPI in all DLT_IEEE802_11 gateway tests.
	gateway_name_ieee802_11 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IEEE802_11',
		aliases => [
			'gateway eth-ipv4-noipv6.host123.libpcap.test',
			'gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ldx      #0x0
			(001) txa
			(002) add      #24
			(003) st       M[0]
			(004) ldb      [x + 0]
			(005) jset     #0x8             jt 6	jf 11
			(006) jset     #0x4             jt 11	jf 7
			(007) jset     #0x80            jt 8	jf 11
			(008) ld       M[0]
			(009) add      #2
			(010) st       M[0]
			(011) ldb      [0]
			(012) jset     #0x4             jt 41	jf 13
			(013) ldb      [0]
			(014) jset     #0x8             jt 19	jf 15
			(015) ld       [12]
			(016) jeq      #0x400140e       jt 17	jf 19
			(017) ldh      [10]
			(018) jeq      #0xaa00          jt 63	jf 19
			(019) ldb      [0]
			(020) jset     #0x8             jt 21	jf 41
			(021) ldb      [1]
			(022) jset     #0x2             jt 27	jf 23
			(023) ld       [12]
			(024) jeq      #0x400140e       jt 25	jf 27
			(025) ldh      [10]
			(026) jeq      #0xaa00          jt 63	jf 27
			(027) ldb      [1]
			(028) jset     #0x2             jt 29	jf 41
			(029) ldb      [1]
			(030) jset     #0x1             jt 35	jf 31
			(031) ld       [18]
			(032) jeq      #0x400140e       jt 33	jf 35
			(033) ldh      [16]
			(034) jeq      #0xaa00          jt 63	jf 35
			(035) ldb      [1]
			(036) jset     #0x1             jt 37	jf 41
			(037) ld       [26]
			(038) jeq      #0x400140e       jt 39	jf 41
			(039) ldh      [24]
			(040) jeq      #0xaa00          jt 63	jf 41
			(041) ldb      [0]
			(042) jset     #0x4             jt 124	jf 43
			(043) ldb      [0]
			(044) jset     #0x8             jt 49	jf 45
			(045) ld       [6]
			(046) jeq      #0x400140e       jt 47	jf 49
			(047) ldh      [4]
			(048) jeq      #0xaa00          jt 63	jf 49
			(049) ldb      [0]
			(050) jset     #0x8             jt 51	jf 124
			(051) ldb      [1]
			(052) jset     #0x1             jt 57	jf 53
			(053) ld       [6]
			(054) jeq      #0x400140e       jt 55	jf 57
			(055) ldh      [4]
			(056) jeq      #0xaa00          jt 63	jf 57
			(057) ldb      [1]
			(058) jset     #0x1             jt 59	jf 124
			(059) ld       [18]
			(060) jeq      #0x400140e       jt 61	jf 124
			(061) ldh      [16]
			(062) jeq      #0xaa00          jt 63	jf 124
			(063) ldb      [0]
			(064) jset     #0x4             jt 73	jf 65
			(065) ldb      [0]
			(066) jset     #0x8             jt 67	jf 73
			(067) ldx      M[0]
			(068) ldh      [x + 6]
			(069) jeq      #0x800           jt 70	jf 73
			(070) ldx      M[0]
			(071) ld       [x + 20]
			(072) jeq      #0xa141e28       jt 124	jf 73
			(073) ldb      [0]
			(074) jset     #0x4             jt 83	jf 75
			(075) ldb      [0]
			(076) jset     #0x8             jt 77	jf 83
			(077) ldx      M[0]
			(078) ldh      [x + 6]
			(079) jeq      #0x800           jt 80	jf 83
			(080) ldx      M[0]
			(081) ld       [x + 24]
			(082) jeq      #0xa141e28       jt 124	jf 83
			(083) ldb      [0]
			(084) jset     #0x4             jt 93	jf 85
			(085) ldb      [0]
			(086) jset     #0x8             jt 87	jf 93
			(087) ldx      M[0]
			(088) ldh      [x + 6]
			(089) jeq      #0x806           jt 90	jf 93
			(090) ldx      M[0]
			(091) ld       [x + 22]
			(092) jeq      #0xa141e28       jt 124	jf 93
			(093) ldb      [0]
			(094) jset     #0x4             jt 103	jf 95
			(095) ldb      [0]
			(096) jset     #0x8             jt 97	jf 103
			(097) ldx      M[0]
			(098) ldh      [x + 6]
			(099) jeq      #0x806           jt 100	jf 103
			(100) ldx      M[0]
			(101) ld       [x + 32]
			(102) jeq      #0xa141e28       jt 124	jf 103
			(103) ldb      [0]
			(104) jset     #0x4             jt 113	jf 105
			(105) ldb      [0]
			(106) jset     #0x8             jt 107	jf 113
			(107) ldx      M[0]
			(108) ldh      [x + 6]
			(109) jeq      #0x8035          jt 110	jf 113
			(110) ldx      M[0]
			(111) ld       [x + 22]
			(112) jeq      #0xa141e28       jt 124	jf 113
			(113) ldb      [0]
			(114) jset     #0x4             jt 123	jf 115
			(115) ldb      [0]
			(116) jset     #0x8             jt 117	jf 123
			(117) ldx      M[0]
			(118) ldh      [x + 6]
			(119) jeq      #0x8035          jt 120	jf 123
			(120) ldx      M[0]
			(121) ld       [x + 32]
			(122) jeq      #0xa141e28       jt 124	jf 123
			(123) ret      #262144
			(124) ret      #0
			',
	}, # gateway_name_ieee802_11
	gateway_NAME_ieee802_11 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IEEE802_11',
		aliases => [
			'gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ldx      #0x0
			(001) txa
			(002) add      #24
			(003) st       M[0]
			(004) ldb      [x + 0]
			(005) jset     #0x8             jt 6	jf 11
			(006) jset     #0x4             jt 11	jf 7
			(007) jset     #0x80            jt 8	jf 11
			(008) ld       M[0]
			(009) add      #2
			(010) st       M[0]
			(011) ldb      [0]
			(012) jset     #0x4             jt 41	jf 13
			(013) ldb      [0]
			(014) jset     #0x8             jt 19	jf 15
			(015) ld       [12]
			(016) jeq      #0x400140e       jt 17	jf 19
			(017) ldh      [10]
			(018) jeq      #0xaa00          jt 63	jf 19
			(019) ldb      [0]
			(020) jset     #0x8             jt 21	jf 41
			(021) ldb      [1]
			(022) jset     #0x2             jt 27	jf 23
			(023) ld       [12]
			(024) jeq      #0x400140e       jt 25	jf 27
			(025) ldh      [10]
			(026) jeq      #0xaa00          jt 63	jf 27
			(027) ldb      [1]
			(028) jset     #0x2             jt 29	jf 41
			(029) ldb      [1]
			(030) jset     #0x1             jt 35	jf 31
			(031) ld       [18]
			(032) jeq      #0x400140e       jt 33	jf 35
			(033) ldh      [16]
			(034) jeq      #0xaa00          jt 63	jf 35
			(035) ldb      [1]
			(036) jset     #0x1             jt 37	jf 41
			(037) ld       [26]
			(038) jeq      #0x400140e       jt 39	jf 41
			(039) ldh      [24]
			(040) jeq      #0xaa00          jt 63	jf 41
			(041) ldb      [0]
			(042) jset     #0x4             jt 124	jf 43
			(043) ldb      [0]
			(044) jset     #0x8             jt 49	jf 45
			(045) ld       [6]
			(046) jeq      #0x400140e       jt 47	jf 49
			(047) ldh      [4]
			(048) jeq      #0xaa00          jt 63	jf 49
			(049) ldb      [0]
			(050) jset     #0x8             jt 51	jf 124
			(051) ldb      [1]
			(052) jset     #0x1             jt 57	jf 53
			(053) ld       [6]
			(054) jeq      #0x400140e       jt 55	jf 57
			(055) ldh      [4]
			(056) jeq      #0xaa00          jt 63	jf 57
			(057) ldb      [1]
			(058) jset     #0x1             jt 59	jf 124
			(059) ld       [18]
			(060) jeq      #0x400140e       jt 61	jf 124
			(061) ldh      [16]
			(062) jeq      #0xaa00          jt 63	jf 124
			(063) ldb      [0]
			(064) jset     #0x4             jt 73	jf 65
			(065) ldb      [0]
			(066) jset     #0x8             jt 67	jf 73
			(067) ldx      M[0]
			(068) ldh      [x + 6]
			(069) jeq      #0x800           jt 70	jf 73
			(070) ldx      M[0]
			(071) ld       [x + 20]
			(072) jeq      #0xa141e28       jt 124	jf 73
			(073) ldb      [0]
			(074) jset     #0x4             jt 83	jf 75
			(075) ldb      [0]
			(076) jset     #0x8             jt 77	jf 83
			(077) ldx      M[0]
			(078) ldh      [x + 6]
			(079) jeq      #0x800           jt 80	jf 83
			(080) ldx      M[0]
			(081) ld       [x + 24]
			(082) jeq      #0xa141e28       jt 124	jf 83
			(083) ldb      [0]
			(084) jset     #0x4             jt 93	jf 85
			(085) ldb      [0]
			(086) jset     #0x8             jt 87	jf 93
			(087) ldx      M[0]
			(088) ldh      [x + 6]
			(089) jeq      #0x806           jt 90	jf 93
			(090) ldx      M[0]
			(091) ld       [x + 22]
			(092) jeq      #0xa141e28       jt 124	jf 93
			(093) ldb      [0]
			(094) jset     #0x4             jt 103	jf 95
			(095) ldb      [0]
			(096) jset     #0x8             jt 97	jf 103
			(097) ldx      M[0]
			(098) ldh      [x + 6]
			(099) jeq      #0x806           jt 100	jf 103
			(100) ldx      M[0]
			(101) ld       [x + 32]
			(102) jeq      #0xa141e28       jt 124	jf 103
			(103) ldb      [0]
			(104) jset     #0x4             jt 113	jf 105
			(105) ldb      [0]
			(106) jset     #0x8             jt 107	jf 113
			(107) ldx      M[0]
			(108) ldh      [x + 6]
			(109) jeq      #0x8035          jt 110	jf 113
			(110) ldx      M[0]
			(111) ld       [x + 22]
			(112) jeq      #0xa141e28       jt 124	jf 113
			(113) ldb      [0]
			(114) jset     #0x4             jt 123	jf 115
			(115) ldb      [0]
			(116) jset     #0x8             jt 117	jf 123
			(117) ldx      M[0]
			(118) ldh      [x + 6]
			(119) jeq      #0x8035          jt 120	jf 123
			(120) ldx      M[0]
			(121) ld       [x + 32]
			(122) jeq      #0xa141e28       jt 124	jf 123
			(123) ret      #262144
			(124) ret      #0
			',
	}, # gateway_NAME_ieee802_11
	ip_gateway_name_ieee802_11 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IEEE802_11',
		aliases => [
			'ip gateway eth-ipv4-noipv6.host123.libpcap.test',
			'ip gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ldx      #0x0
			(001) txa
			(002) add      #24
			(003) st       M[0]
			(004) ldb      [x + 0]
			(005) jset     #0x8             jt 6	jf 11
			(006) jset     #0x4             jt 11	jf 7
			(007) jset     #0x80            jt 8	jf 11
			(008) ld       M[0]
			(009) add      #2
			(010) st       M[0]
			(011) ldb      [0]
			(012) jset     #0x4             jt 41	jf 13
			(013) ldb      [0]
			(014) jset     #0x8             jt 19	jf 15
			(015) ld       [12]
			(016) jeq      #0x400140e       jt 17	jf 19
			(017) ldh      [10]
			(018) jeq      #0xaa00          jt 63	jf 19
			(019) ldb      [0]
			(020) jset     #0x8             jt 21	jf 41
			(021) ldb      [1]
			(022) jset     #0x2             jt 27	jf 23
			(023) ld       [12]
			(024) jeq      #0x400140e       jt 25	jf 27
			(025) ldh      [10]
			(026) jeq      #0xaa00          jt 63	jf 27
			(027) ldb      [1]
			(028) jset     #0x2             jt 29	jf 41
			(029) ldb      [1]
			(030) jset     #0x1             jt 35	jf 31
			(031) ld       [18]
			(032) jeq      #0x400140e       jt 33	jf 35
			(033) ldh      [16]
			(034) jeq      #0xaa00          jt 63	jf 35
			(035) ldb      [1]
			(036) jset     #0x1             jt 37	jf 41
			(037) ld       [26]
			(038) jeq      #0x400140e       jt 39	jf 41
			(039) ldh      [24]
			(040) jeq      #0xaa00          jt 63	jf 41
			(041) ldb      [0]
			(042) jset     #0x4             jt 84	jf 43
			(043) ldb      [0]
			(044) jset     #0x8             jt 49	jf 45
			(045) ld       [6]
			(046) jeq      #0x400140e       jt 47	jf 49
			(047) ldh      [4]
			(048) jeq      #0xaa00          jt 63	jf 49
			(049) ldb      [0]
			(050) jset     #0x8             jt 51	jf 84
			(051) ldb      [1]
			(052) jset     #0x1             jt 57	jf 53
			(053) ld       [6]
			(054) jeq      #0x400140e       jt 55	jf 57
			(055) ldh      [4]
			(056) jeq      #0xaa00          jt 63	jf 57
			(057) ldb      [1]
			(058) jset     #0x1             jt 59	jf 84
			(059) ld       [18]
			(060) jeq      #0x400140e       jt 61	jf 84
			(061) ldh      [16]
			(062) jeq      #0xaa00          jt 63	jf 84
			(063) ldb      [0]
			(064) jset     #0x4             jt 73	jf 65
			(065) ldb      [0]
			(066) jset     #0x8             jt 67	jf 73
			(067) ldx      M[0]
			(068) ldh      [x + 6]
			(069) jeq      #0x800           jt 70	jf 73
			(070) ldx      M[0]
			(071) ld       [x + 20]
			(072) jeq      #0xa141e28       jt 84	jf 73
			(073) ldb      [0]
			(074) jset     #0x4             jt 83	jf 75
			(075) ldb      [0]
			(076) jset     #0x8             jt 77	jf 83
			(077) ldx      M[0]
			(078) ldh      [x + 6]
			(079) jeq      #0x800           jt 80	jf 83
			(080) ldx      M[0]
			(081) ld       [x + 24]
			(082) jeq      #0xa141e28       jt 84	jf 83
			(083) ret      #262144
			(084) ret      #0
			',
	}, # ip_gateway_name_ieee802_11
	ip_gateway_NAME_ieee802_11 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IEEE802_11',
		aliases => [
			'ip gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ldx      #0x0
			(001) txa
			(002) add      #24
			(003) st       M[0]
			(004) ldb      [x + 0]
			(005) jset     #0x8             jt 6	jf 11
			(006) jset     #0x4             jt 11	jf 7
			(007) jset     #0x80            jt 8	jf 11
			(008) ld       M[0]
			(009) add      #2
			(010) st       M[0]
			(011) ldb      [0]
			(012) jset     #0x4             jt 41	jf 13
			(013) ldb      [0]
			(014) jset     #0x8             jt 19	jf 15
			(015) ld       [12]
			(016) jeq      #0x400140e       jt 17	jf 19
			(017) ldh      [10]
			(018) jeq      #0xaa00          jt 63	jf 19
			(019) ldb      [0]
			(020) jset     #0x8             jt 21	jf 41
			(021) ldb      [1]
			(022) jset     #0x2             jt 27	jf 23
			(023) ld       [12]
			(024) jeq      #0x400140e       jt 25	jf 27
			(025) ldh      [10]
			(026) jeq      #0xaa00          jt 63	jf 27
			(027) ldb      [1]
			(028) jset     #0x2             jt 29	jf 41
			(029) ldb      [1]
			(030) jset     #0x1             jt 35	jf 31
			(031) ld       [18]
			(032) jeq      #0x400140e       jt 33	jf 35
			(033) ldh      [16]
			(034) jeq      #0xaa00          jt 63	jf 35
			(035) ldb      [1]
			(036) jset     #0x1             jt 37	jf 41
			(037) ld       [26]
			(038) jeq      #0x400140e       jt 39	jf 41
			(039) ldh      [24]
			(040) jeq      #0xaa00          jt 63	jf 41
			(041) ldb      [0]
			(042) jset     #0x4             jt 84	jf 43
			(043) ldb      [0]
			(044) jset     #0x8             jt 49	jf 45
			(045) ld       [6]
			(046) jeq      #0x400140e       jt 47	jf 49
			(047) ldh      [4]
			(048) jeq      #0xaa00          jt 63	jf 49
			(049) ldb      [0]
			(050) jset     #0x8             jt 51	jf 84
			(051) ldb      [1]
			(052) jset     #0x1             jt 57	jf 53
			(053) ld       [6]
			(054) jeq      #0x400140e       jt 55	jf 57
			(055) ldh      [4]
			(056) jeq      #0xaa00          jt 63	jf 57
			(057) ldb      [1]
			(058) jset     #0x1             jt 59	jf 84
			(059) ld       [18]
			(060) jeq      #0x400140e       jt 61	jf 84
			(061) ldh      [16]
			(062) jeq      #0xaa00          jt 63	jf 84
			(063) ldb      [0]
			(064) jset     #0x4             jt 73	jf 65
			(065) ldb      [0]
			(066) jset     #0x8             jt 67	jf 73
			(067) ldx      M[0]
			(068) ldh      [x + 6]
			(069) jeq      #0x800           jt 70	jf 73
			(070) ldx      M[0]
			(071) ld       [x + 20]
			(072) jeq      #0xa141e28       jt 84	jf 73
			(073) ldb      [0]
			(074) jset     #0x4             jt 83	jf 75
			(075) ldb      [0]
			(076) jset     #0x8             jt 77	jf 83
			(077) ldx      M[0]
			(078) ldh      [x + 6]
			(079) jeq      #0x800           jt 80	jf 83
			(080) ldx      M[0]
			(081) ld       [x + 24]
			(082) jeq      #0xa141e28       jt 84	jf 83
			(083) ret      #262144
			(084) ret      #0
			',
	}, # ip_gateway_NAME_ieee802_11
	arp_gateway_name_ieee802_11 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IEEE802_11',
		aliases => [
			'arp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'arp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ldx      #0x0
			(001) txa
			(002) add      #24
			(003) st       M[0]
			(004) ldb      [x + 0]
			(005) jset     #0x8             jt 6	jf 11
			(006) jset     #0x4             jt 11	jf 7
			(007) jset     #0x80            jt 8	jf 11
			(008) ld       M[0]
			(009) add      #2
			(010) st       M[0]
			(011) ldb      [0]
			(012) jset     #0x4             jt 41	jf 13
			(013) ldb      [0]
			(014) jset     #0x8             jt 19	jf 15
			(015) ld       [12]
			(016) jeq      #0x400140e       jt 17	jf 19
			(017) ldh      [10]
			(018) jeq      #0xaa00          jt 63	jf 19
			(019) ldb      [0]
			(020) jset     #0x8             jt 21	jf 41
			(021) ldb      [1]
			(022) jset     #0x2             jt 27	jf 23
			(023) ld       [12]
			(024) jeq      #0x400140e       jt 25	jf 27
			(025) ldh      [10]
			(026) jeq      #0xaa00          jt 63	jf 27
			(027) ldb      [1]
			(028) jset     #0x2             jt 29	jf 41
			(029) ldb      [1]
			(030) jset     #0x1             jt 35	jf 31
			(031) ld       [18]
			(032) jeq      #0x400140e       jt 33	jf 35
			(033) ldh      [16]
			(034) jeq      #0xaa00          jt 63	jf 35
			(035) ldb      [1]
			(036) jset     #0x1             jt 37	jf 41
			(037) ld       [26]
			(038) jeq      #0x400140e       jt 39	jf 41
			(039) ldh      [24]
			(040) jeq      #0xaa00          jt 63	jf 41
			(041) ldb      [0]
			(042) jset     #0x4             jt 84	jf 43
			(043) ldb      [0]
			(044) jset     #0x8             jt 49	jf 45
			(045) ld       [6]
			(046) jeq      #0x400140e       jt 47	jf 49
			(047) ldh      [4]
			(048) jeq      #0xaa00          jt 63	jf 49
			(049) ldb      [0]
			(050) jset     #0x8             jt 51	jf 84
			(051) ldb      [1]
			(052) jset     #0x1             jt 57	jf 53
			(053) ld       [6]
			(054) jeq      #0x400140e       jt 55	jf 57
			(055) ldh      [4]
			(056) jeq      #0xaa00          jt 63	jf 57
			(057) ldb      [1]
			(058) jset     #0x1             jt 59	jf 84
			(059) ld       [18]
			(060) jeq      #0x400140e       jt 61	jf 84
			(061) ldh      [16]
			(062) jeq      #0xaa00          jt 63	jf 84
			(063) ldb      [0]
			(064) jset     #0x4             jt 73	jf 65
			(065) ldb      [0]
			(066) jset     #0x8             jt 67	jf 73
			(067) ldx      M[0]
			(068) ldh      [x + 6]
			(069) jeq      #0x806           jt 70	jf 73
			(070) ldx      M[0]
			(071) ld       [x + 22]
			(072) jeq      #0xa141e28       jt 84	jf 73
			(073) ldb      [0]
			(074) jset     #0x4             jt 83	jf 75
			(075) ldb      [0]
			(076) jset     #0x8             jt 77	jf 83
			(077) ldx      M[0]
			(078) ldh      [x + 6]
			(079) jeq      #0x806           jt 80	jf 83
			(080) ldx      M[0]
			(081) ld       [x + 32]
			(082) jeq      #0xa141e28       jt 84	jf 83
			(083) ret      #262144
			(084) ret      #0
			',
	}, # arp_gateway_name_ieee802_11
	arp_gateway_NAME_ieee802_11 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IEEE802_11',
		aliases => [
			'arp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'arp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ldx      #0x0
			(001) txa
			(002) add      #24
			(003) st       M[0]
			(004) ldb      [x + 0]
			(005) jset     #0x8             jt 6	jf 11
			(006) jset     #0x4             jt 11	jf 7
			(007) jset     #0x80            jt 8	jf 11
			(008) ld       M[0]
			(009) add      #2
			(010) st       M[0]
			(011) ldb      [0]
			(012) jset     #0x4             jt 41	jf 13
			(013) ldb      [0]
			(014) jset     #0x8             jt 19	jf 15
			(015) ld       [12]
			(016) jeq      #0x400140e       jt 17	jf 19
			(017) ldh      [10]
			(018) jeq      #0xaa00          jt 63	jf 19
			(019) ldb      [0]
			(020) jset     #0x8             jt 21	jf 41
			(021) ldb      [1]
			(022) jset     #0x2             jt 27	jf 23
			(023) ld       [12]
			(024) jeq      #0x400140e       jt 25	jf 27
			(025) ldh      [10]
			(026) jeq      #0xaa00          jt 63	jf 27
			(027) ldb      [1]
			(028) jset     #0x2             jt 29	jf 41
			(029) ldb      [1]
			(030) jset     #0x1             jt 35	jf 31
			(031) ld       [18]
			(032) jeq      #0x400140e       jt 33	jf 35
			(033) ldh      [16]
			(034) jeq      #0xaa00          jt 63	jf 35
			(035) ldb      [1]
			(036) jset     #0x1             jt 37	jf 41
			(037) ld       [26]
			(038) jeq      #0x400140e       jt 39	jf 41
			(039) ldh      [24]
			(040) jeq      #0xaa00          jt 63	jf 41
			(041) ldb      [0]
			(042) jset     #0x4             jt 84	jf 43
			(043) ldb      [0]
			(044) jset     #0x8             jt 49	jf 45
			(045) ld       [6]
			(046) jeq      #0x400140e       jt 47	jf 49
			(047) ldh      [4]
			(048) jeq      #0xaa00          jt 63	jf 49
			(049) ldb      [0]
			(050) jset     #0x8             jt 51	jf 84
			(051) ldb      [1]
			(052) jset     #0x1             jt 57	jf 53
			(053) ld       [6]
			(054) jeq      #0x400140e       jt 55	jf 57
			(055) ldh      [4]
			(056) jeq      #0xaa00          jt 63	jf 57
			(057) ldb      [1]
			(058) jset     #0x1             jt 59	jf 84
			(059) ld       [18]
			(060) jeq      #0x400140e       jt 61	jf 84
			(061) ldh      [16]
			(062) jeq      #0xaa00          jt 63	jf 84
			(063) ldb      [0]
			(064) jset     #0x4             jt 73	jf 65
			(065) ldb      [0]
			(066) jset     #0x8             jt 67	jf 73
			(067) ldx      M[0]
			(068) ldh      [x + 6]
			(069) jeq      #0x806           jt 70	jf 73
			(070) ldx      M[0]
			(071) ld       [x + 22]
			(072) jeq      #0xa141e28       jt 84	jf 73
			(073) ldb      [0]
			(074) jset     #0x4             jt 83	jf 75
			(075) ldb      [0]
			(076) jset     #0x8             jt 77	jf 83
			(077) ldx      M[0]
			(078) ldh      [x + 6]
			(079) jeq      #0x806           jt 80	jf 83
			(080) ldx      M[0]
			(081) ld       [x + 32]
			(082) jeq      #0xa141e28       jt 84	jf 83
			(083) ret      #262144
			(084) ret      #0
			',
	}, # arp_gateway_NAME_ieee802_11
	rarp_gateway_name_ieee802_11 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IEEE802_11',
		aliases => [
			'rarp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'rarp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ldx      #0x0
			(001) txa
			(002) add      #24
			(003) st       M[0]
			(004) ldb      [x + 0]
			(005) jset     #0x8             jt 6	jf 11
			(006) jset     #0x4             jt 11	jf 7
			(007) jset     #0x80            jt 8	jf 11
			(008) ld       M[0]
			(009) add      #2
			(010) st       M[0]
			(011) ldb      [0]
			(012) jset     #0x4             jt 41	jf 13
			(013) ldb      [0]
			(014) jset     #0x8             jt 19	jf 15
			(015) ld       [12]
			(016) jeq      #0x400140e       jt 17	jf 19
			(017) ldh      [10]
			(018) jeq      #0xaa00          jt 63	jf 19
			(019) ldb      [0]
			(020) jset     #0x8             jt 21	jf 41
			(021) ldb      [1]
			(022) jset     #0x2             jt 27	jf 23
			(023) ld       [12]
			(024) jeq      #0x400140e       jt 25	jf 27
			(025) ldh      [10]
			(026) jeq      #0xaa00          jt 63	jf 27
			(027) ldb      [1]
			(028) jset     #0x2             jt 29	jf 41
			(029) ldb      [1]
			(030) jset     #0x1             jt 35	jf 31
			(031) ld       [18]
			(032) jeq      #0x400140e       jt 33	jf 35
			(033) ldh      [16]
			(034) jeq      #0xaa00          jt 63	jf 35
			(035) ldb      [1]
			(036) jset     #0x1             jt 37	jf 41
			(037) ld       [26]
			(038) jeq      #0x400140e       jt 39	jf 41
			(039) ldh      [24]
			(040) jeq      #0xaa00          jt 63	jf 41
			(041) ldb      [0]
			(042) jset     #0x4             jt 84	jf 43
			(043) ldb      [0]
			(044) jset     #0x8             jt 49	jf 45
			(045) ld       [6]
			(046) jeq      #0x400140e       jt 47	jf 49
			(047) ldh      [4]
			(048) jeq      #0xaa00          jt 63	jf 49
			(049) ldb      [0]
			(050) jset     #0x8             jt 51	jf 84
			(051) ldb      [1]
			(052) jset     #0x1             jt 57	jf 53
			(053) ld       [6]
			(054) jeq      #0x400140e       jt 55	jf 57
			(055) ldh      [4]
			(056) jeq      #0xaa00          jt 63	jf 57
			(057) ldb      [1]
			(058) jset     #0x1             jt 59	jf 84
			(059) ld       [18]
			(060) jeq      #0x400140e       jt 61	jf 84
			(061) ldh      [16]
			(062) jeq      #0xaa00          jt 63	jf 84
			(063) ldb      [0]
			(064) jset     #0x4             jt 73	jf 65
			(065) ldb      [0]
			(066) jset     #0x8             jt 67	jf 73
			(067) ldx      M[0]
			(068) ldh      [x + 6]
			(069) jeq      #0x8035          jt 70	jf 73
			(070) ldx      M[0]
			(071) ld       [x + 22]
			(072) jeq      #0xa141e28       jt 84	jf 73
			(073) ldb      [0]
			(074) jset     #0x4             jt 83	jf 75
			(075) ldb      [0]
			(076) jset     #0x8             jt 77	jf 83
			(077) ldx      M[0]
			(078) ldh      [x + 6]
			(079) jeq      #0x8035          jt 80	jf 83
			(080) ldx      M[0]
			(081) ld       [x + 32]
			(082) jeq      #0xa141e28       jt 84	jf 83
			(083) ret      #262144
			(084) ret      #0
			',
	}, # rarp_gateway_name_ieee802_11
	rarp_gateway_NAME_ieee802_11 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IEEE802_11',
		aliases => [
			'rarp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'rarp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ldx      #0x0
			(001) txa
			(002) add      #24
			(003) st       M[0]
			(004) ldb      [x + 0]
			(005) jset     #0x8             jt 6	jf 11
			(006) jset     #0x4             jt 11	jf 7
			(007) jset     #0x80            jt 8	jf 11
			(008) ld       M[0]
			(009) add      #2
			(010) st       M[0]
			(011) ldb      [0]
			(012) jset     #0x4             jt 41	jf 13
			(013) ldb      [0]
			(014) jset     #0x8             jt 19	jf 15
			(015) ld       [12]
			(016) jeq      #0x400140e       jt 17	jf 19
			(017) ldh      [10]
			(018) jeq      #0xaa00          jt 63	jf 19
			(019) ldb      [0]
			(020) jset     #0x8             jt 21	jf 41
			(021) ldb      [1]
			(022) jset     #0x2             jt 27	jf 23
			(023) ld       [12]
			(024) jeq      #0x400140e       jt 25	jf 27
			(025) ldh      [10]
			(026) jeq      #0xaa00          jt 63	jf 27
			(027) ldb      [1]
			(028) jset     #0x2             jt 29	jf 41
			(029) ldb      [1]
			(030) jset     #0x1             jt 35	jf 31
			(031) ld       [18]
			(032) jeq      #0x400140e       jt 33	jf 35
			(033) ldh      [16]
			(034) jeq      #0xaa00          jt 63	jf 35
			(035) ldb      [1]
			(036) jset     #0x1             jt 37	jf 41
			(037) ld       [26]
			(038) jeq      #0x400140e       jt 39	jf 41
			(039) ldh      [24]
			(040) jeq      #0xaa00          jt 63	jf 41
			(041) ldb      [0]
			(042) jset     #0x4             jt 84	jf 43
			(043) ldb      [0]
			(044) jset     #0x8             jt 49	jf 45
			(045) ld       [6]
			(046) jeq      #0x400140e       jt 47	jf 49
			(047) ldh      [4]
			(048) jeq      #0xaa00          jt 63	jf 49
			(049) ldb      [0]
			(050) jset     #0x8             jt 51	jf 84
			(051) ldb      [1]
			(052) jset     #0x1             jt 57	jf 53
			(053) ld       [6]
			(054) jeq      #0x400140e       jt 55	jf 57
			(055) ldh      [4]
			(056) jeq      #0xaa00          jt 63	jf 57
			(057) ldb      [1]
			(058) jset     #0x1             jt 59	jf 84
			(059) ld       [18]
			(060) jeq      #0x400140e       jt 61	jf 84
			(061) ldh      [16]
			(062) jeq      #0xaa00          jt 63	jf 84
			(063) ldb      [0]
			(064) jset     #0x4             jt 73	jf 65
			(065) ldb      [0]
			(066) jset     #0x8             jt 67	jf 73
			(067) ldx      M[0]
			(068) ldh      [x + 6]
			(069) jeq      #0x8035          jt 70	jf 73
			(070) ldx      M[0]
			(071) ld       [x + 22]
			(072) jeq      #0xa141e28       jt 84	jf 73
			(073) ldb      [0]
			(074) jset     #0x4             jt 83	jf 75
			(075) ldb      [0]
			(076) jset     #0x8             jt 77	jf 83
			(077) ldx      M[0]
			(078) ldh      [x + 6]
			(079) jeq      #0x8035          jt 80	jf 83
			(080) ldx      M[0]
			(081) ld       [x + 32]
			(082) jeq      #0xa141e28       jt 84	jf 83
			(083) ret      #262144
			(084) ret      #0
			',
	}, # rarp_gateway_NAME_ieee802_11
	gateway_name_ip_over_fc => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IP_OVER_FC',
		aliases => [
			'gateway eth-ipv4-noipv6.host123.libpcap.test',
			'gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [12]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [10]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 21
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 21
			(008) ldh      [22]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [36]
			(011) jeq      #0xa141e28       jt 21	jf 12
			(012) ld       [40]
			(013) jeq      #0xa141e28       jt 21	jf 20
			(014) jeq      #0x806           jt 16	jf 15
			(015) jeq      #0x8035          jt 16	jf 20
			(016) ld       [38]
			(017) jeq      #0xa141e28       jt 21	jf 18
			(018) ld       [48]
			(019) jeq      #0xa141e28       jt 21	jf 20
			(020) ret      #262144
			(021) ret      #0
			',
	}, # gateway_name_ip_over_fc
	gateway_NAME_ip_over_fc => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IP_OVER_FC',
		aliases => [
			'gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [12]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [10]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 21
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 21
			(008) ldh      [22]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [36]
			(011) jeq      #0xa141e28       jt 21	jf 12
			(012) ld       [40]
			(013) jeq      #0xa141e28       jt 21	jf 20
			(014) jeq      #0x806           jt 16	jf 15
			(015) jeq      #0x8035          jt 16	jf 20
			(016) ld       [38]
			(017) jeq      #0xa141e28       jt 21	jf 18
			(018) ld       [48]
			(019) jeq      #0xa141e28       jt 21	jf 20
			(020) ret      #262144
			(021) ret      #0
			',
	}, # gateway_NAME_ip_over_fc
	ip_gateway_name_ip_over_fc => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IP_OVER_FC',
		aliases => [
			'ip gateway eth-ipv4-noipv6.host123.libpcap.test',
			'ip gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [12]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [10]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [22]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [36]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [40]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # ip_gateway_name_ip_over_fc
	ip_gateway_NAME_ip_over_fc => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IP_OVER_FC',
		aliases => [
			'ip gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'ip gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [12]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [10]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [22]
			(009) jeq      #0x800           jt 10	jf 14
			(010) ld       [36]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [40]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # ip_gateway_NAME_ip_over_fc
	arp_gateway_name_ip_over_fc => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IP_OVER_FC',
		aliases => [
			'arp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'arp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [12]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [10]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [22]
			(009) jeq      #0x806           jt 10	jf 14
			(010) ld       [38]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [48]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # arp_gateway_name_ip_over_fc
	arp_gateway_NAME_ip_over_fc => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IP_OVER_FC',
		aliases => [
			'arp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'arp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [12]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [10]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [22]
			(009) jeq      #0x806           jt 10	jf 14
			(010) ld       [38]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [48]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # arp_gateway_NAME_ip_over_fc
	rarp_gateway_name_ip_over_fc => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'IP_OVER_FC',
		aliases => [
			'rarp gateway eth-ipv4-noipv6.host123.libpcap.test',
			'rarp gateway eth-ipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ld       [12]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [10]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [22]
			(009) jeq      #0x8035          jt 10	jf 14
			(010) ld       [38]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [48]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # rarp_gateway_name_ip_over_fc
	rarp_gateway_NAME_ip_over_fc => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers_casecmp() ||
			skip_no_hosts_casecmp(),
		DLT => 'IP_OVER_FC',
		aliases => [
			'rarp gateway ETH-IPV4-NOIPV6.HOST123.LIBPCAP.TEST',
			'rarp gateway ETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ld       [12]
			(001) jeq      #0x400140e       jt 2	jf 4
			(002) ldh      [10]
			(003) jeq      #0xaa00          jt 8	jf 4
			(004) ld       [4]
			(005) jeq      #0x400140e       jt 6	jf 15
			(006) ldh      [2]
			(007) jeq      #0xaa00          jt 8	jf 15
			(008) ldh      [22]
			(009) jeq      #0x8035          jt 10	jf 14
			(010) ld       [38]
			(011) jeq      #0xa141e28       jt 15	jf 12
			(012) ld       [48]
			(013) jeq      #0xa141e28       jt 15	jf 14
			(014) ret      #262144
			(015) ret      #0
			',
	}, # rarp_gateway_NAME_ip_over_fc
	carp => {
		DLT => 'EN10MB',
		aliases => [
			'carp',
			'vrrp',
			'ip proto 112',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 5
			(002) ldb      [23]
			(003) jeq      #0x70            jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # carp
	icmp => {
		DLT => 'EN10MB',
		aliases => [
			'icmp',
			'ip proto 1',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 5
			(002) ldb      [23]
			(003) jeq      #0x1             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # icmp
	igmp => {
		DLT => 'EN10MB',
		aliases => [
			'igmp',
			'ip proto 2',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 5
			(002) ldb      [23]
			(003) jeq      #0x2             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # igmp
	# "igrp" uses IPPROTO_IGRP, which FreeBSD and its derivatives define, but
	# other supported OSes don't (thus libpcap uses its own value, which is
	# different from FreeBSD).  Test each case separately.
	# this discrepancy.
	igrp_9 => {
		skip => skip_os ('freebsd') || skip_os ('darwin') || skip_os ('dragonfly'),
		DLT => 'EN10MB',
		aliases => [
			'igrp',
			'ip proto 9',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 5
			(002) ldb      [23]
			(003) jeq      #0x9             jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # igrp_9
	igrp_88 => {
		skip => skip_os_not ('freebsd') && skip_os_not ('darwin') && skip_os_not ('dragonfly'),
		DLT => 'EN10MB',
		aliases => [
			'igrp',
			'ip proto 88',
		],
		unopt => '
			(000) ldh      [12]
			(001) jeq      #0x800           jt 2	jf 5
			(002) ldb      [23]
			(003) jeq      #0x58            jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # igrp_88
	icmp6 => {
		DLT => 'EN10MB',
		aliases => [
			'icmp6',
			'ip6 proto 58',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x3a            jt 7	jf 4
			(004) jeq      #0x2c            jt 5	jf 8
			(005) ldb      [54]
			(006) jeq      #0x3a            jt 7	jf 8
			(007) ret      #262144
			(008) ret      #0
			',
	}, # icmp6
	ah => {
		DLT => 'RAW',
		aliases => [
			'ah',
			'proto 51', # not "proto \ah"
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 5
			(003) ldb      [9]
			(004) jeq      #0x33            jt 13	jf 14
			(005) ldb      [0]
			(006) and      #0xf0
			(007) jeq      #0x60            jt 8	jf 14
			(008) ldb      [6]
			(009) jeq      #0x33            jt 13	jf 10
			(010) jeq      #0x2c            jt 11	jf 14
			(011) ldb      [40]
			(012) jeq      #0x33            jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # ah
	esp => {
		DLT => 'RAW',
		aliases => [
			'esp',
			'proto 50', # not "proto \esp"
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 5
			(003) ldb      [9]
			(004) jeq      #0x32            jt 13	jf 14
			(005) ldb      [0]
			(006) and      #0xf0
			(007) jeq      #0x60            jt 8	jf 14
			(008) ldb      [6]
			(009) jeq      #0x32            jt 13	jf 10
			(010) jeq      #0x2c            jt 11	jf 14
			(011) ldb      [40]
			(012) jeq      #0x32            jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # esp
	pim => {
		DLT => 'RAW',
		aliases => [
			'pim',
			'proto 103', # not "proto \pim"
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 5
			(003) ldb      [9]
			(004) jeq      #0x67            jt 13	jf 14
			(005) ldb      [0]
			(006) and      #0xf0
			(007) jeq      #0x60            jt 8	jf 14
			(008) ldb      [6]
			(009) jeq      #0x67            jt 13	jf 10
			(010) jeq      #0x2c            jt 11	jf 14
			(011) ldb      [40]
			(012) jeq      #0x67            jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # pim
	sctp => {
		DLT => 'RAW',
		aliases => [
			'sctp',
			'proto 132', # not "proto \sctp"
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 5
			(003) ldb      [9]
			(004) jeq      #0x84            jt 13	jf 14
			(005) ldb      [0]
			(006) and      #0xf0
			(007) jeq      #0x60            jt 8	jf 14
			(008) ldb      [6]
			(009) jeq      #0x84            jt 13	jf 10
			(010) jeq      #0x2c            jt 11	jf 14
			(011) ldb      [40]
			(012) jeq      #0x84            jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # sctp
	tcp => {
		DLT => 'RAW',
		aliases => [
			'tcp',
			'proto 6', # not "proto \tcp"
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 5
			(003) ldb      [9]
			(004) jeq      #0x6             jt 13	jf 14
			(005) ldb      [0]
			(006) and      #0xf0
			(007) jeq      #0x60            jt 8	jf 14
			(008) ldb      [6]
			(009) jeq      #0x6             jt 13	jf 10
			(010) jeq      #0x2c            jt 11	jf 14
			(011) ldb      [40]
			(012) jeq      #0x6             jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # tcp
	udp => {
		DLT => 'RAW',
		aliases => [
			'udp',
			'proto 17', # not "proto \udp"
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x40            jt 3	jf 5
			(003) ldb      [9]
			(004) jeq      #0x11            jt 13	jf 14
			(005) ldb      [0]
			(006) and      #0xf0
			(007) jeq      #0x60            jt 8	jf 14
			(008) ldb      [6]
			(009) jeq      #0x11            jt 13	jf 10
			(010) jeq      #0x2c            jt 11	jf 14
			(011) ldb      [40]
			(012) jeq      #0x11            jt 13	jf 14
			(013) ret      #262144
			(014) ret      #0
			',
	}, # udp

	ip6_host_addr => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		aliases => [
			'ip6 host ::1',
			'ip6 src or dst host ::1',
			'ip6 src or dst ::1',
			'host ::1',
			'src or dst host ::1',
			'src or dst ::1',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 20
			(003) ld       [8]
			(004) jeq      #0x0             jt 5	jf 11
			(005) ld       [12]
			(006) jeq      #0x0             jt 7	jf 11
			(007) ld       [16]
			(008) jeq      #0x0             jt 9	jf 11
			(009) ld       [20]
			(010) jeq      #0x1             jt 19	jf 11
			(011) ld       [24]
			(012) jeq      #0x0             jt 13	jf 20
			(013) ld       [28]
			(014) jeq      #0x0             jt 15	jf 20
			(015) ld       [32]
			(016) jeq      #0x0             jt 17	jf 20
			(017) ld       [36]
			(018) jeq      #0x1             jt 19	jf 20
			(019) ret      #262144
			(020) ret      #0
			',
	}, # ip6_host_addr
	ip6_host_name => {
		skip => skip_config_undef ('INET6') || skip_no_hosts(),
		DLT => 'RAW',
		aliases => [
			'ip6 host noeth-noipv4-ipv6.host123.libpcap.test',
			'ip6 host noeth-ipv4-ipv6.host123.libpcap.test',
			'ip6 src or dst noeth-noipv4-ipv6.host123.libpcap.test',
			'ip6 src or dst noeth-ipv4-ipv6.host123.libpcap.test',
			'ip6 src or dst host noeth-noipv4-ipv6.host123.libpcap.test',
			'ip6 src or dst host noeth-ipv4-ipv6.host123.libpcap.test',
			'host noeth-noipv4-ipv6.host123.libpcap.test',
			'src or dst host noeth-noipv4-ipv6.host123.libpcap.test',
			'src or dst noeth-noipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 20
			(003) ld       [8]
			(004) jeq      #0xfd00a1b2      jt 5	jf 11
			(005) ld       [12]
			(006) jeq      #0xc3d40000      jt 7	jf 11
			(007) ld       [16]
			(008) jeq      #0x10203040      jt 9	jf 11
			(009) ld       [20]
			(010) jeq      #0x50607080      jt 19	jf 11
			(011) ld       [24]
			(012) jeq      #0xfd00a1b2      jt 13	jf 20
			(013) ld       [28]
			(014) jeq      #0xc3d40000      jt 15	jf 20
			(015) ld       [32]
			(016) jeq      #0x10203040      jt 17	jf 20
			(017) ld       [36]
			(018) jeq      #0x50607080      jt 19	jf 20
			(019) ret      #262144
			(020) ret      #0
			',
	}, # ip6_host_name
	ip6_host_NAME => {
		skip => skip_config_undef ('INET6') || skip_no_hosts_casecmp(),
		DLT => 'RAW',
		aliases => [
			'ip6 host NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 host NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 src or dst NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 src or dst NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 src or dst host NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 src or dst host NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'host NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'src or dst host NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'src or dst NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 20
			(003) ld       [8]
			(004) jeq      #0xfd00a1b2      jt 5	jf 11
			(005) ld       [12]
			(006) jeq      #0xc3d40000      jt 7	jf 11
			(007) ld       [16]
			(008) jeq      #0x10203040      jt 9	jf 11
			(009) ld       [20]
			(010) jeq      #0x50607080      jt 19	jf 11
			(011) ld       [24]
			(012) jeq      #0xfd00a1b2      jt 13	jf 20
			(013) ld       [28]
			(014) jeq      #0xc3d40000      jt 15	jf 20
			(015) ld       [32]
			(016) jeq      #0x10203040      jt 17	jf 20
			(017) ld       [36]
			(018) jeq      #0x50607080      jt 19	jf 20
			(019) ret      #262144
			(020) ret      #0
			',
	}, # ip6_host_NAME
	ip6_src_host_addr => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		aliases => [
			'ip6 src host fe80::1122:33ff:fe44:5566',
			'ip6 src fe80::1122:33ff:fe44:5566',
			'src host fe80::1122:33ff:fe44:5566',
			'src fe80::1122:33ff:fe44:5566',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 12
			(003) ld       [8]
			(004) jeq      #0xfe800000      jt 5	jf 12
			(005) ld       [12]
			(006) jeq      #0x0             jt 7	jf 12
			(007) ld       [16]
			(008) jeq      #0x112233ff      jt 9	jf 12
			(009) ld       [20]
			(010) jeq      #0xfe445566      jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # ip6_src_host_addr
	ip6_src_host_name => {
		skip => skip_config_undef ('INET6') || skip_no_hosts(),
		DLT => 'RAW',
		aliases => [
			'ip6 src host noeth-noipv4-ipv6.host123.libpcap.test',
			'ip6 src host noeth-ipv4-ipv6.host123.libpcap.test',
			'ip6 src noeth-noipv4-ipv6.host123.libpcap.test',
			'ip6 src noeth-ipv4-ipv6.host123.libpcap.test',
			'src host noeth-noipv4-ipv6.host123.libpcap.test',
			'src noeth-noipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 12
			(003) ld       [8]
			(004) jeq      #0xfd00a1b2      jt 5	jf 12
			(005) ld       [12]
			(006) jeq      #0xc3d40000      jt 7	jf 12
			(007) ld       [16]
			(008) jeq      #0x10203040      jt 9	jf 12
			(009) ld       [20]
			(010) jeq      #0x50607080      jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # ip6_src_host_name
	ip6_src_host_NAME => {
		skip => skip_config_undef ('INET6') || skip_no_hosts_casecmp(),
		DLT => 'RAW',
		aliases => [
			'ip6 src host NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 src host NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 src NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 src NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'src host NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'src NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 12
			(003) ld       [8]
			(004) jeq      #0xfd00a1b2      jt 5	jf 12
			(005) ld       [12]
			(006) jeq      #0xc3d40000      jt 7	jf 12
			(007) ld       [16]
			(008) jeq      #0x10203040      jt 9	jf 12
			(009) ld       [20]
			(010) jeq      #0x50607080      jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # ip6_src_host_NAME
	ip6_dst_host_addr => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		aliases => [
			'ip6 dst host fe80::7788:99ff:feaa:bbcc',
			'ip6 dst fe80::7788:99ff:feaa:bbcc',
			'dst host fe80::7788:99ff:feaa:bbcc',
			'dst fe80::7788:99ff:feaa:bbcc',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 12
			(003) ld       [24]
			(004) jeq      #0xfe800000      jt 5	jf 12
			(005) ld       [28]
			(006) jeq      #0x0             jt 7	jf 12
			(007) ld       [32]
			(008) jeq      #0x778899ff      jt 9	jf 12
			(009) ld       [36]
			(010) jeq      #0xfeaabbcc      jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # ip6_dst_host_addr
	ip6_dst_host_name => {
		skip => skip_config_undef ('INET6') || skip_no_hosts(),
		DLT => 'RAW',
		aliases => [
			'ip6 dst host noeth-noipv4-ipv6.host123.libpcap.test',
			'ip6 dst host noeth-ipv4-ipv6.host123.libpcap.test',
			'ip6 dst noeth-noipv4-ipv6.host123.libpcap.test',
			'ip6 dst noeth-ipv4-ipv6.host123.libpcap.test',
			'dst host noeth-noipv4-ipv6.host123.libpcap.test',
			'dst noeth-noipv4-ipv6.host123.libpcap.test',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 12
			(003) ld       [24]
			(004) jeq      #0xfd00a1b2      jt 5	jf 12
			(005) ld       [28]
			(006) jeq      #0xc3d40000      jt 7	jf 12
			(007) ld       [32]
			(008) jeq      #0x10203040      jt 9	jf 12
			(009) ld       [36]
			(010) jeq      #0x50607080      jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # ip6_dst_host_name
	ip6_dst_host_NAME => {
		skip => skip_config_undef ('INET6') || skip_no_hosts_casecmp(),
		DLT => 'RAW',
		aliases => [
			'ip6 dst host NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 dst host NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 dst NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'ip6 dst NOETH-IPV4-IPV6.HOST123.LIBPCAP.TEST',
			'dst host NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
			'dst NOETH-NOIPV4-IPV6.HOST123.LIBPCAP.TEST',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 12
			(003) ld       [24]
			(004) jeq      #0xfd00a1b2      jt 5	jf 12
			(005) ld       [28]
			(006) jeq      #0xc3d40000      jt 7	jf 12
			(007) ld       [32]
			(008) jeq      #0x10203040      jt 9	jf 12
			(009) ld       [36]
			(010) jeq      #0x50607080      jt 11	jf 12
			(011) ret      #262144
			(012) ret      #0
			',
	}, # ip6_dst_host_NAME
	ip6_net => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		aliases => [
			'ip6 net fe80::/10',
			'net fe80::/10',
			'src or dst net fe80::/10',
			'ip6 src or dst net fe80::/10',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 10
			(003) ld       [8]
			(004) and      #0xffc00000
			(005) jeq      #0xfe800000      jt 9	jf 6
			(006) ld       [24]
			(007) and      #0xffc00000
			(008) jeq      #0xfe800000      jt 9	jf 10
			(009) ret      #262144
			(010) ret      #0
			',
	}, # ip6_net
	ip6_src_net => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		aliases => [
			'ip6 src net 2000::/3',
			'src net 2000::/3',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 7
			(003) ld       [8]
			(004) and      #0xe0000000
			(005) jeq      #0x20000000      jt 6	jf 7
			(006) ret      #262144
			(007) ret      #0
			',
	}, # ip6_src_net
	ip6_dst_net => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		aliases => [
			'ip6 dst net ff00::/8',
			'dst net ff00::/8',
		],
		opt => '
			(000) ldb      [0]
			(001) and      #0xf0
			(002) jeq      #0x60            jt 3	jf 7
			(003) ld       [24]
			(004) and      #0xff000000
			(005) jeq      #0xff000000      jt 6	jf 7
			(006) ret      #262144
			(007) ret      #0
			',
	}, # ip6_net
	ip6_multicast => {
		DLT => 'IPV6',
		aliases => ['ip6 multicast'],
		unopt => '
			(000) ld       #0x0
			(001) jeq      #0x0             jt 2	jf 5
			(002) ldb      [24]
			(003) jeq      #0xff            jt 4	jf 5
			(004) ret      #262144
			(005) ret      #0
			',
	}, # ip6_multicast

	icmp_types => {
		DLT => 'EN10MB',
		aliases => ['
			0 == icmp-echoreply &&
			3 == icmp-unreach &&
			4 == icmp-sourcequench &&
			5 == icmp-redirect &&
			8 == icmp-echo &&
			9 == icmp-routeradvert &&
			10 == icmp-routersolicit &&
			11 == icmp-timxceed &&
			12 == icmp-paramprob &&
			13 == icmp-tstamp &&
			14 == icmp-tstampreply &&
			15 == icmp-ireq &&
			16 == icmp-ireqreply &&
			17 == icmp-maskreq &&
			18 == icmp-maskreply
		'],
		opt => '
			(000) ret      #262144
			',
	}, # icmp_types
	icmp6_types => {
		DLT => 'IPV6',
		aliases => ['
			1 == icmp6-destinationunreach &&
			2 == icmp6-packettoobig &&
			3 == icmp6-timeexceeded &&
			4 == icmp6-parameterproblem &&
			128 == icmp6-echo &&
			129 == icmp6-echoreply &&
			130 == icmp6-multicastlistenerquery &&
			131 == icmp6-multicastlistenerreportv1 &&
			132 == icmp6-multicastlistenerdone &&
			133 == icmp6-routersolicit &&
			134 == icmp6-routeradvert &&
			135 == icmp6-neighborsolicit &&
			136 == icmp6-neighboradvert &&
			137 == icmp6-redirect &&
			138 == icmp6-routerrenum &&
			139 == icmp6-nodeinformationquery &&
			140 == icmp6-nodeinformationresponse &&
			141 == icmp6-ineighbordiscoverysolicit &&
			142 == icmp6-ineighbordiscoveryadvert &&
			143 == icmp6-multicastlistenerreportv2 &&
			144 == icmp6-homeagentdiscoveryrequest &&
			145 == icmp6-homeagentdiscoveryreply &&
			146 == icmp6-mobileprefixsolicit &&
			147 == icmp6-mobileprefixadvert &&
			148 == icmp6-certpathsolicit &&
			149 == icmp6-certpathadvert &&
			151 == icmp6-multicastrouteradvert &&
			152 == icmp6-multicastroutersolicit &&
			153 == icmp6-multicastrouterterm
		'],
		opt => '
			(000) ret      #262144
			',
	}, # icmp6_types

	tcp_flags => {
		DLT => 'EN10MB',
		aliases => ['
			0x01 == tcp-fin &&
			0x02 == tcp-syn &&
			0x04 == tcp-rst &&
			0x08 == tcp-push &&
			0x10 == tcp-ack &&
			0x20 == tcp-urg &&
			0x40 == tcp-ece &&
			0x80 == tcp-cwr
		'],
		opt => '
			(000) ret      #262144
			',
	}, # tcp_flags

	named_offsets => {
		DLT => 'EN10MB',
		aliases => ['
			icmptype == 0 &&
			icmpcode == 1 &&
			icmp6type == 0 &&
			icmp6code == 1 &&
			tcpflags == 13
		'],
		opt => '
			(000) ret      #262144
			',
	}, # offsets

	# In the tests below "smtp" depends on getaddrinfo().
	tcp_port => {
		DLT => 'EN10MB',
		aliases => [
			'tcp port 25',
			'tcp port smtp',
			'tcp src or dst port 25',
			'tcp src or dst port smtp',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 19
			(004) ldh      [54]
			(005) jeq      #0x19            jt 18	jf 6
			(006) ldh      [56]
			(007) jeq      #0x19            jt 18	jf 19
			(008) jeq      #0x800           jt 9	jf 19
			(009) ldb      [23]
			(010) jeq      #0x6             jt 11	jf 19
			(011) ldh      [20]
			(012) jset     #0x1fff          jt 19	jf 13
			(013) ldxb     4*([14]&0xf)
			(014) ldh      [x + 14]
			(015) jeq      #0x19            jt 18	jf 16
			(016) ldh      [x + 16]
			(017) jeq      #0x19            jt 18	jf 19
			(018) ret      #262144
			(019) ret      #0
			',
	}, # tcp_port
	tcp_src_port => {
		DLT => 'EN10MB',
		aliases => [
			'tcp src port 25',
			'tcp src port smtp',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 15
			(004) ldh      [54]
			(005) jeq      #0x19            jt 14	jf 15
			(006) jeq      #0x800           jt 7	jf 15
			(007) ldb      [23]
			(008) jeq      #0x6             jt 9	jf 15
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 15	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jeq      #0x19            jt 14	jf 15
			(014) ret      #262144
			(015) ret      #0
			',
	}, # tcp_src_port
	tcp_dst_port => {
		DLT => 'EN10MB',
		aliases => [
			'tcp dst port 25',
			'tcp dst port smtp',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 15
			(004) ldh      [56]
			(005) jeq      #0x19            jt 14	jf 15
			(006) jeq      #0x800           jt 7	jf 15
			(007) ldb      [23]
			(008) jeq      #0x6             jt 9	jf 15
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 15	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jeq      #0x19            jt 14	jf 15
			(014) ret      #262144
			(015) ret      #0
			',
	}, # tcp_dst_port
	tcp_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'tcp portrange 25-53',
			'tcp portrange 25-domain',
			'tcp portrange smtp-53',
			'tcp portrange smtp-domain',
			'tcp portrange 53-25',
			'tcp portrange domain-25',
			'tcp portrange 53-smtp',
			'tcp portrange domain-smtp',
			'tcp src or dst portrange 25-53',
			'tcp src or dst portrange 25-domain',
			'tcp src or dst portrange smtp-53',
			'tcp src or dst portrange smtp-domain',
			'tcp src or dst portrange 53-25',
			'tcp src or dst portrange domain-25',
			'tcp src or dst portrange 53-smtp',
			'tcp src or dst portrange domain-smtp',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 9
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 22
			(004) ldh      [54]
			(005) jge      #0x19            jt 6	jf 7
			(006) jgt      #0x35            jt 7	jf 21
			(007) ldh      [56]
			(008) jge      #0x19            jt 20	jf 22
			(009) jeq      #0x800           jt 10	jf 22
			(010) ldb      [23]
			(011) jeq      #0x6             jt 12	jf 22
			(012) ldh      [20]
			(013) jset     #0x1fff          jt 22	jf 14
			(014) ldxb     4*([14]&0xf)
			(015) ldh      [x + 14]
			(016) jge      #0x19            jt 17	jf 18
			(017) jgt      #0x35            jt 18	jf 21
			(018) ldh      [x + 16]
			(019) jge      #0x19            jt 20	jf 22
			(020) jgt      #0x35            jt 22	jf 21
			(021) ret      #262144
			(022) ret      #0
			',
	}, # tcp_portrange
	tcp_src_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'tcp src portrange 25-53',
			'tcp src portrange 25-domain',
			'tcp src portrange smtp-53',
			'tcp src portrange smtp-domain',
			'tcp src portrange 53-25',
			'tcp src portrange domain-25',
			'tcp src portrange 53-smtp',
			'tcp src portrange domain-smtp',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 16
			(004) ldh      [54]
			(005) jge      #0x19            jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x6             jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jge      #0x19            jt 14	jf 16
			(014) jgt      #0x35            jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # tcp_src_portrange
	tcp_dst_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'tcp dst portrange 25-53',
			'tcp dst portrange 25-domain',
			'tcp dst portrange smtp-53',
			'tcp dst portrange smtp-domain',
			'tcp dst portrange 53-25',
			'tcp dst portrange domain-25',
			'tcp dst portrange 53-smtp',
			'tcp dst portrange domain-smtp',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 16
			(004) ldh      [56]
			(005) jge      #0x19            jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x6             jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jge      #0x19            jt 14	jf 16
			(014) jgt      #0x35            jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # tcp_dst_portrange
	tcp_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'tcp portrange 25-25',
			'tcp portrange 25-smtp',
			'tcp portrange smtp-25',
			'tcp portrange smtp-smtp',
			'tcp portrange 25',
			# "25" is a valid port range, but "smtp" is not.
			'tcp src or dst portrange 25-25',
			'tcp src or dst portrange 25-smtp',
			'tcp src or dst portrange smtp-25',
			'tcp src or dst portrange smtp-smtp',
			'tcp src or dst portrange 25',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 9
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 22
			(004) ldh      [54]
			(005) jge      #0x19            jt 6	jf 7
			(006) jgt      #0x19            jt 7	jf 21
			(007) ldh      [56]
			(008) jge      #0x19            jt 20	jf 22
			(009) jeq      #0x800           jt 10	jf 22
			(010) ldb      [23]
			(011) jeq      #0x6             jt 12	jf 22
			(012) ldh      [20]
			(013) jset     #0x1fff          jt 22	jf 14
			(014) ldxb     4*([14]&0xf)
			(015) ldh      [x + 14]
			(016) jge      #0x19            jt 17	jf 18
			(017) jgt      #0x19            jt 18	jf 21
			(018) ldh      [x + 16]
			(019) jge      #0x19            jt 20	jf 22
			(020) jgt      #0x19            jt 22	jf 21
			(021) ret      #262144
			(022) ret      #0
			',
	}, # tcp_portrange_degenerate
	tcp_src_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'tcp src portrange 25-25',
			'tcp src portrange 25-smtp',
			'tcp src portrange smtp-25',
			'tcp src portrange smtp-smtp',
			'tcp src portrange 25',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 16
			(004) ldh      [54]
			(005) jge      #0x19            jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x6             jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jge      #0x19            jt 14	jf 16
			(014) jgt      #0x19            jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # tcp_src_portrange_degenerate
	tcp_dst_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'tcp dst portrange 25-25',
			'tcp dst portrange 25-smtp',
			'tcp dst portrange smtp-25',
			'tcp dst portrange smtp-smtp',
			'tcp dst portrange 25',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x6             jt 4	jf 16
			(004) ldh      [56]
			(005) jge      #0x19            jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x6             jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jge      #0x19            jt 14	jf 16
			(014) jgt      #0x19            jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # tcp_dst_portrange_degenerate
	# In the tests below "domain" depends on getaddrinfo().
	udp_port => {
		DLT => 'EN10MB',
		aliases => [
			'udp port 53',
			'udp port domain',
			'udp src or dst port 53',
			'udp src or dst port domain',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 19
			(004) ldh      [54]
			(005) jeq      #0x35            jt 18	jf 6
			(006) ldh      [56]
			(007) jeq      #0x35            jt 18	jf 19
			(008) jeq      #0x800           jt 9	jf 19
			(009) ldb      [23]
			(010) jeq      #0x11            jt 11	jf 19
			(011) ldh      [20]
			(012) jset     #0x1fff          jt 19	jf 13
			(013) ldxb     4*([14]&0xf)
			(014) ldh      [x + 14]
			(015) jeq      #0x35            jt 18	jf 16
			(016) ldh      [x + 16]
			(017) jeq      #0x35            jt 18	jf 19
			(018) ret      #262144
			(019) ret      #0
			',
	}, # udp_port
	udp_src_port => {
		DLT => 'EN10MB',
		aliases => [
			'udp src port 53',
			'udp src port domain',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 15
			(004) ldh      [54]
			(005) jeq      #0x35            jt 14	jf 15
			(006) jeq      #0x800           jt 7	jf 15
			(007) ldb      [23]
			(008) jeq      #0x11            jt 9	jf 15
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 15	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jeq      #0x35            jt 14	jf 15
			(014) ret      #262144
			(015) ret      #0
			',
	}, # udp_src_port
	udp_dst_port => {
		DLT => 'EN10MB',
		aliases => [
			'udp dst port 53',
			'udp dst port domain',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 15
			(004) ldh      [56]
			(005) jeq      #0x35            jt 14	jf 15
			(006) jeq      #0x800           jt 7	jf 15
			(007) ldb      [23]
			(008) jeq      #0x11            jt 9	jf 15
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 15	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jeq      #0x35            jt 14	jf 15
			(014) ret      #262144
			(015) ret      #0
			',
	}, # udp_dst_port
	udp_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'udp portrange 67-68',
			'udp portrange 67-bootpc',
			'udp portrange bootps-68',
			'udp portrange bootps-bootpc',
			'udp portrange 68-67',
			'udp portrange bootpc-67',
			'udp portrange 68-bootps',
			'udp portrange bootpc-bootps',
			'udp src or dst portrange 67-68',
			'udp src or dst portrange 67-bootpc',
			'udp src or dst portrange bootps-68',
			'udp src or dst portrange bootps-bootpc',
			'udp src or dst portrange 68-67',
			'udp src or dst portrange bootpc-67',
			'udp src or dst portrange 68-bootps',
			'udp src or dst portrange bootpc-bootps',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 9
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 22
			(004) ldh      [54]
			(005) jge      #0x43            jt 6	jf 7
			(006) jgt      #0x44            jt 7	jf 21
			(007) ldh      [56]
			(008) jge      #0x43            jt 20	jf 22
			(009) jeq      #0x800           jt 10	jf 22
			(010) ldb      [23]
			(011) jeq      #0x11            jt 12	jf 22
			(012) ldh      [20]
			(013) jset     #0x1fff          jt 22	jf 14
			(014) ldxb     4*([14]&0xf)
			(015) ldh      [x + 14]
			(016) jge      #0x43            jt 17	jf 18
			(017) jgt      #0x44            jt 18	jf 21
			(018) ldh      [x + 16]
			(019) jge      #0x43            jt 20	jf 22
			(020) jgt      #0x44            jt 22	jf 21
			(021) ret      #262144
			(022) ret      #0
			',
	}, # udp_portrange
	udp_src_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'udp src portrange 67-68',
			'udp src portrange 67-bootpc',
			'udp src portrange bootps-68',
			'udp src portrange bootps-bootpc',
			'udp src portrange 68-67',
			'udp src portrange bootpc-67',
			'udp src portrange 68-bootps',
			'udp src portrange bootpc-bootps',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 16
			(004) ldh      [54]
			(005) jge      #0x43            jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x11            jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jge      #0x43            jt 14	jf 16
			(014) jgt      #0x44            jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # udp_src_portrange
	udp_dst_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'udp dst portrange 67-68',
			'udp dst portrange 67-bootpc',
			'udp dst portrange bootps-68',
			'udp dst portrange bootps-bootpc',
			'udp dst portrange 68-67',
			'udp dst portrange bootpc-67',
			'udp dst portrange 68-bootps',
			'udp dst portrange bootpc-bootps',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 16
			(004) ldh      [56]
			(005) jge      #0x43            jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x11            jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jge      #0x43            jt 14	jf 16
			(014) jgt      #0x44            jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # udp_dst_portrange
	udp_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'udp portrange 53-53',
			'udp portrange 53-domain',
			'udp portrange domain-53',
			'udp portrange domain-domain',
			'udp portrange 53',
			# "53" is a valid port range, but "domain" is not.
			'udp src or dst portrange 53-53',
			'udp src or dst portrange 53-domain',
			'udp src or dst portrange domain-53',
			'udp src or dst portrange domain-domain',
			'udp src or dst portrange 53',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 9
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 22
			(004) ldh      [54]
			(005) jge      #0x35            jt 6	jf 7
			(006) jgt      #0x35            jt 7	jf 21
			(007) ldh      [56]
			(008) jge      #0x35            jt 20	jf 22
			(009) jeq      #0x800           jt 10	jf 22
			(010) ldb      [23]
			(011) jeq      #0x11            jt 12	jf 22
			(012) ldh      [20]
			(013) jset     #0x1fff          jt 22	jf 14
			(014) ldxb     4*([14]&0xf)
			(015) ldh      [x + 14]
			(016) jge      #0x35            jt 17	jf 18
			(017) jgt      #0x35            jt 18	jf 21
			(018) ldh      [x + 16]
			(019) jge      #0x35            jt 20	jf 22
			(020) jgt      #0x35            jt 22	jf 21
			(021) ret      #262144
			(022) ret      #0
			',
	}, # udp_portrange_degenerate
	udp_src_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'udp src portrange 53-53',
			'udp src portrange 53-domain',
			'udp src portrange domain-53',
			'udp src portrange domain-domain',
			'udp src portrange 53',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 16
			(004) ldh      [54]
			(005) jge      #0x35            jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x11            jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jge      #0x35            jt 14	jf 16
			(014) jgt      #0x35            jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # udp_src_portrange_degenerate
	udp_dst_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'udp dst portrange 53-53',
			'udp dst portrange 53-domain',
			'udp dst portrange domain-53',
			'udp dst portrange domain-domain',
			'udp dst portrange 53',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x11            jt 4	jf 16
			(004) ldh      [56]
			(005) jge      #0x35            jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x11            jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jge      #0x35            jt 14	jf 16
			(014) jgt      #0x35            jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # udp_dst_portrange_degenerate
	# SCTP tests below do not use service names because the translation is
	# currently broken and may not have a suitable /etc/services contents
	# in all supported environments after the bug fix.
	sctp_port => {
		DLT => 'EN10MB',
		aliases => [
			'sctp port 5672',
			'sctp src or dst port 5672',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 19
			(004) ldh      [54]
			(005) jeq      #0x1628          jt 18	jf 6
			(006) ldh      [56]
			(007) jeq      #0x1628          jt 18	jf 19
			(008) jeq      #0x800           jt 9	jf 19
			(009) ldb      [23]
			(010) jeq      #0x84            jt 11	jf 19
			(011) ldh      [20]
			(012) jset     #0x1fff          jt 19	jf 13
			(013) ldxb     4*([14]&0xf)
			(014) ldh      [x + 14]
			(015) jeq      #0x1628          jt 18	jf 16
			(016) ldh      [x + 16]
			(017) jeq      #0x1628          jt 18	jf 19
			(018) ret      #262144
			(019) ret      #0
			',
	}, # sctp_port
	sctp_src_port => {
		DLT => 'EN10MB',
		aliases => ['sctp src port 5672'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 15
			(004) ldh      [54]
			(005) jeq      #0x1628          jt 14	jf 15
			(006) jeq      #0x800           jt 7	jf 15
			(007) ldb      [23]
			(008) jeq      #0x84            jt 9	jf 15
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 15	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jeq      #0x1628          jt 14	jf 15
			(014) ret      #262144
			(015) ret      #0
			',
	}, # sctp_src_port
	sctp_dst_port => {
		DLT => 'EN10MB',
		aliases => ['sctp dst port 5672'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 15
			(004) ldh      [56]
			(005) jeq      #0x1628          jt 14	jf 15
			(006) jeq      #0x800           jt 7	jf 15
			(007) ldb      [23]
			(008) jeq      #0x84            jt 9	jf 15
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 15	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jeq      #0x1628          jt 14	jf 15
			(014) ret      #262144
			(015) ret      #0
			',
	}, # sctp_dst_port
	sctp_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'sctp portrange 1-1023',
			'sctp portrange 1023-1',
			'sctp src or dst portrange 1-1023',
			'sctp src or dst portrange 1023-1',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 9
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 22
			(004) ldh      [54]
			(005) jge      #0x1             jt 6	jf 7
			(006) jgt      #0x3ff           jt 7	jf 21
			(007) ldh      [56]
			(008) jge      #0x1             jt 20	jf 22
			(009) jeq      #0x800           jt 10	jf 22
			(010) ldb      [23]
			(011) jeq      #0x84            jt 12	jf 22
			(012) ldh      [20]
			(013) jset     #0x1fff          jt 22	jf 14
			(014) ldxb     4*([14]&0xf)
			(015) ldh      [x + 14]
			(016) jge      #0x1             jt 17	jf 18
			(017) jgt      #0x3ff           jt 18	jf 21
			(018) ldh      [x + 16]
			(019) jge      #0x1             jt 20	jf 22
			(020) jgt      #0x3ff           jt 22	jf 21
			(021) ret      #262144
			(022) ret      #0
			',
	}, # sctp_portrange
	sctp_src_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'sctp src portrange 1-1023',
			'sctp src portrange 1023-1',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 16
			(004) ldh      [54]
			(005) jge      #0x1             jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x84            jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jge      #0x1             jt 14	jf 16
			(014) jgt      #0x3ff           jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # sctp_src_portrange
	sctp_dst_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'sctp dst portrange 1-1023',
			'sctp dst portrange 1023-1',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 16
			(004) ldh      [56]
			(005) jge      #0x1             jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x84            jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jge      #0x1             jt 14	jf 16
			(014) jgt      #0x3ff           jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # sctp_dst_portrange
	sctp_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'sctp portrange 5672-5672',
			'sctp portrange 5672',
			'sctp src or dst portrange 5672-5672',
			'sctp src or dst portrange 5672',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 9
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 22
			(004) ldh      [54]
			(005) jge      #0x1628          jt 6	jf 7
			(006) jgt      #0x1628          jt 7	jf 21
			(007) ldh      [56]
			(008) jge      #0x1628          jt 20	jf 22
			(009) jeq      #0x800           jt 10	jf 22
			(010) ldb      [23]
			(011) jeq      #0x84            jt 12	jf 22
			(012) ldh      [20]
			(013) jset     #0x1fff          jt 22	jf 14
			(014) ldxb     4*([14]&0xf)
			(015) ldh      [x + 14]
			(016) jge      #0x1628          jt 17	jf 18
			(017) jgt      #0x1628          jt 18	jf 21
			(018) ldh      [x + 16]
			(019) jge      #0x1628          jt 20	jf 22
			(020) jgt      #0x1628          jt 22	jf 21
			(021) ret      #262144
			(022) ret      #0
			',
	}, # sctp_portrange_degenerate
	sctp_src_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'sctp src portrange 5672-5672',
			'sctp src portrange 5672',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 16
			(004) ldh      [54]
			(005) jge      #0x1628          jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x84            jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 14]
			(013) jge      #0x1628          jt 14	jf 16
			(014) jgt      #0x1628          jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # sctp_src_portrange_degenerate
	sctp_dst_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'sctp dst portrange 5672-5672',
			'sctp dst portrange 5672',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 6
			(002) ldb      [20]
			(003) jeq      #0x84            jt 4	jf 16
			(004) ldh      [56]
			(005) jge      #0x1628          jt 14	jf 16
			(006) jeq      #0x800           jt 7	jf 16
			(007) ldb      [23]
			(008) jeq      #0x84            jt 9	jf 16
			(009) ldh      [20]
			(010) jset     #0x1fff          jt 16	jf 11
			(011) ldxb     4*([14]&0xf)
			(012) ldh      [x + 16]
			(013) jge      #0x1628          jt 14	jf 16
			(014) jgt      #0x1628          jt 16	jf 15
			(015) ret      #262144
			(016) ret      #0
			',
	}, # sctp_dst_portrange_degenerate
	port => {
		DLT => 'EN10MB',
		aliases => [
			'port 7',
			'src or dst port 7',
			# Do not try a service name due to SCTP.
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 10
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 23
			(006) ldh      [54]
			(007) jeq      #0x7             jt 22	jf 8
			(008) ldh      [56]
			(009) jeq      #0x7             jt 22	jf 23
			(010) jeq      #0x800           jt 11	jf 23
			(011) ldb      [23]
			(012) jeq      #0x84            jt 15	jf 13
			(013) jeq      #0x6             jt 15	jf 14
			(014) jeq      #0x11            jt 15	jf 23
			(015) ldh      [20]
			(016) jset     #0x1fff          jt 23	jf 17
			(017) ldxb     4*([14]&0xf)
			(018) ldh      [x + 14]
			(019) jeq      #0x7             jt 22	jf 20
			(020) ldh      [x + 16]
			(021) jeq      #0x7             jt 22	jf 23
			(022) ret      #262144
			(023) ret      #0
			',
	}, # port
	src_port => {
		DLT => 'EN10MB',
		aliases => ['src port 7'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 19
			(006) ldh      [54]
			(007) jeq      #0x7             jt 18	jf 19
			(008) jeq      #0x800           jt 9	jf 19
			(009) ldb      [23]
			(010) jeq      #0x84            jt 13	jf 11
			(011) jeq      #0x6             jt 13	jf 12
			(012) jeq      #0x11            jt 13	jf 19
			(013) ldh      [20]
			(014) jset     #0x1fff          jt 19	jf 15
			(015) ldxb     4*([14]&0xf)
			(016) ldh      [x + 14]
			(017) jeq      #0x7             jt 18	jf 19
			(018) ret      #262144
			(019) ret      #0
			',
	}, # src_port
	dst_port => {
		DLT => 'EN10MB',
		aliases => ['dst port 7'],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 19
			(006) ldh      [56]
			(007) jeq      #0x7             jt 18	jf 19
			(008) jeq      #0x800           jt 9	jf 19
			(009) ldb      [23]
			(010) jeq      #0x84            jt 13	jf 11
			(011) jeq      #0x6             jt 13	jf 12
			(012) jeq      #0x11            jt 13	jf 19
			(013) ldh      [20]
			(014) jset     #0x1fff          jt 19	jf 15
			(015) ldxb     4*([14]&0xf)
			(016) ldh      [x + 16]
			(017) jeq      #0x7             jt 18	jf 19
			(018) ret      #262144
			(019) ret      #0
			',
	}, # dst_port
	portrange => {
		DLT => 'EN10MB',
		aliases => [
			'portrange 1-1023',
			'portrange 1023-1',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 11
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 26
			(006) ldh      [54]
			(007) jge      #0x1             jt 8	jf 9
			(008) jgt      #0x3ff           jt 9	jf 25
			(009) ldh      [56]
			(010) jge      #0x1             jt 24	jf 26
			(011) jeq      #0x800           jt 12	jf 26
			(012) ldb      [23]
			(013) jeq      #0x84            jt 16	jf 14
			(014) jeq      #0x6             jt 16	jf 15
			(015) jeq      #0x11            jt 16	jf 26
			(016) ldh      [20]
			(017) jset     #0x1fff          jt 26	jf 18
			(018) ldxb     4*([14]&0xf)
			(019) ldh      [x + 14]
			(020) jge      #0x1             jt 21	jf 22
			(021) jgt      #0x3ff           jt 22	jf 25
			(022) ldh      [x + 16]
			(023) jge      #0x1             jt 24	jf 26
			(024) jgt      #0x3ff           jt 26	jf 25
			(025) ret      #262144
			(026) ret      #0
			',
	}, # portrange
	src_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'src portrange 1-1023',
			'src portrange 1023-1',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 20
			(006) ldh      [54]
			(007) jge      #0x1             jt 18	jf 20
			(008) jeq      #0x800           jt 9	jf 20
			(009) ldb      [23]
			(010) jeq      #0x84            jt 13	jf 11
			(011) jeq      #0x6             jt 13	jf 12
			(012) jeq      #0x11            jt 13	jf 20
			(013) ldh      [20]
			(014) jset     #0x1fff          jt 20	jf 15
			(015) ldxb     4*([14]&0xf)
			(016) ldh      [x + 14]
			(017) jge      #0x1             jt 18	jf 20
			(018) jgt      #0x3ff           jt 20	jf 19
			(019) ret      #262144
			(020) ret      #0
			',
	}, # src_portrange
	dst_portrange => {
		DLT => 'EN10MB',
		aliases => [
			'dst portrange 1-1023',
			'dst portrange 1023-1',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 20
			(006) ldh      [56]
			(007) jge      #0x1             jt 18	jf 20
			(008) jeq      #0x800           jt 9	jf 20
			(009) ldb      [23]
			(010) jeq      #0x84            jt 13	jf 11
			(011) jeq      #0x6             jt 13	jf 12
			(012) jeq      #0x11            jt 13	jf 20
			(013) ldh      [20]
			(014) jset     #0x1fff          jt 20	jf 15
			(015) ldxb     4*([14]&0xf)
			(016) ldh      [x + 16]
			(017) jge      #0x1             jt 18	jf 20
			(018) jgt      #0x3ff           jt 20	jf 19
			(019) ret      #262144
			(020) ret      #0
			',
	}, # dst_portrange
	portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'portrange 1812-1812',
			'portrange 1812',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 11
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 26
			(006) ldh      [54]
			(007) jge      #0x714           jt 8	jf 9
			(008) jgt      #0x714           jt 9	jf 25
			(009) ldh      [56]
			(010) jge      #0x714           jt 24	jf 26
			(011) jeq      #0x800           jt 12	jf 26
			(012) ldb      [23]
			(013) jeq      #0x84            jt 16	jf 14
			(014) jeq      #0x6             jt 16	jf 15
			(015) jeq      #0x11            jt 16	jf 26
			(016) ldh      [20]
			(017) jset     #0x1fff          jt 26	jf 18
			(018) ldxb     4*([14]&0xf)
			(019) ldh      [x + 14]
			(020) jge      #0x714           jt 21	jf 22
			(021) jgt      #0x714           jt 22	jf 25
			(022) ldh      [x + 16]
			(023) jge      #0x714           jt 24	jf 26
			(024) jgt      #0x714           jt 26	jf 25
			(025) ret      #262144
			(026) ret      #0
			',
	}, # portrange_degenerate
	src_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'src portrange 1812-1812',
			'src portrange 1812',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 20
			(006) ldh      [54]
			(007) jge      #0x714           jt 18	jf 20
			(008) jeq      #0x800           jt 9	jf 20
			(009) ldb      [23]
			(010) jeq      #0x84            jt 13	jf 11
			(011) jeq      #0x6             jt 13	jf 12
			(012) jeq      #0x11            jt 13	jf 20
			(013) ldh      [20]
			(014) jset     #0x1fff          jt 20	jf 15
			(015) ldxb     4*([14]&0xf)
			(016) ldh      [x + 14]
			(017) jge      #0x714           jt 18	jf 20
			(018) jgt      #0x714           jt 20	jf 19
			(019) ret      #262144
			(020) ret      #0
			',
	}, # src_portrange_degenerate
	dst_portrange_degenerate => {
		DLT => 'EN10MB',
		aliases => [
			'dst portrange 1812-1812',
			'dst portrange 1812',
		],
		opt => '
			(000) ldh      [12]
			(001) jeq      #0x86dd          jt 2	jf 8
			(002) ldb      [20]
			(003) jeq      #0x84            jt 6	jf 4
			(004) jeq      #0x6             jt 6	jf 5
			(005) jeq      #0x11            jt 6	jf 20
			(006) ldh      [56]
			(007) jge      #0x714           jt 18	jf 20
			(008) jeq      #0x800           jt 9	jf 20
			(009) ldb      [23]
			(010) jeq      #0x84            jt 13	jf 11
			(011) jeq      #0x6             jt 13	jf 12
			(012) jeq      #0x11            jt 13	jf 20
			(013) ldh      [20]
			(014) jset     #0x1fff          jt 20	jf 15
			(015) ldxb     4*([14]&0xf)
			(016) ldh      [x + 16]
			(017) jge      #0x714           jt 18	jf 20
			(018) jgt      #0x714           jt 20	jf 19
			(019) ret      #262144
			(020) ret      #0
			',
	}, # dst_portrange_degenerate
);

# In apply_blocks the top-level keys are test block names.  Each test block
# always generates two tests: optimized and unoptimized.  (Small tests often
# produce short bytecode that is already optimal, in which case testing the
# "optimized" version again is a duplicate work.  However, it is not clear yet
# what would be the right way to avoid the duplicate work without creating
# gaps in the test coverage.)  The top-level values are in turn hashes, where
# the keys have the following meaning:
#
# * expr and netmask: same as in accept_blocks above
# * savefile (mandatory, string): the file in tests/filter/ to use with
#   "filtertest -r", this should not have too many packets
# * results (mandatory, array): the list of program filter results to expect
my %apply_blocks = (
	pppoed_nullary_on_ctp => {
		savefile => 'loopback.pcap',
		expr => 'pppoed',
		results => [0, 0, 0, 0, 0, 0],
	},
	pppoed_nullary_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'pppoed',
		results => [1508],
	},
	pppoed_nullary_on_pppoes => {
		savefile => 'pppoes.pcap',
		expr => 'pppoed',
		results => [0, 0],
	},
	pppoes_nullary_on_ctp => {
		savefile => 'loopback.pcap',
		expr => 'pppoes',
		results => [0, 0, 0, 0, 0, 0],
	},
	pppoes_nullary_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'pppoes',
		results => [0],
	},
	pppoes_nullary_on_pppoes => {
		savefile => 'pppoes.pcap',
		expr => 'pppoes',
		results => [2000, 2000],
	},
	pppoes_unary_on_ctp => {
		savefile => 'loopback.pcap',
		expr => 'pppoes 0x3b',
		results => [0, 0, 0, 0, 0, 0],
	},
	pppoes_unary_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'pppoes 0x3b',
		results => [0],
	},
	pppoes_unary_on_pppoes => {
		savefile => 'pppoes.pcap',
		expr => 'pppoes 0x3b',
		results => [0, 2000],
	},
	decnet_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet',
		results => [0],
	},
	decnet_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet',
		# This tests EtherType, so every packet matches.
		results => [65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535],
	},
	decnet_src_1_1_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet src 1.1',
		results => [0],
	},
	decnet_dst_1_1_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet dst 1.1',
		results => [0],
	},

	# This tests a DECnet address, which in the current implementation works
	# for data packets only.  The first packet is an Ethernet Endnode Hello
	# message, so it does not match even though the packet is from node 1.1.
	decnet_src_1_1_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet src 1.1',
		results => [0, 65535, 65535, 65535, 65535, 65535, 65535, 65535],
	},
	decnet_dst_1_1_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet dst 1.1',
		results => [0, 65535, 65535, 65535, 65535, 65535, 65535, 65535],
	},
	decnet_src_not_1_1_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet src not 1.1',
		results => [65535, 0, 0, 0, 0, 0, 0, 0],
	},
	decnet_dst_not_1_1_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet dst not 1.1',
		results => [65535, 0, 0, 0, 0, 0, 0, 0],
	},

	# The first result is correct from a formal point of view, but the actual
	# reason is the same as above.
	decnet_src_63_1023_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet src 63.1023',
		results => [0, 0, 0, 0, 0, 0, 0, 0],
	},
	decnet_dst_63_1023_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet dst 63.1023',
		results => [0, 0, 0, 0, 0, 0, 0, 0],
	},
	decnet_src_not_63_1023_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet src not 63.1023',
		results => [65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535],
	},
	decnet_dst_not_63_1023_on_decnet => {
		savefile => 'decnet.pcap',
		expr => 'decnet dst not 63.1023',
		results => [65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535],
	},

	# The meaning of this expression is NOT the intuitive "any DECnet packets
	# that do not have the source address set to 1.1", but this is not
	# specific to DECnet.  Let's test it anyway.
	decnet_src_not_1_1_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet src not 1.1',
		results => [1508],
	},
	decnet_dst_not_1_1_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet dst not 1.1',
		results => [1508],
	},
	decnet_src_not_63_1023_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet src not 63.1023',
		results => [1508],
	},
	decnet_dst_not_63_1023_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet dst not 63.1023',
		results => [1508],
	},

	decnet_src_63_1023_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet src 63.1023',
		results => [0],
	},
	decnet_dst_63_1023_on_pppoed => {
		savefile => 'pppoe.pcap',
		expr => 'decnet src 63.1023',
		results => [0],
	},

	dpc_eq_1 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'dpc == 1',
		results => [0, 279, 0, 279, 279, 0, 279, 0, 279, 0],
	},
	dpc_lt_2 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'dpc < 2',
		results => [0, 279, 0, 279, 279, 0, 279, 0, 279, 0],
	},
	dpc_eq_2 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'dpc == 2',
		results => [279, 0, 279, 0, 0, 279, 0, 279, 0, 279],
	},
	dpc_gt_2 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'dpc > 2',
		results => [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
	},
	dpc_le_2 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'dpc <= 2',
		results => [279, 279, 279, 279, 279, 279, 279, 279, 279, 279],
	},
	dpc_ne_0 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'dpc != 0',
		results => [279, 279, 279, 279, 279, 279, 279, 279, 279, 279],
	},
	opc_eq_2 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'opc == 2',
		results => [0, 279, 0, 279, 279, 0, 279, 0, 279, 0],
	},
	opc_ge_2 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'opc >= 2',
		results => [0, 279, 0, 279, 279, 0, 279, 0, 279, 0],
	},
	opc_gt_2 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'opc > 2',
		results => [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
	},
	opc_le_2 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'opc <= 2',
		results => [279, 279, 279, 279, 279, 279, 279, 279, 279, 279],
	},
	opc_ne_0 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'opc != 0',
		results => [279, 279, 279, 279, 279, 279, 279, 279, 279, 279],
	},
	sls_eq_9 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'sls == 9',
		results => [279, 279, 279, 279, 279, 279, 279, 279, 279, 279],
	},
	sls_ne_9 => {
		savefile => 'isup_load_generator.pcap',
		expr => 'sls != 9',
		results => [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
	},
	link_host_c0_on_arcnet => {
		savefile => 'bacnet-arcnet-linux.pcap',
		expr => 'link host $c0',
		results => [65535, 65535, 0, 65535, 65535, 65535, 65535, 65535, 65535, 0],
	},
	link_src_host_c0_on_arcnet => {
		savefile => 'bacnet-arcnet-linux.pcap',
		expr => 'link src host $c0',
		results => [65535, 65535, 0, 65535, 0, 65535, 0, 65535, 0, 0],
	},
	link_dst_host_c0_on_arcnet => {
		savefile => 'bacnet-arcnet-linux.pcap',
		expr => 'link dst host $c0',
		results => [0, 0, 0, 0, 65535, 0, 65535, 0, 65535, 0],
	},
	link_host_not_c0_on_arcnet => {
		savefile => 'bacnet-arcnet-linux.pcap',
		expr => 'link host not $c0',
		results => [0, 0, 65535, 0, 0, 0, 0, 0, 0, 65535],
	},
	ip_broadcast => {
		savefile => 'dhcp-rfc3004.pcap',
		netmask => '255.255.255.0',
		expr => 'ip broadcast',
		results => [262144, 0, 262144, 0],
	},
);

# * DLT, expr, netmask and skip: same as in accept_blocks above
# * errstr (mandatory, string): a substring that must appear in standard error
#   from filtertest (this verifies that the reason for rejecting the expression
#   is what the test expects, rather than some unrelated cause).
my %reject_tests = (
	ether_host => {
		DLT => 'EN10MB',
		expr => 'ether ab:cd:ef:0g:00:00',
		errstr => 'bogus ethernet address',
	},
	pppoes_value => {
		DLT => 'EN10MB',
		expr => 'pppoes 65536',
		errstr => 'greater than maximum',
	},
	mtp2_on_mtp3 => {
		DLT => 'MTP3',
		expr => 'fisu',
		errstr => 'supported only on MTP2',
	},
	mtp2_sio => {
		DLT => 'MTP2',
		expr => 'sio 256',
		errstr => 'too big',
	},
	mtp3_dpc => {
		DLT => 'MTP2',
		expr => 'dpc 16384',
		errstr => 'too big',
	},
	mtp3_opc => {
		DLT => 'MTP2',
		expr => 'opc 16384',
		errstr => 'too big',
	},
	mtp3_sls => {
		DLT => 'MTP2',
		expr => 'sls 16',
		errstr => 'too big',
	},
	mtp2_hsio => {
		DLT => 'MTP2',
		expr => 'hsio 256',
		errstr => 'too big',
	},
	mtp3_hdpc => {
		DLT => 'MTP2',
		expr => 'hdpc 16384',
		errstr => 'too big',
	},
	mtp3_hopc => {
		DLT => 'MTP2',
		expr => 'hopc 16384',
		errstr => 'too big',
	},
	mtp3_hsls => {
		DLT => 'MTP2',
		expr => 'hsls 16',
		errstr => 'too big',
	},
	atm_vpi => {
		DLT => 'SUNATM',
		expr => 'vpi 256',
		errstr => 'VPI value',
	},
	atm_vci => {
		DLT => 'SUNATM',
		expr => 'vci 65536',
		errstr => 'VCI value',
	},
	wlan_on_eth => {
		DLT => 'EN10MB',
		expr => 'type data',
		errstr => '802.11 link-layer types supported only on 802.11',
	},
	wlan_type => {
		DLT => 'IEEE802_11',
		# Type value out of range.
		expr => 'wlan type 16',
		errstr => 'invalid 802.11 type value',
	},
	wlan_subtype => {
		DLT => 'IEEE802_11',
		# Invalid syntax (numeric subtype is ambiguous and requires a type).
		expr => 'wlan subtype 0',
		errstr => 'syntax error',
	},
	wlan_type_subtype => {
		DLT => 'IEEE802_11',
		# Subtype value out of range.
		expr => 'wlan type 0 subtype 0xff',
		errstr => 'invalid 802.11 subtype value',
	},
	wlan_dir_invalid1 => {
		DLT => 'IEEE802_11',
		expr => 'wlan dir abc',
		errstr => 'unknown 802.11 direction',
	},
	wlan_dir_invalid2 => {
		DLT => 'IEEE802_11',
		expr => 'wlan dir 4',
		errstr => 'invalid 802.11 direction',
	},
	pppoed_unary => {
		DLT => 'EN10MB',
		expr => 'pppoed 1234',
		errstr => 'syntax error',
	},
	llc_noneth => {
		DLT => 'RAW',
		expr => 'llc',
		errstr => 'not supported',
	},
	decnet_area => {
		DLT => 'EN10MB',
		expr => 'decnet host 64.120',
		errstr => 'invalid DECnet address',
	},
	decnet_node => {
		DLT => 'EN10MB',
		expr => 'decnet host 17.1024',
		errstr => 'invalid DECnet address',
	},
	ip_host => {
		DLT => 'RAW',
		expr => 'ip host 256.256.256.256',
		errstr => 'invalid IPv4 address',
	},
	ip6_host_toolong => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		expr => 'ip6 host fe80:0:0:0:0:0:0:0:0',
		errstr => 'syntax error',
	},
	broadcast_not_supported => {
		DLT => 'SLIP',
		expr => 'broadcast',
		errstr => 'not a broadcast link',
	},
	multicast_not_supported => {
		DLT => 'SLIP',
		expr => 'multicast',
		errstr => 'link-layer multicast filters supported only on',
	},
# This test has been flaky because it depends on an external effect (DNS
# lookup), which sometimes times out.  Let's disable it until there is a good
# way to address it.
#	ip6_host_nonhex => {
#		DLT => 'RAW',
#		expr => 'ip6 host fe80:0:0:0:0:0:0:g',
#		errstr => 'unknown host',
#	},
	ip6_host_disabled => {
		skip => skip_config_def1 ('INET6'),
		DLT => 'RAW',
		expr => 'ip6 host fe80:0:0:0:0:0:0:0',
		errstr => 'not supported',
	},
	ip_net_bits1 => {
		DLT => 'RAW',
		expr => 'net 192.168/8',
		errstr => 'non-network bits set in',
	},
	ip_net_bits2 => {
		DLT => 'RAW',
		expr => 'net 192.168 mask 255.0.0.0',
		errstr => 'non-network bits set in',
	},
	ip_net_nonhid1 => {
		DLT => 'RAW',
		expr => 'net 10 mask 255.0.0.0',
		errstr => 'syntax error',
	},
	ip_net_nonhid2 => {
		DLT => 'RAW',
		expr => 'net 10/8',
		errstr => 'syntax error',
	},
	ip_net_mask_nonhid => {
		DLT => 'RAW',
		expr => 'net 10.0.0.0 mask 255',
		errstr => 'syntax error',
	},
	ip_net_nonhid_mask_nonhid => {
		DLT => 'RAW',
		expr => 'net 10 mask 255',
		errstr => 'syntax error',
	},
	ip_net_unknown => {
		DLT => 'EN10MB',
		expr => "ip net ${nonexistent}",
		errstr => "unknown network '${nonexistent}'",
	},
	ip_src_net_unknown => {
		DLT => 'EN10MB',
		expr => "ip src net ${nonexistent}",
		errstr => "unknown network '${nonexistent}'",
	},
	ip_dst_net_unknown => {
		DLT => 'EN10MB',
		expr => "ip dst net ${nonexistent}",
		errstr => "unknown network '${nonexistent}'",
	},
	net_unknown => {
		DLT => 'EN10MB',
		expr => "net ${nonexistent}",
		errstr => "unknown network '${nonexistent}'",
	},
	src_net_unknown => {
		DLT => 'EN10MB',
		expr => "src net ${nonexistent}",
		errstr => "unknown network '${nonexistent}'",
	},
	dst_net_unknown => {
		DLT => 'EN10MB',
		expr => "dst net ${nonexistent}",
		errstr => "unknown network '${nonexistent}'",
	},
	src_or_dst_net_unknown => {
		DLT => 'EN10MB',
		expr => "src or dst net ${nonexistent}",
		errstr => "unknown network '${nonexistent}'",
	},
	ip6_net_prefix => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		expr => 'ip6 net fe80:0:0:0:0:0:0:0:0/64',
		errstr => 'syntax error',
	},
	ip6_net_masklen => {
		skip => skip_config_undef ('INET6'),
		DLT => 'RAW',
		expr => 'ip6 net fe80:0:0:0:0:0:0:0/129',
		errstr => 'mask length must be <= 128',
	},
	ip6_net_disabled => {
		skip => skip_config_def1 ('INET6'),
		DLT => 'RAW',
		expr => 'ip6 net fe80:0:0:0:0:0:0:0/64',
		errstr => 'not supported',
	},
	tcp_port => {
		DLT => 'IPV4',
		expr => 'tcp port 70000',
		errstr => 'illegal port number',
	},
	udp_port => {
		DLT => 'IPV4',
		expr => 'udp port 70000',
		errstr => 'illegal port number',
	},
	sctp_port => {
		DLT => 'IPV4',
		expr => 'sctp port 70000',
		errstr => 'illegal port number',
	},
	tcp_portrange1 => {
		DLT => 'IPV4',
		expr => 'tcp portrange 1-70000',
		errstr => 'illegal port number',
	},
	tcp_portrange2 => {
		DLT => 'IPV4',
		expr => 'tcp portrange 23-',
		errstr => 'syntax error',
	},
	tcp_portrange3 => {
		DLT => 'IPV4',
		expr => 'tcp portrange -512',
		errstr => 'syntax error',
	},
	tcp_portrange4 => {
		DLT => 'IPV4',
		expr => 'tcp portrange 70000',
		errstr => 'illegal port number',
	},
	udp_portrange => {
		DLT => 'IPV4',
		expr => 'udp portrange 70000-1',
		errstr => 'illegal port number',
	},
	sctp_portrange => {
		DLT => 'IPV4',
		expr => 'sctp portrange 70000-80000',
		errstr => 'illegal port number',
	},
	vlan_not_supported => {
		DLT => 'RAW',
		expr => 'vlan',
		errstr => 'no VLAN support',
	},
	vlan_invalid_id1 => {
		DLT => 'EN10MB',
		expr => 'vlan 4096',
		errstr => 'greater than maximum',
	},
	vlan_invalid_id2 => {
		DLT => 'EN10MB',
		expr => 'vlan any',
		errstr => 'syntax error',
	},
	mpls_not_supported => {
		DLT => 'RAW',
		expr => 'mpls',
		errstr => 'no MPLS support',
	},
	mpls_invalid_id => {
		DLT => 'EN10MB',
		expr => 'mpls 1048576',
		errstr => 'greater than maximum',
	},
	inbound_not_supported_linux => {
		skip => skip_os_not ('linux'),
		DLT => 'EN10MB',
		expr => 'inbound',
		errstr => 'not a live capture',
	},
	outbound_not_supported_linux => {
		skip => skip_os_not ('linux'),
		DLT => 'EN10MB',
		expr => 'outbound',
		errstr => 'not a live capture',
	},
	ifindex_not_supported_linux => {
		skip => skip_os_not ('linux'),
		DLT => 'LINUX_SLL',
		expr => 'ifindex 1',
		errstr => 'not a live capture',
	},
	inbound_not_supported_other => {
		skip => skip_os ('linux'),
		DLT => 'EN10MB',
		expr => 'inbound',
		errstr => 'not supported',
	},
	outbound_not_supported_other => {
		skip => skip_os ('linux'),
		DLT => 'EN10MB',
		expr => 'outbound',
		errstr => 'not supported',
	},
	ifindex_not_supported_other => {
		skip => skip_os ('linux'),
		DLT => 'EN10MB',
		expr => 'ifindex 1',
		errstr => 'not supported',
	},
	arcnet_address1 => {
		DLT => 'ARCNET',
		expr => 'link host $123',
		errstr => 'syntax error',
	},
	arcnet_address2 => {
		DLT => 'ARCNET',
		expr => 'link host $x',
		errstr => 'syntax error',
	},
	arcnet_address3 => {
		DLT => 'ARCNET',
		expr => 'link host $',
		errstr => 'syntax error',
	},
	arcnet_address4 => {
		DLT => 'ARCNET',
		expr => 'link host 120',
		errstr => 'illegal link layer address',
	},
	ip_broadcast_implicit => {
		DLT => 'EN10MB',
		expr => 'ip broadcast',
		errstr => "netmask not known, so 'ip broadcast' not supported",
	},
	ip_broadcast_explicit => {
		DLT => 'EN10MB',
		netmask => '255.255.255.255',
		expr => 'ip broadcast',
		errstr => "netmask not known, so 'ip broadcast' not supported",
	},
	arp_protochain => {
		skip => skip_config_def1 ('NO_PROTOCHAIN'),
		DLT => 'EN10MB',
		expr => 'arp protochain 17',
		errstr => 'bad protocol applied for \'protochain\'',
	},
	protochain_disabled => {
		skip => skip_config_undef ('NO_PROTOCHAIN'),
		DLT => 'EN10MB',
		expr => 'protochain 17',
		errstr => 'protochain not supported',
	},
	# In the tests below the hostname normally should not matter because the
	# lookup would be made not in the IPv4/IPv6 space, or not at all.  Still
	# use a hostname that does not exist on the Internet, just in case.
	link_host_en10mb => {
		DLT => 'EN10MB',
		expr => "link host ${nonexistent}",
		errstr => "unknown ether host '${nonexistent}'",
	},
	link_host_netanalyzer => {
		DLT => 'NETANALYZER',
		expr => "link host ${nonexistent}",
		errstr => "unknown ether host '${nonexistent}'",
	},
	link_host_netanalyzer_transparent => {
		DLT => 'NETANALYZER_TRANSPARENT',
		expr => "link host ${nonexistent}",
		errstr => "unknown ether host '${nonexistent}'",
	},
	link_host_fddi => {
		DLT => 'FDDI',
		expr => "link host ${nonexistent}",
		errstr => "unknown FDDI host '${nonexistent}'",
	},
	link_host_ieee802 => {
		DLT => 'IEEE802',
		expr => "link host ${nonexistent}",
		errstr => "unknown token ring host '${nonexistent}'",
	},
	link_host_802_11 => {
		DLT => 'IEEE802_11',
		expr => "link host ${nonexistent}",
		errstr => "unknown 802.11 host '${nonexistent}'",
	},
	link_host_802_11_radio => {
		DLT => 'IEEE802_11_RADIO_AVS',
		expr => "link host ${nonexistent}",
		errstr => "unknown 802.11 host '${nonexistent}'",
	},
	link_host_802_11_radio_avs => {
		DLT => 'IEEE802_11_RADIO_AVS',
		expr => "link host ${nonexistent}",
		errstr => "unknown 802.11 host '${nonexistent}'",
	},
	link_host_prism_header => {
		DLT => 'PRISM_HEADER',
		expr => "link host ${nonexistent}",
		errstr => "unknown 802.11 host '${nonexistent}'",
	},
	link_host_ip_over_fc => {
		DLT => 'IP_OVER_FC',
		expr => "link host ${nonexistent}",
		errstr => "unknown Fibre Channel host '${nonexistent}'",
	},
	link_host_other => {
		DLT => 'ARCNET',
		expr => "link host ${nonexistent}",
		errstr => 'supports link-level host name',
	},
	decnet_host => {
		DLT => 'EN10MB',
		expr => "decnet host ${nonexistent}",
		errstr => "invalid DECnet address '${nonexistent}'",
	},
	gateway_noipv4_noipv6 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		expr => 'gateway eth-noipv4-noipv6.host123.libpcap.test',
		errstr => 'unknown host', # no IPv4 address in /etc/hosts
	},
	gateway_noipv4_ipv6 => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		expr => 'gateway eth-noipv4-ipv6.host123.libpcap.test',
		errstr => 'unknown host', # no IPv4 address in /etc/hosts
	},
	gateway_noeth => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		expr => 'gateway noeth-ipv4-noipv6.host123.libpcap.test',
		errstr => 'unknown ether host', # not in /etc/ethers
	},
	src_gateway => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		expr => 'src gateway eth-ipv4-noipv6.host123.libpcap.test',
		errstr => 'syntax error',
	},
	dst_gateway => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		expr => 'dst gateway eth-ipv4-noipv6.host123.libpcap.test',
		errstr => 'syntax error',
	},
	gateway_sunatm => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'SUNATM',
		expr => "gateway eth-ipv4-ipv6.host123.libpcap.test",
		errstr => '\'gateway\' supported only on',
	},
	gateway_raw => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'RAW',
		expr => "gateway eth-ipv4-ipv6.host123.libpcap.test",
		errstr => '\'gateway\' supported only on',
	},
	# If "gateway" begins to support IPv6 in future, the reject tests below will
	# fail and will need to be replaced with accept tests.
	gateway_INET6 => {
		skip => skip_config_undef ('INET6'),
		DLT => 'EN10MB',
		expr => "gateway eth-ipv4-ipv6.host123.libpcap.test",
		errstr => 'not supported in this configuration',
	},
	ip6_gateway => {
		skip => skip_config_def1 ('INET6') ||
			skip_no_ethers() ||
			skip_no_hosts(),
		DLT => 'EN10MB',
		expr => "ip6 gateway eth-ipv4-ipv6.host123.libpcap.test",
		errstr => 'illegal modifier of \'gateway\'',
	},
);

sub accept_test_label {
	return join '_', ('accept', @_);
}

sub apply_test_label {
	return join '_', ('apply', @_);
}

sub reject_test_label {
	return join '_', ('reject', @_);
}

sub time_test_command {
	my $cmdline = join ' ', @_;
	my $r;
	my $T;
	if (! $print_passed) {
		$r = system $cmdline;
	} else {
		my $t0 = Time::HiRes::time;
		$r = system $cmdline;
		$T = Time::HiRes::time - $t0;
	}
	return ($r >>= 8, $T);
}

sub validate_stdout_test {
	my ($r, $T) = time_test_command @_;

	return result_timed_out 'filtertest timeout' if $r == TIMED_OUT;

	return result_failed (
		'filtertest error',
		file_get_contents mytmpfile $filename_stdout
	) if $r;

	return result_failed (
		'diff error',
		file_get_contents mytmpfile $filename_diags
	) if system sprintf "diff $diff_flags %s %s >%s 2>&1",
		mytmpfile ($filename_expected),
		mytmpfile ($filename_stdout),
		mytmpfile ($filename_diags);

	return result_passed $T;
}

sub common_filtertest_args {
	my $test = shift;
	# BSD timeout(1) does not implement --verbose.
	my @args = defined $timeout_bin ? ($timeout_bin, $test_timeout) : ();
	push @args, $filtertest;
	push @args, ('-s', $test->{snaplen}) if defined $test->{snaplen};
	push @args, ('-m', $test->{netmask}) if defined $test->{netmask};
	push @args, '-O' unless $test->{optimize};
	push @args, '-l' if $test->{linuxext};
	return @args;
}

sub run_accept_test {
	my $test = shift;
	my @args = common_filtertest_args $test;
	# Write the filter expression to a file because the version of
	# system() that takes a list does not support redirecting stdout,
	# and the version of system() that takes a string does not escape
	# special characters in the filter expression, which becomes
	# invalid shell syntax.
	file_put_contents mytmpfile ($filename_filter), $test->{expr};
	file_put_contents mytmpfile ($filename_expected), $test->{expected};
	push @args, (
		'-F',
		mytmpfile ($filename_filter),
		$test->{DLT},
		'>' . mytmpfile ($filename_stdout),
		"2>&1"
	);
	return validate_stdout_test @args;
}

sub run_apply_test {
	my $test = shift;
	my @args = common_filtertest_args $test;
	file_put_contents mytmpfile ($filename_filter), $test->{expr};
	file_put_contents mytmpfile ($filename_expected), $test->{expected};
	push @args, (
		'-F',
		mytmpfile ($filename_filter),
		'-r',
		SAVEFILE_DIR . $test->{savefile},
		'>' . mytmpfile ($filename_stdout),
		"2>&1"
	);
	return validate_stdout_test @args;
}

sub run_reject_test {
	my $test = shift;
	my @args = common_filtertest_args $test;
	file_put_contents mytmpfile ($filename_filter), $test->{expr};
	push @args, (
		'-F',
		mytmpfile ($filename_filter),
		$test->{DLT},
		'>' . mytmpfile ($filename_stdout),
		"2>&1",
	);
	my ($r, $T) = time_test_command @args;

	return result_failed (
		'no filtertest error',
		file_get_contents mytmpfile $filename_stdout
	) if $r == 0;

	return result_timed_out 'filtertest timeout' if $r == TIMED_OUT;

	return result_failed (
		"filtertest status $r",
		file_get_contents mytmpfile $filename_stdout
	) if $r != EX_DATAERR;

	return result_failed (
		'error string mismatch',
		file_get_contents mytmpfile $filename_stdout
	) if ! string_in_file ($test->{expected}, mytmpfile $filename_stdout);

	return result_passed $T;
}

# Sort all hash elements by key, otherwise the pseudo-random ordering in Perl
# hashes will make it difficult to compare outputs of two invocations.
# Validate all accept test blocks and all reject tests, decide if this is a
# "run all tests" or a "run only this specific test or test block" invocation
# and produce the required test(s) using appropriate permutations of the main
# expression, any aliases and the bytecode version (optimized/unoptimized).
#
# The resulting flat ordered list of tests includes all skipped tests at their
# original positions, this makes it simple to distribute the tests and to
# collect the results preserving the ordering.
my @ready_to_run;
foreach my $testname (sort keys %accept_blocks) {
	my $test = $accept_blocks{$testname};
	foreach ('DLT', 'aliases') {
		next if defined $test->{$_};
		die "Internal error: accept test block '$testname' does not define key '$_'";
	}
	if (! scalar @{$test->{aliases}}) {
		die "Internal error: accept test block '$testname' defines zero aliases";
	} else {
		my %unique = map {$_ => 1} @{$test->{aliases}};
		if (scalar (keys %unique) != scalar @{$test->{aliases}}) {
			die "Internal error: accept test block '$testname' defines duplicate aliases";
		}
	}
	if (! defined $test->{unopt} && ! defined $test->{opt}) {
		die "Internal error: accept test block '$testname' defines neither 'unopt' nor 'opt'";
	}
	# Make the number of skip requests equal to the number of tests, but
	# provide the reason for the first skip request only.  This avoid wasting
	# the vertical scroll space when skipping test blocks with many aliases.
	my $skip_reason = (defined $test->{skip} && $test->{skip} ne '') ?
		$test->{skip} : undef;
	foreach my $optunopt ('unopt', 'opt') {
		next unless defined $test->{$optunopt};

		if (defined $skip_reason) {
			my $i = 0;
			foreach (@{$test->{aliases}}) {
				my $label = accept_test_label $testname, $optunopt, $i++;
				next if defined $only_one && $only_one ne $label;
				push @ready_to_run, {
					label => $label,
					func => \&run_skip_test,
					skip => $skip_reason,
				};
				$skip_reason = '';
			}
		} else {
			# Dedent and trim to restore the format of bpf_dump().
			my $multiline = '';
			foreach (split /^/o, $test->{$optunopt}) {
				$multiline .= "$1\n" if /^[\t]*(\(.+)$/o;
			}
			my $i = 0;
			foreach (@{$test->{aliases}}) {
				my $label = accept_test_label $testname, $optunopt, $i++;
				next if defined $only_one && $only_one ne $label;
				push @ready_to_run, {
					label => $label,
					func => \&run_accept_test,
					DLT => $test->{DLT},
					expr => $_,
					snaplen => defined $test->{snaplen} ? $test->{snaplen} : undef,
					netmask => defined $test->{netmask} ? $test->{netmask} : undef,
					optimize => int ($optunopt eq 'opt'),
					linuxext => defined $test->{linuxext} && $test->{linuxext} == 1,
					expected => $multiline,
				};
			}
		}
	}
}
foreach my $blockname (sort keys %apply_blocks) {
	my $block = $apply_blocks{$blockname};
	foreach ('savefile', 'expr', 'results') {
		next if defined $block->{$_};
		die "Internal error: apply test block '$blockname' does not define key '$_'";
	}
	foreach my $optunopt ('unopt', 'opt') {
		my $label = apply_test_label ($blockname, $optunopt);
		next if defined $only_one && $only_one ne $label;
		# Convert the array to filtertest output format.
		my $multiline = join ("\n", @{$block->{results}}) . "\n";
		push @ready_to_run, {
			label => $label,
			func => \&run_apply_test,
			netmask => defined $block->{netmask} ? $block->{netmask} : undef,
			optimize => int ($optunopt eq 'opt'),
			expr => $block->{expr},
			expected => $multiline,
			savefile => $block->{savefile},
		};
	}
}
foreach my $testname (sort keys %reject_tests) {
	my $test = $reject_tests{$testname};
	foreach ('DLT', 'expr', 'errstr') {
		next if defined $test->{$_};
		die "Internal error: reject test '$testname' does not define key '$_'";
	}
	my $label = reject_test_label $testname;
	next if defined $only_one && $only_one ne $label;

	if (defined $test->{skip} && $test->{skip} ne '') {
		push @ready_to_run, {
			label => $label,
			func => \&run_skip_test,
			skip => $test->{skip},
		};
	} else {
		push @ready_to_run, {
			label => $label,
			func => \&run_reject_test,
			DLT => $test->{DLT},
			netmask => defined $test->{netmask} ? $test->{netmask} : undef,
			expr => $test->{expr},
			expected => $test->{errstr},
		};
	}
}

if (! scalar @ready_to_run) {
	die "ERROR: Unknown test label '${only_one}'" if defined $only_one;
	die 'Internal error: no tests defined to run!'
}
if ($only_list) {
	print $_->{label} . "\n" foreach @ready_to_run;
	exit EX_OK;
}

$diff_flags = get_diff_flags;

$filtertest = defined $ENV{FILTERTEST_BIN} ? $ENV{FILTERTEST_BIN} :
	string_in_file ('/* cmakeconfig.h.in */', $config_h) ? './run/filtertest' :
	'./testprogs/filtertest';

# In this libpcap version "filtertest -h" prints to stdout and exits normally.
if (system ("$filtertest -h >/dev/null 2>&1") >> 8) {
	# Make it easier to see what the problem is.
	system $filtertest;
	print STDERR "ERROR: $filtertest is not usable\n";
	exit 2;
}

# Every test in this file uses an expression that under normal conditions takes
# well under one second to process, so if a filtertest invocation is taking
# longer, it is likely a regression.  Or an invocation via Valgrind, which
# demands a sensible host-specific override of the timeout value.
$test_timeout = defined $ENV{FILTERTEST_TIMEOUT} ?
	$ENV{FILTERTEST_TIMEOUT} : 1;

if ($test_timeout eq '0') {
	print "INFO: Not using a test timeout (FILTERTEST_TIMEOUT=0).\n";
} elsif (defined $ENV{TIMEOUT_BIN}) {
	$timeout_bin = $ENV{TIMEOUT_BIN};
	if (system ($timeout_bin, '0.1', 'sleep', '10') >> 8 != TIMED_OUT) {
		print STDERR "ERROR: TIMEOUT_BIN='$timeout_bin' is not usable.\n";
		exit 1;
	}
	print "INFO: Using a test timeout of $test_timeout (TIMEOUT_BIN='$timeout_bin').\n";
} elsif (system ('timeout', '0.1', 'sleep', '10') >> 8 != TIMED_OUT) {
	print "WARNING: Not using a test timeout (the default 'timeout' is not usable).\n";
} else {
	$timeout_bin = 'timeout';
	printf "INFO: Using a test timeout of %s.\n", $test_timeout;
}

init_tmpdir 'libpcap_TESTrun';
exit test_and_report @ready_to_run;
